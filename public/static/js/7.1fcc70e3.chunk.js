(this.webpackJsonp=this.webpackJsonp||[]).push([[7],{629:function(e,n,t){"use strict";t.d(n,"a",(function(){return c}));var l=t(0),r=t(1),a=t(121),o=t(255),i=t(404),s=t(397),u=t(207),d=t(5);function c(e){var n=e.buttonLabel,t=e.buttonAction,r=e.title,c=e.loading,m=e.children,f=Object(d.c)((function(e){return e.global}));return l.createElement(o.a,null,l.createElement(i.a,{visible:!!e.open,dismissable:!1,style:{maxWidth:500,alignSelf:"center"}},l.createElement(s.a,{indeterminate:!0,visible:c,color:f.theme.colors.accent}),l.createElement(i.a.Title,null,r),l.createElement(i.a.Content,{pointerEvents:"box-none"},l.createElement(i.a.ScrollArea,null,l.createElement(a.b,null,m))),l.createElement(i.a.Actions,{style:{justifyContent:"flex-end"}},l.createElement(u.a,{onPress:function(){e.onClose()}},"Cancel"),l.createElement(u.a,{onPress:t},n))))}r.a.create({button:{width:"100%",borderRadius:16,padding:5},contentContainer:{paddingHorizontal:16,paddingBottom:32},sheet:{elevation:3,backgroundColor:"white",flexGrow:1,height:"100%",display:"flex",flexDirection:"column",justifyContent:"center"},sheetHeader:{elevation:2,borderTopLeftRadius:20,borderTopRightRadius:20,height:40,shadowColor:"#000",shadowOffset:{width:0,height:-4},backgroundColor:"white",shadowOpacity:.22,shadowRadius:2.22}})},630:function(e,n,t){"use strict";t.d(n,"a",(function(){return a}));var l=t(165),r=t(332),a=l.a.actions;r.a},631:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var l=t(36),r=t(0),a=t(5);function o(e,n){var t=n.getPayload;return function(n){var o=n.variables,i=n.onError,s=Object(a.b)(),u=Object(l.useQuery)(e,{variables:o}),d=u.data,c=u.loading,m=u.previousData,f=u.refetch,p=u.error,b=r.useMemo((function(){return t(d)}),[JSON.stringify(d)]);return r.useEffect((function(){JSON.stringify(m),JSON.stringify(d);null!=p&&p.message&&(!1!==n.showSnackbarErrors&&s(a.a.notifications.showSnackbar({message:p.message,variant:"error"})),i&&p.message)}),[n.onError,null==p?void 0:p.message]),{loading:c,data:b,refetch:f}}}},635:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var l=t(0),r=t(9),a=t(121),o=t(334);function i(e){var n=e.children,t=e.rightAction,i=e.disabled,s=l.useRef();return l.createElement(o.a,{ref:s,enabled:!i,renderRightActions:function(e,n){var o=n.interpolate({inputRange:[-100,0],outputRange:[1,0]}),i=n.interpolate({inputRange:[-150,0],outputRange:[0,10]});return l.createElement(a.d,{onPress:function(){var e;null==t||t.onPress(),null==s||null==(e=s.current)||e.close()}},l.createElement(r.a.View,{style:{flexGrow:1,backgroundColor:null==t?void 0:t.backgroundColor,justifyContent:"center",height:"100%",width:75,transform:[{translateX:i}]}},l.createElement(r.a.Text,{style:{color:"white",paddingHorizontal:10,fontWeight:"600",transform:[{scale:o}]}},null==t?void 0:t.label)))},useNativeAnimations:!0},n)}},642:function(e,n,t){"use strict";t.d(n,"a",(function(){return b}));var l,r=t(11),a=t.n(r),o=t(28),i=t.n(o),s=t(36),u=t(37),d=t(0),c=t(108),m=t(22),f=t(5),p=Object(u.a)(l||(l=i()(["\n  query QueryAvailableRigs(\n    $dropzoneId: Int!\n    $userId: Int!\n  ) {\n    dropzone(id: $dropzoneId) {\n      id\n      dropzoneUser(userId: $userId) {\n        id\n        availableRigs {\n          id\n          make\n          model\n          canopySize\n          serial\n\n          user {\n            id\n          }\n        }\n      }\n    }\n  }\n"])));function b(e){var n,t,l,r,o,i,u,b,v=d.useState(!1),g=a()(v,2),h=g[0],y=g[1],E=Object(f.c)((function(e){return e.global})).currentDropzoneId,I=Object(s.useLazyQuery)(p),x=a()(I,2),S=x[0],O=x[1].data;return d.useEffect((function(){e.userId&&e.dropzoneId&&S({variables:{dropzoneId:E,userId:Number(e.userId)}})}),[e.userId,e.dropzoneId]),d.useEffect((function(){var n,t,l;!e.value&&e.autoSelectFirst&&null!=O&&null!=(n=O.dropzone)&&null!=(t=n.dropzoneUser)&&null!=(l=t.availableRigs)&&l.length&&e.onSelect(O.dropzone.dropzoneUser.availableRigs[0])}),[e.autoSelectFirst,JSON.stringify(null==O||null==(n=O.dropzone)||null==(t=n.dropzoneUser)?void 0:t.availableRigs)]),d.createElement(c.a,{onDismiss:function(){return y(!1)},visible:h,anchor:d.createElement(m.b.Item,{onPress:function(){y(!0)},title:e.value?(null==(l=e.value)?void 0:l.make)+" "+(null==(r=e.value)?void 0:r.model)+" ("+((null==(o=e.value)?void 0:o.canopySize)||"?")+"sqft)":"Select rig",description:e.required?null:"Optional",left:function(){return d.createElement(m.b.Icon,{icon:"parachute"})}})},null==O||null==(i=O.dropzone)||null==(u=i.dropzoneUser)||null==(b=u.availableRigs)?void 0:b.map((function(n){return d.createElement(c.a.Item,{key:"rig-select-"+n.id,onPress:function(){y(!1),e.onSelect(n)},style:{width:"100%"},title:(null==n?void 0:n.make)+" "+(null==n?void 0:n.model)+" ("+(null==n?void 0:n.canopySize)+" sqft) "+(n.user?"":"[DROPZONE RIG]")})})))}},660:function(e,n,t){"use strict";t.d(n,"a",(function(){return C}));var l,r=t(0),a=t(1),o=t(2),i=t(287),s=t(285),u=t(373),d=t(288),c=t(5),m=t(11),f=t.n(m),p=t(22),b=t(28),v=t.n(b),g=t(37),h=t(631),y=Object(g.a)(l||(l=v()(["\nquery QueryDropzoneUsers(\n  $dropzoneId: Int!\n  $permissions: [Permission!]\n) {\n  dropzone(id: $dropzoneId) {\n    id\n    name\n\n    dropzoneUsers(permissions: $permissions) {\n      edges {\n        node {\n          id\n          role {\n            id\n            name\n          }\n          user {\n            id\n            name\n          }\n        }\n      }\n    }\n  }\n}\n"]))),E=Object(h.a)(y,{getPayload:function(e){var n;return null==e||null==(n=e.dropzone)?void 0:n.dropzoneUsers}}),I=t(329);function x(e){var n,t=e.label,l=e.requiredPermissions,a=e.icon,o=(e.required,e.value),i=Object(c.c)((function(e){return e.global})).currentDropzoneId,s=Object(c.b)(),u=E({variables:{dropzoneId:Number(i),permissions:l},onError:function(e){return s(c.a.notifications.showSnackbar({message:e,variant:"error"}))}}),d=u.data;u.loading,u.refetch;return r.createElement(r.Fragment,null,r.createElement(p.b.Subheader,null,t),r.createElement(I.a,{autoSelectFirst:!0,icon:a||"account",items:(null==d||null==(n=d.edges)?void 0:n.map((function(e){return e.node})))||[],selected:[e.value].filter(Boolean),isSelected:function(e){return e.id===(null==o?void 0:o.id)},renderItemLabel:function(e){return null==e?void 0:e.user.name},isDisabled:function(){return!1},onChangeSelected:function(n){var t=f()(n,1)[0];return t?e.onSelect(t):null}}))}var S,O=t(23),k=t.n(O),w=t(36),j=t(138),T=Object(g.a)(S||(S=v()(["\n  query QuerySelectPlanes(\n    $dropzoneId: Int!\n  ) {\n    planes(dropzoneId: $dropzoneId) {\n      id\n      name\n      registration\n      hours\n      minSlots\n      maxSlots\n      nextMaintenanceHours\n      createdAt\n    }\n  }\n"])));function z(e){var n=Object(c.c)((function(e){return e.global})).currentDropzoneId,t=Object(w.useQuery)(T,{variables:{dropzoneId:n}}),l=t.data;t.loading,t.refetch;return r.createElement(r.Fragment,null,r.createElement(p.b.Subheader,null,"Aircraft"),r.createElement(I.a,{autoSelectFirst:!0,items:Object(j.uniqBy)(k()((null==l?void 0:l.planes)||[]),(function(e){return e.id}))||[],selected:[e.value].filter(Boolean),renderItemLabel:function(e){return null==e?void 0:e.name},isDisabled:function(e){return!1},onChangeSelected:function(n){var t=f()(n,1)[0];return t?e.onSelect(t):null}}))}function C(){var e,n,t=Object(c.c)((function(e){return e.forms.load})),l=Object(c.b)();Object(c.c)((function(e){return e.global}));return r.createElement(r.Fragment,null,r.createElement(i.a,{style:$.field,mode:"outlined",label:"Name",error:!!t.fields.name.error,placeholder:"Optional",value:t.fields.name.value||"",onChangeText:function(e){return l(c.a.forms.load.setField(["name",e]))}}),r.createElement(s.a,{type:t.fields.name.error?"error":"info"},t.fields.name.error||"e.g Starcrest load, Tandem load"),r.createElement(i.a,{style:$.field,mode:"outlined",label:"Slots",error:!!t.fields.maxSlots.error,value:null==(e=t.fields.maxSlots)||null==(n=e.value)?void 0:n.toString(),onChangeText:function(e){return l(c.a.forms.load.setField(["maxSlots",Number(e)]))}}),r.createElement(s.a,{type:t.fields.maxSlots.error?"error":"info"},t.fields.maxSlots.error||""),r.createElement(o.a,{style:{width:"100%"}},r.createElement(z,{value:t.fields.plane.value,required:!0,onSelect:function(e){l(c.a.forms.load.setField(["plane",e])),l(c.a.forms.load.setField(["maxSlots",e.maxSlots]))}}),r.createElement(s.a,{type:t.fields.plane.error?"error":"info"},t.fields.plane.error||""),r.createElement(x,{label:"GCA",onSelect:function(e){return l(c.a.forms.load.setField(["gca",e]))},value:t.fields.gca.value||null,requiredPermissions:["actAsGCA"],required:!0}),r.createElement(s.a,{type:t.fields.gca.error?"error":"info"},t.fields.gca.error||""),r.createElement(x,{label:"Pilot",onSelect:function(e){return l(c.a.forms.load.setField(["pilot",e]))},value:t.fields.pilot.value||null,requiredPermissions:["actAsPilot"]}),r.createElement(s.a,{type:t.fields.pilot.error?"error":"info"},t.fields.pilot.error||""),r.createElement(u.a,{style:{marginVertical:8}}),r.createElement(d.a.Item,{label:"Allow public manifesting",status:t.fields.isOpen.value?"checked":"unchecked",onPress:function(){return l(c.a.forms.load.setField(["isOpen",!t.fields.isOpen.value]))}})))}var $=a.a.create({fields:{flex:1,width:"100%"},field:{marginBottom:8,width:"100%"}})},661:function(e,n,t){"use strict";t.d(n,"a",(function(){return A}));var l=t(4),r=t.n(l),a=t(11),o=t.n(a),i=t(23),s=t.n(i),u=t(28),d=t.n(u),c=t(0),m=t(80),f=t(1),p=t(22),b=t(105),v=t(285),g=t(120),h=t(373),y=t(37),E=t(138),I=t(5),x=t(329),S=t(631),O=t(397),k=t(287);var w,j,T=t(642),z=Object(y.a)(w||(w=d()(["\nquery QueryDropzoneUsersManifestDetails(\n  $dropzoneId: Int!\n  $dropzoneUserId: Int!\n) {\n  dropzone(id: $dropzoneId) {\n    id\n    name\n\n    dropzoneUser(id: $dropzoneUserId) {\n      id\n\n      user {\n        id\n        name\n        exitWeight\n        license {\n          id\n          name\n        }\n        rigs {\n          id\n          make\n          model\n          canopySize\n        }\n      }\n      role {\n        id\n        name\n      }\n      user {\n        id\n        name\n        image\n      }\n    }\n  }\n}\n"]))),C=Object(S.a)(z,{getPayload:function(e){var n;return null==e||null==(n=e.dropzone)?void 0:n.dropzoneUser}});function $(e){var n,t,l,r,a,o,i,s,u=e.dropzoneId,d=e.dropzoneUserId,f=e.onChangeRig,v=e.exitWeight,y=e.rigId,x=e.onChangeExitWeight,S=Object(I.c)((function(e){return e})).global,w=C({variables:{dropzoneUserId:d,dropzoneId:u},onError:console.error}),j=w.data,z=w.loading,$=null==j||null==(n=j.user)||null==(t=n.rigs)?void 0:t.find((function(e){var n=e.id;return Number(n)===y}));return c.useEffect((function(){var e;!v&&null!=j&&null!=(e=j.user)&&e.exitWeight&&x(Number(j.user.exitWeight))}),[null==j||null==(l=j.user)?void 0:l.exitWeight]),c.createElement(b.a,{style:{width:"100%"},elevation:3},c.createElement(O.a,{indeterminate:!0,color:S.theme.colors.accent,visible:z}),c.createElement(b.a.Title,{title:null==j?void 0:j.user.name,left:function(){var e;return null!=j&&null!=(e=j.user)&&e.image?c.createElement(p.a.Image,{source:{uri:j.user.image},size:24}):c.createElement(p.a.Icon,{icon:"account",size:24})}}),c.createElement(b.a.Content,null,c.createElement(h.a,{style:{marginBottom:8}}),c.createElement(m.a,{horizontal:!0},c.createElement(g.a,{style:{marginHorizontal:1},icon:"lock",mode:"outlined",disabled:!0},null==j||null==(r=j.role)?void 0:r.name),c.createElement(g.a,{style:{marginHorizontal:1},icon:"ticket-account",mode:"outlined",disabled:!0},null==j||null==(a=j.user)||null==(o=a.license)?void 0:o.name),$&&v&&$.canopySize?c.createElement(g.a,{style:{marginHorizontal:1},icon:"escalator-down",mode:"outlined",disabled:!0},(i=v,s=$.canopySize,Object(E.round)(2.20462*i/s,2).toFixed(2))):null),c.createElement(T.a,{userId:d,dropzoneId:u,onSelect:f,value:$,autoSelectFirst:!0}),c.createElement(k.a,{value:v?""+v:"",onChangeText:function(e){return x(Number(e))},keyboardType:"number-pad",label:"Exit weight",mode:"outlined"})))}function N(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);n&&(l=l.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,l)}return t}function P(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?N(Object(t),!0).forEach((function(n){r()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):N(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var F=Object(y.a)(j||(j=d()(["\nquery DropzoneUsersAllowedJumpTypes(\n  $dropzoneId: Int!,\n  $userIds: [Int!]!\n) {\n  dropzone(id: $dropzoneId) {\n    id\n\n    allowedJumpTypes(userId: $userIds) {\n      id\n      name\n    }\n\n    ticketTypes(isPublic: true) {\n      id\n      name\n      cost\n\n      extras {\n        id\n        cost\n        name\n      }\n    }\n  }\n  jumpTypes {\n    id\n    name\n  }\n}\n\n"]))),D=Object(S.a)(F,{getPayload:function(e){var n,t;return{allowedJumpTypes:(null==e||null==(n=e.dropzone)?void 0:n.allowedJumpTypes)||[],ticketTypes:(null==e||null==(t=e.dropzone)?void 0:t.ticketTypes)||[],jumpTypes:(null==e?void 0:e.jumpTypes)||[]}}});function A(){var e,n,t,l,r,a,i,u,d,f,y,S,O,k=Object(I.c)((function(e){return e.forms.manifestGroup})),w=Object(I.c)((function(e){return e.global})),j=Object(I.b)(),T=D({variables:{userIds:null==(e=k.fields.users)||null==(n=e.value)?void 0:n.map((function(e){return e.id})),dropzoneId:w.currentDropzoneId},onError:console.error}),z=T.data;T.loading;return c.createElement(c.Fragment,null,c.createElement(p.b.Subheader,null,"Jump type"),c.createElement(b.a,{elevation:2,style:{marginBottom:16,flexShrink:1}},c.createElement(b.a.Content,null,c.createElement(x.a,{autoSelectFirst:!0,items:Object(E.uniqBy)([].concat(s()((null==z?void 0:z.allowedJumpTypes)||[]),s()((null==z?void 0:z.jumpTypes)||[])),(function(e){return e.id}))||[],selected:k.fields.jumpType.value?[k.fields.jumpType.value]:[],renderItemLabel:function(e){return e.name},isDisabled:function(e){var n;return!(null!=z&&null!=(n=z.allowedJumpTypes)&&n.map((function(e){return e.id})).includes(e.id))},onChangeSelected:function(e){var n=o()(e,1)[0];return j(I.a.forms.manifestGroup.setField(["jumpType",n]))}}),c.createElement(v.a,{type:k.fields.jumpType.error?"error":"info"},k.fields.jumpType.error||""))),c.createElement(p.b.Subheader,null,"Ticket"),c.createElement(b.a,{elevation:2,style:{width:"100%"}},c.createElement(b.a.Content,null,c.createElement(x.a,{autoSelectFirst:!0,items:(null==z?void 0:z.ticketTypes)||[],selected:k.fields.ticketType.value?[k.fields.ticketType.value]:[],renderItemLabel:function(e){return e.name},isDisabled:function(){return!1},onChangeSelected:function(e){var n=o()(e,1)[0];return j(I.a.forms.manifestGroup.setField(["ticketType",n]))}}),c.createElement(v.a,{type:k.fields.ticketType.error?"error":"info"},k.fields.ticketType.error||""),null!=k&&null!=(t=k.fields)&&null!=(l=t.ticketType)&&null!=(r=l.value)&&null!=(a=r.extras)&&a.length?c.createElement(p.b.Subheader,null,"Ticket addons"):null,c.createElement(m.a,{horizontal:!0,style:U.ticketAddons},null==k||null==(i=k.fields)||null==(u=i.ticketType)||null==(d=u.value)||null==(f=d.extras)?void 0:f.map((function(e){var n,t,l,r;return c.createElement(g.a,{selected:null==k||null==(n=k.fields)||null==(t=n.extras.value)?void 0:t.some((function(n){return n.id===e.id})),onPress:null!=k&&null!=(l=k.fields)&&null!=(r=l.extras.value)&&r.some((function(n){return n.id===e.id}))?function(){var n,t;return j(I.a.forms.manifestGroup.setField(["extras",null==k||null==(n=k.fields)||null==(t=n.extras.value)?void 0:t.filter((function(n){return n.id!==e.id}))]))}:function(){var n,t;return j(I.a.forms.manifestGroup.setField(["extras",[].concat(s()((null==k||null==(n=k.fields)||null==(t=n.extras)?void 0:t.value)||[]),[e])]))}},e.name+" ($"+e.cost+")")}))),c.createElement(v.a,{type:k.fields.extras.error?"error":"info"},k.fields.extras.error||""))),c.createElement(h.a,null),c.createElement(p.b.Subheader,null,"Group"),null==(y=k.fields)||null==(S=y.users)||null==(O=S.value)?void 0:O.map((function(e){return c.createElement($,{dropzoneId:w.currentDropzoneId,dropzoneUserId:Number(e.id),rigId:Number(e.rigId)||void 0,exitWeight:e.exitWeight,onChangeExitWeight:function(n){var t;return j(I.a.forms.manifestGroup.setField(["users",null==(t=k.fields.users.value)?void 0:t.map((function(t){return t.id===e.id?P(P({},e),{},{exitWeight:n}):t}))]))},onChangeRig:function(n){var t;return j(I.a.forms.manifestGroup.setField(["users",null==(t=k.fields.users.value)?void 0:t.map((function(t){return t.id===e.id?P(P({},e),{},{rigId:Number(n.id)}):t}))]))}})})))}var U=f.a.create({fields:{flex:1},field:{marginBottom:8},ticketAddons:{marginBottom:8}})},797:function(e,n,t){"use strict";t.r(n),t.d(n,"default",(function(){return an}));var l,r,a=t(51),o=t(0),i=t(29),s=t(164),u=t(1),d=t(228),c=t(121),m=t(397),f=t(479),p=t(405),b=t(4),v=t.n(b),g=t(11),h=t.n(g),y=t(28),E=t.n(y),I=t(6),x=t.n(I),S=t(36),O=t(80),k=t(255),w=t(404),j=t(207),T=t(5),z=t(23),C=t.n(z),$=t(285),N=t(22),P=t(120),F=t(373),D=t(287),A=t(33),U=t(37),L=t(138),W=t(631),G=t(329),R=Object(U.a)(l||(l=E()(["\nquery DropzoneUsersAllowedJumpTypes(\n  $dropzoneId: Int!,\n  $userIds: [Int!]!\n) {\n  dropzone(id: $dropzoneId) {\n    id\n\n    allowedJumpTypes(userId: $userIds) {\n      id\n      name\n    }\n  }\n  jumpTypes {\n    id\n    name\n  }\n}\n\n"]))),M=Object(W.a)(R,{getPayload:function(e){var n,t;return{allowedJumpTypes:(null==e||null==(n=e.dropzone)?void 0:n.allowedJumpTypes)||[],ticketTypes:(null==e||null==(t=e.dropzone)?void 0:t.ticketTypes)||[],jumpTypes:(null==e?void 0:e.jumpTypes)||[]}}});function J(e){var n=Object(T.c)((function(e){return e.global})).currentDropzoneId,t=M({variables:{userIds:[Number(e.userId)||null].filter(Boolean),dropzoneId:Number(n)},onError:console.error}),l=t.data;t.loading;return o.createElement(o.Fragment,null,o.createElement(N.b.Subheader,null,"Jump type"),o.createElement(G.a,{autoSelectFirst:!0,items:Object(L.uniqBy)([].concat(C()((null==l?void 0:l.allowedJumpTypes)||[]),C()((null==l?void 0:l.jumpTypes)||[])),(function(e){return e.id}))||[],selected:[e.value].filter(Boolean),renderItemLabel:function(e){return null==e?void 0:e.name},isDisabled:function(e){var n;return!(null!=l&&null!=(n=l.allowedJumpTypes)&&n.map((function(e){return e.id})).includes(e.id))},onChangeSelected:function(n){var t=h()(n,1)[0];return t?e.onSelect(t):null}}))}var q=Object(U.a)(r||(r=E()(["\nquery DropzoneUsersAllowedTicketTypes(\n  $dropzoneId: Int!,\n  $onlyPublicTickets: Boolean\n) {\n  dropzone(id: $dropzoneId) {\n    id\n\n    ticketTypes(isPublic: $onlyPublicTickets) {\n      id\n      name\n      cost\n      isTandem\n\n      extras {\n        id\n        cost\n        name\n      }\n    }\n  }\n}\n\n"]))),B=Object(W.a)(q,{getPayload:function(e){var n;return{ticketTypes:(null==e||null==(n=e.dropzone)?void 0:n.ticketTypes)||[]}}});function H(e){var n=Object(T.c)((function(e){return e.global})).currentDropzoneId,t=B({variables:{dropzoneId:Number(n),onlyPublicTickets:e.onlyPublicTickets||null},onError:console.error}),l=t.data;t.loading;return o.createElement(o.Fragment,null,o.createElement(N.b.Subheader,null,"Ticket"),o.createElement(G.a,{autoSelectFirst:!0,items:(null==l?void 0:l.ticketTypes)||[],selected:[e.value].filter(Boolean),renderItemLabel:function(e){return null==e?void 0:e.name},isDisabled:function(){return!1},onChangeSelected:function(n){var t=h()(n,1)[0];return t?e.onSelect(t):null}}))}var Y=t(46),Q=t(642),V=t(161);function _(){var e,n,t,l,r,a,i,s,u,d,c,m,f,p,b,v,g,h,y,E,I,x,S,k,w,j,z=Object(T.b)(),U=Object(V.b)(),L=Object(T.c)((function(e){return e.forms.manifest}));o.useEffect((function(){var e;if(null!=(e=L.fields.dropzoneUser)&&e.value){var n,t,l,r,a,o,i;if(!L.fields.exitWeight.value)z(T.a.forms.manifest.setField(["exitWeight",Number((null==(l=L.fields.dropzoneUser)||null==(r=l.value)||null==(a=r.user)?void 0:a.exitWeight)||60)]));if(!L.fields.rig.value&&null!=(n=L.fields.dropzoneUser.value.user)&&null!=(t=n.rigs)&&t.length)z(T.a.forms.manifest.setField(["rig",null==(o=L.fields.dropzoneUser)||null==(i=o.value)?void 0:i.user.rigs[0]]))}}),[null==(e=L.fields)||null==(n=e.dropzoneUser)||null==(t=n.value)?void 0:t.id]);var W=null==L||null==(l=L.original)?void 0:l.id,G=Object(Y.a)(W?A.b.UpdateUserSlot:A.b.CreateUserSlot);return o.createElement(o.Fragment,null,o.createElement(J,{value:L.fields.jumpType.value,required:!0,userId:Number(null==L||null==(r=L.fields)||null==(a=r.dropzoneUser)||null==(i=a.value)||null==(s=i.user)?void 0:s.id)||null,onSelect:function(e){return z(T.a.forms.manifest.setField(["jumpType",e]))}}),o.createElement($.a,{type:L.fields.jumpType.error?"error":"info"},L.fields.jumpType.error||""),o.createElement(H,{value:L.fields.ticketType.value,required:!0,onlyPublicTickets:!G,onSelect:function(e){return z(T.a.forms.manifest.setField(["ticketType",e]))}}),o.createElement($.a,{type:L.fields.ticketType.error?"error":"info"},L.fields.ticketType.error||""),null!=L&&null!=(u=L.fields)&&null!=(d=u.ticketType)&&null!=(c=d.value)&&null!=(m=c.extras)&&m.length?o.createElement(N.b.Subheader,null,"Ticket addons"):null,o.createElement(O.a,{horizontal:!0,style:Z.ticketAddons},null==L||null==(f=L.fields)||null==(p=f.ticketType)||null==(b=p.value)||null==(v=b.extras)?void 0:v.map((function(e){var n,t,l,r;return o.createElement(P.a,{selected:null==L||null==(n=L.fields)||null==(t=n.extras.value)?void 0:t.some((function(n){return n.id===e.id})),onPress:null!=L&&null!=(l=L.fields)&&null!=(r=l.extras.value)&&r.some((function(n){return n.id===e.id}))?function(){var n,t;return z(T.a.forms.manifest.setField(["extras",null==L||null==(n=L.fields)||null==(t=n.extras.value)?void 0:t.filter((function(n){return n.id!==e.id}))]))}:function(){var n,t;return z(T.a.forms.manifest.setField(["extras",[].concat(C()((null==L||null==(n=L.fields)||null==(t=n.extras)?void 0:t.value)||[]),[e])]))}},e.name+" ($"+e.cost+")")}))),o.createElement($.a,{type:L.fields.extras.error?"error":"info"},L.fields.extras.error||""),o.createElement(F.a,null),L.fields.dropzoneUser?o.createElement(Q.a,{value:L.fields.rig.value,userId:Number(null==(g=L.fields.dropzoneUser)||null==(h=g.value)||null==(y=h.user)?void 0:y.id),dropzoneId:Number(null==U||null==(E=U.dropzone)?void 0:E.id),onSelect:function(e){return z(T.a.forms.manifest.setField(["rig",e]))}}):null,o.createElement($.a,{type:L.fields.rig.error?"error":"info"},L.fields.rig.error||""),o.createElement(D.a,{style:Z.field,mode:"outlined",label:"Exit weight",error:!!L.fields.exitWeight.error,value:(null==(I=L.fields.exitWeight)||null==(x=I.value)?void 0:x.toString())||"",keyboardType:"numbers-and-punctuation",right:function(){return o.createElement(D.a.Affix,{text:"kg"})},onChangeText:function(e){return z(T.a.forms.manifest.setField(["exitWeight",Number(e)]))}}),o.createElement($.a,{type:L.fields.exitWeight.error?"error":"info"},L.fields.exitWeight.error||""),null!=(S=L.fields.ticketType.value)&&S.isTandem?o.createElement(o.Fragment,null,o.createElement(N.b.Subheader,null,"Passenger"),o.createElement(D.a,{style:Z.field,mode:"outlined",label:"Passenger name",error:!!L.fields.passengerName.error,value:(null==(k=L.fields.passengerName)||null==(w=k.value)?void 0:w.toString())||"",onChangeText:function(e){return z(T.a.forms.manifest.setField(["passengerName",e]))}}),o.createElement(D.a,{style:Z.field,mode:"outlined",label:"Passenger exit weight",error:!!L.fields.passengerExitWeight.error,value:(null==(j=L.fields.passengerExitWeight.value)?void 0:j.toString())||"",onChangeText:function(e){return z(T.a.forms.manifest.setField(["passengerExitWeight",Number(e)]))}})):null)}var X,Z=u.a.create({fields:{flex:1},field:{marginBottom:8},ticketAddons:{marginBottom:8}});function K(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);n&&(l=l.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,l)}return t}function ee(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?K(Object(t),!0).forEach((function(n){v()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):K(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var ne=Object(S.gql)(X||(X=E()(["\n  mutation CreateSlot(\n    $jumpTypeId: Int\n    $extraIds: [Int!]\n    $loadId: Int\n    $rigId: Int\n    $ticketTypeId: Int\n    $dropzoneUserId: Int\n    $exitWeight: Float\n    $passengerName: String\n    $passengerExitWeight: Float\n  ) {\n    createSlot(\n      input: {\n        attributes: {\n          jumpTypeId: $jumpTypeId\n          extraIds: $extraIds\n          loadId: $loadId\n          rigId: $rigId\n          ticketTypeId: $ticketTypeId\n          dropzoneUserId: $dropzoneUserId\n          exitWeight: $exitWeight\n          passengerExitWeight: $passengerExitWeight\n          passengerName: $passengerName\n        }\n      }\n    ) {\n      errors\n      fieldErrors {\n        field\n        message\n      }\n      slot {\n        id\n        jumpType {\n          id\n          name\n        }\n        extras {\n          id\n          name\n        }\n        exitWeight\n        load {\n          id\n          name\n          createdAt\n          dispatchAt\n          hasLanded\n          maxSlots\n          isFull\n          isOpen\n          plane {\n            id\n            name\n          }\n          gca {\n            id\n            user {\n              id\n              name\n            }\n          }\n          pilot {\n            id\n            user {\n              id\n              name\n            }\n          }\n          loadMaster {\n            id\n            user {\n              id\n              name\n            }\n          }\n          slots {\n            id\n            createdAt\n            user {\n              id\n              name\n            }\n            passengerName\n            passengerExitWeight\n            ticketType {\n              id\n              name\n              isTandem\n              altitude\n            }\n            jumpType {\n              id\n              name\n            }\n            extras {\n              id\n              name\n            }\n          }\n        }\n      }\n    }\n  }\n"])));function te(e){var n,t,l,r,a,i,s=Object(T.b)(),u=Object(T.c)((function(e){return e.forms.manifest})),d=Object(T.c)((function(e){return e.global})),c=Object(S.useMutation)(ne),f=h()(c,2),p=f[0],b=f[1],v=o.useCallback((function(){var e,n,t=!1;return null!=(e=u.fields.jumpType.value)&&e.id||(t=!0,s(T.a.forms.manifest.setFieldError(["jumpType","You must specify the type of jump"]))),null!=(n=u.fields.ticketType.value)&&n.id||(t=!0,s(T.a.forms.manifest.setFieldError(["ticketType","You must select a ticket type to manifest"]))),!t}),[JSON.stringify(u.fields)]),g=o.useCallback((function(){var n,t,l,r,a,o,i,d,c,m,f,b,g,h,y,E,I,S,O,k,w,j,z,C,$;return x.a.async((function(N){for(;;)switch(N.prev=N.next){case 0:if(v()){N.next=2;break}return N.abrupt("return");case 2:return N.prev=2,N.next=5,x.a.awrap(p({variables:ee({jumpTypeId:Number(null==(n=u.fields.jumpType.value)?void 0:n.id),extraIds:null==(t=u.fields.extras)||null==(l=t.value)?void 0:l.map((function(e){var n=e.id;return Number(n)})),loadId:Number(null==(r=u.fields.load.value)?void 0:r.id),rigId:null!=(a=u.fields.rig.value)&&a.id?Number(null==(o=u.fields.rig.value)?void 0:o.id):null,ticketTypeId:Number(null==(i=u.fields.ticketType)||null==(d=i.value)?void 0:d.id),dropzoneUserId:Number(null==(c=u.fields.dropzoneUser)||null==(m=c.value)?void 0:m.id),exitWeight:u.fields.exitWeight.value},null!=(f=u.fields.ticketType.value)&&f.isTandem?{passengerName:null==(b=u.fields.passengerName)?void 0:b.value,passengerExitWeight:null==(g=u.fields.passengerExitWeight)?void 0:g.value}:{})}));case 5:if(z=N.sent,null==(h=z.data)||null==(y=h.createSlot)||null==(E=y.fieldErrors)||E.map((function(e){var n=e.field,t=e.message;switch(n){case"jump_type":return s(T.a.forms.manifest.setFieldError(["jumpType",t]));case"load":return s(T.a.forms.manifest.setFieldError(["load",t]));case"credits":case"extras":case"extra_ids":return s(T.a.forms.manifest.setFieldError(["extras",t]));case"ticket_type":return s(T.a.forms.manifest.setFieldError(["ticketType",t]));case"rig":return s(T.a.forms.manifest.setFieldError(["rig",t]));case"dropzone_user":return s(T.a.forms.manifest.setFieldError(["dropzoneUser",t]));case"exit_weight":return s(T.a.forms.manifest.setFieldError(["exitWeight",t]))}})),null==z||null==(I=z.data)||null==(S=I.createSlot)||null==(O=S.errors)||!O.length){N.next=9;break}return N.abrupt("return",s(T.a.notifications.showSnackbar({message:null==z||null==(C=z.data)||null==($=C.createSlot)?void 0:$.errors[0],variant:"error"})));case 9:null!=(k=z.data)&&null!=(w=k.createSlot)&&null!=(j=w.fieldErrors)&&j.length||e.onSuccess(),N.next=15;break;case 12:N.prev=12,N.t0=N.catch(2),s(T.a.notifications.showSnackbar({message:N.t0.message,variant:"error"}));case 15:case"end":return N.stop()}}),null,null,[[2,12]],Promise)}),[JSON.stringify(u.fields),p,e.onSuccess]);return o.createElement(k.a,null,o.createElement(w.a,{visible:!!e.open,style:{maxHeight:500}},o.createElement(m.a,{indeterminate:!0,visible:b.loading,color:d.theme.colors.accent}),o.createElement(w.a.Title,null,"Manifest "+(null==u||null==(n=u.fields)||null==(t=n.dropzoneUser)||null==(l=t.value)||null==(r=l.user)?void 0:r.name)+" on "+(null==(a=u.fields.load)||null==(i=a.value)?void 0:i.name)),o.createElement(w.a.ScrollArea,null,o.createElement(O.a,null,o.createElement(_,null))),o.createElement(w.a.Actions,{style:{justifyContent:"flex-end"}},o.createElement(j.a,{onPress:function(){s(T.a.forms.manifest.reset()),e.onClose()}},"Cancel"),o.createElement(j.a,{onPress:g},"Manifest"))))}var le,re=t(2),ae=t(641),oe=t(661),ie=t(477),se=t(288),ue=t(331),de=Object(U.a)(le||(le=E()(["\n  query QueryDropzoneUsersSearch(\n    $dropzoneId: Int!\n    $search: String\n  ) {\n    dropzone(id: $dropzoneId) {\n      id\n      name\n\n      dropzoneUsers(search: $search, licensed: true) {\n        edges {\n          node {\n            id\n            role {\n              id\n              name\n            }\n            user {\n              id\n              image\n              name\n              exitWeight\n            }\n\n            availableRigs {\n              id\n              make\n              model\n              canopySize\n              serial\n\n              user {\n                id\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n"])));function ce(e){var n,t,l,r,a,i,s=Object(T.c)((function(e){return e})).screens,u=Object(T.b)(),d=o.useState(""),m=h()(d,2),f=m[0],p=m[1],b=Object(T.c)((function(e){return e.global})).currentDropzoneId,v=Object(S.useQuery)(de,{variables:{dropzoneId:Number(b),search:f}}),g=v.data,y=(v.loading,Object(V.b)().currentUser),E=Object(Y.a)(A.b.CreateUserSlot),I=Object(Y.a)(A.b.CreateUserSlotWithSelf);return o.createElement(o.Fragment,null,o.createElement(ie.a,{value:f,onChangeText:p,placeholder:"Search skydivers"}),o.createElement(re.a,{style:{height:380}},o.createElement(c.b,{contentContainerStyle:{paddingTop:16}},!(null!=g&&null!=(n=g.dropzone)&&null!=(t=n.dropzoneUsers)&&null!=(l=t.edges)&&l.length)&&o.createElement(ue.a,{title:"No users",subtitle:""}),null==g||null==(r=g.dropzone)||null==(a=r.dropzoneUsers)||null==(i=a.edges)?void 0:i.map((function(e){var n,t,l,r,a;return o.createElement(o.Fragment,null,o.createElement(N.b.Item,{style:{width:"100%"},key:"user-"+(null==e||null==(n=e.node)?void 0:n.id),title:null==e||null==(t=e.node)?void 0:t.user.name,description:null==e||null==(l=e.node)||null==(r=l.role)?void 0:r.name,left:function(){var n,t,l;return null!=e&&null!=(n=e.node)&&null!=(t=n.user)&&t.image?o.createElement(N.a.Image,{source:{uri:null==e||null==(l=e.node)?void 0:l.user.image},style:{alignSelf:"center",marginHorizontal:12},size:32}):o.createElement(N.b.Icon,{icon:"account"})},right:function(){var n;return o.createElement(se.a,{status:null!=(n=s.manifest.selectedUsers)&&n.map((function(e){return e.id})).includes(e.node.id)?"checked":"unchecked"})},disabled:(null==e||null==(a=e.node)?void 0:a.user.id)===(null==y?void 0:y.id)&&I&&!E,onPress:function(){var n,t;u(T.a.screens.manifest.setSelected(null!=(n=s.manifest.selectedUsers)&&n.find((function(n){var t;return n.id===""+(null==e||null==(t=e.node)?void 0:t.id)}))?null==(t=s.manifest.selectedUsers)?void 0:t.filter((function(n){var t;return n.id!==""+(null==e||null==(t=e.node)?void 0:t.id)})):[].concat(C()(s.manifest.selectedUsers),[e.node])))}}),o.createElement(F.a,{style:{width:"100%"},key:"divider-"+(null==e?void 0:e.node.id)}))})))),o.createElement(j.a,{onPress:function(){u(T.a.forms.manifestGroup.setDropzoneUsers(s.manifest.selectedUsers)),e.onNext()},style:fe.button,mode:"contained"},"Next"))}var me,fe=u.a.create({button:{width:"100%",borderRadius:16,padding:5},scrollView:{height:100}}),pe=Object(S.gql)(me||(me=E()(["\n  mutation CreateSlot(\n    $jumpTypeId: Int\n    $extraIds: [Int!]\n    $loadId: Int\n    $ticketTypeId: Int\n    $userGroup: [SlotUser!]!,\n  ) {\n    createSlots(\n      input: {\n        attributes: {\n          jumpTypeId: $jumpTypeId\n          extraIds: $extraIds\n          loadId: $loadId\n          ticketTypeId: $ticketTypeId\n          userGroup: $userGroup,\n        }\n      }\n    ) {\n      errors\n      fieldErrors {\n        field\n        message\n      }\n      \n      load {\n        id\n        name\n        loadNumber\n        createdAt\n        dispatchAt\n        hasLanded\n        maxSlots\n        isFull\n        isOpen\n        plane {\n          id\n          name\n        }\n        gca {\n          id\n          user {\n            id\n            name\n          }\n        }\n        pilot {\n          id\n          user {\n            id\n            name\n          }\n        }\n        loadMaster {\n          id\n          user {\n            id\n            name\n          }\n        }\n        slots {\n          id\n          createdAt\n          user {\n            id\n            name\n          }\n          passengerName\n          passengerExitWeight\n          ticketType {\n            id\n            name\n            isTandem\n            altitude\n          }\n          jumpType {\n            id\n            name\n          }\n          extras {\n            id\n            name\n          }\n        }\n      }\n    }\n  }\n"])));function be(e){var n,t,l,r,a=e.open,i=Object(T.b)(),s=Object(T.c)((function(e){return e.forms.manifestGroup})),u=(Object(T.c)((function(e){return e.global})),Object(S.useMutation)(pe)),d=h()(u,2),m=d[0],f=d[1],p=o.useState(0),b=h()(p,2),v=b[0],g=b[1],y=o.useCallback((function(){var e,n,t=!1;return null!=(e=s.fields.jumpType.value)&&e.id||(t=!0,i(T.a.forms.manifestGroup.setFieldError(["jumpType","You must specify the type of jump"]))),null!=(n=s.fields.ticketType.value)&&n.id||(t=!0,i(T.a.forms.manifestGroup.setFieldError(["ticketType","You must select a ticket type to manifest"]))),!t}),[JSON.stringify(s.fields)]),E=o.useCallback((function(){var n,t,l,r,a,o,u,d,c,f,p,b,v,g,h,E,I;return x.a.async((function(S){for(;;)switch(S.prev=S.next){case 0:if(y()){S.next=2;break}return S.abrupt("return");case 2:return S.prev=2,S.next=5,x.a.awrap(m({variables:{jumpTypeId:Number(null==(n=s.fields.jumpType.value)?void 0:n.id),ticketTypeId:Number(null==(t=s.fields.ticketType.value)?void 0:t.id),extraIds:null==(l=s.fields.extras)||null==(r=l.value)?void 0:r.map((function(e){var n=e.id;return Number(n)})),loadId:Number(null==(a=s.fields.load.value)?void 0:a.id),userGroup:s.fields.users.value}}));case 5:if(h=S.sent,null==(o=h.data)||null==(u=o.createSlots)||null==(d=u.fieldErrors)||d.map((function(e){var n=e.field,t=e.message;switch(n){case"jump_type":return i(T.a.forms.manifestGroup.setFieldError(["jumpType",t]));case"load":return i(T.a.forms.manifestGroup.setFieldError(["load",t]));case"credits":case"extras":case"extra_ids":return i(T.a.forms.manifestGroup.setFieldError(["extras",t]));case"ticket_type":return i(T.a.forms.manifestGroup.setFieldError(["ticketType",t]))}})),null==h||null==(c=h.data)||null==(f=c.createSlots)||null==(p=f.errors)||!p.length){S.next=9;break}return S.abrupt("return",i(T.a.notifications.showSnackbar({message:null==h||null==(E=h.data)||null==(I=E.createSlots)?void 0:I.errors[0],variant:"error"})));case 9:null!=(b=h.data)&&null!=(v=b.createSlots)&&null!=(g=v.fieldErrors)&&g.length||e.onClose(),S.next=15;break;case 12:S.prev=12,S.t0=S.catch(2),i(T.a.notifications.showSnackbar({message:S.t0.message,variant:"error"}));case 15:case"end":return S.stop()}}),null,null,[[2,12]],Promise)}),[JSON.stringify(s.fields),m,e.onSuccess]),I=o.useRef(null);o.useEffect((function(){var e,n,t;null!=(e=s.fields.ticketType)&&null!=(n=e.value)&&n.isTandem&&(null==I||null==(t=I.current)||t.snapTo(0))}),[null==(n=s.fields.ticketType)||null==(t=n.value)?void 0:t.isTandem]),o.useEffect((function(){var n,t;a?null==I||null==(n=I.current)||n.snapTo(1):(null==I||null==(t=I.current)||t.close(),e.onClose())}),[a]);o.useMemo((function(){return[0,550]}),[]);return o.createElement(k.a,null,o.createElement(w.a,{visible:!!e.open,onDismiss:e.onClose},o.createElement(re.a,{style:{backgroundColor:"white"},testID:"manifest-group-sheet"},o.createElement(re.a,{pointerEvents:((null==(l=s.fields.users)||null==(r=l.value)?void 0:r.length)||0)>0?void 0:"none"},o.createElement(ae.b,{defaultIndex:v,mode:"fixed",onChangeIndex:g},o.createElement(ae.a,{label:"Create group"},o.createElement(re.a,null)),o.createElement(ae.a,{label:"Configure jump"},o.createElement(re.a,null)))),0===v?o.createElement(re.a,{style:ve.userListContainer},o.createElement(ce,{onNext:function(){return g(1)}})):o.createElement(c.b,{contentContainerStyle:{paddingBottom:200,flexGrow:1}},o.createElement(oe.a,null),o.createElement(re.a,{style:ve.buttonContainer},o.createElement(j.a,{onPress:E,loading:f.loading,mode:"contained",style:ve.button},"Save"))))))}var ve=u.a.create({button:{width:"100%",borderRadius:16,padding:5},buttonContainer:{paddingHorizontal:16,backgroundColor:"white"},contentContainer:{paddingHorizontal:16,paddingBottom:32},userListContainer:{height:"100%",backgroundColor:"white",width:"100%",padding:16},sheet:{elevation:3,backgroundColor:"white",flexGrow:1,height:"100%",display:"flex",flexDirection:"column",justifyContent:"center",paddingBottom:32},sheetHeader:{elevation:2,borderTopLeftRadius:15,borderTopRightRadius:15,height:30,shadowColor:"#000",shadowOffset:{width:0,height:-4},backgroundColor:"white",shadowOpacity:.22,shadowRadius:2.22}}),ge=t(137),he=t(364);function ye(e){var n=e.hasPlanes,t=e.hasTicketTypes,l=(e.isPublic,Object(he.a)());return o.createElement(ge.b,{style:{width:"70%"}},o.createElement(ge.a,{style:xe.title},"Set up dropzone"),o.createElement(ge.b,{style:xe.separator,lightColor:"#eee",darkColor:"rgba(255,255,255,0.1)"}),o.createElement(N.b.Item,{title:"Create dropzone",left:function(){return o.createElement(N.b.Icon,{color:l.success,icon:"check"})}}),o.createElement(N.b.Item,{title:"Add a plane",left:function(){return n?o.createElement(N.b.Icon,{color:l.success,icon:"check"}):o.createElement(N.b.Icon,{color:l.error,icon:"close"})}}),o.createElement(N.b.Item,{title:"Configure jump tickets",left:function(){return t?o.createElement(N.b.Icon,{color:l.success,icon:"check"}):o.createElement(N.b.Icon,{color:l.error,icon:"close"})}}))}var Ee,Ie,xe=u.a.create({container:{flex:1,alignItems:"center",justifyContent:"center"},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"}}),Se=t(105),Oe=t(368),ke=t(337),we=t(338),je=t(89),Te=t(370),ze=t(779),Ce=Object(S.gql)(Ee||(Ee=E()(["\n  query QueryLoad($id: Int!) {\n    load(id: $id) {\n      id\n      name\n      createdAt\n      dispatchAt\n      hasLanded\n      maxSlots\n      loadNumber\n      state\n      plane {\n        id\n        name\n        maxSlots\n      }\n      gca {\n        id\n        user {\n          id\n          name\n        }\n      }\n      pilot {\n        id\n        user {\n          id\n          name\n        }\n      }\n      loadMaster {\n        id\n        user {\n          id\n          name\n        }\n      }\n      slots {\n        id\n        createdAt\n        exitWeight\n        passengerName\n        passengerExitWeight\n        \n        dropzoneUser {\n          id\n          user {\n            id\n            name\n            exitWeight\n          }\n        }\n        ticketType {\n          id\n          name\n          altitude\n          isTandem\n\n          extras {\n            id\n            name\n            cost\n          }\n        }\n        jumpType {\n          id\n          name\n        }\n        extras {\n          id\n          name\n        }\n      }\n    }\n  }\n"]))),$e=Object(S.gql)(Ie||(Ie=E()(["\n  mutation UpdateLoad(\n    $id: Int!,\n    $pilotId: Int,\n    $gcaId: Int,\n    $planeId: Int,\n    $isOpen: Boolean,\n    $loadMasterId: Int,\n    $dispatchAt: Int,\n    $hasLanded: Boolean,\n  ){\n    updateLoad(input: {\n      id: $id\n      attributes: {\n        pilotId: $pilotId,\n        gcaId: $gcaId,\n        planeId: $planeId,\n        isOpen: $isOpen,\n        loadMasterId: $loadMasterId\n        dispatchAt: $dispatchAt\n        hasLanded: $hasLanded\n      }\n    }) {\n      load {\n        id\n        name\n        createdAt\n        loadNumber\n        dispatchAt\n        hasLanded\n        maxSlots\n        state\n        plane {\n          id\n          name\n        }\n        gca {\n          id\n          user {\n            id\n            name\n          }\n        }\n        pilot {\n          id\n          user {\n            id\n            name\n          }\n        }\n        loadMaster {\n          id\n          user {\n            id\n            name\n          }\n        }\n        slots {\n          id\n          createdAt\n          exitWeight\n\n          passengerName\n          passengerExitWeight\n\n          user {\n            id\n            name\n          }\n          ticketType {\n            id\n            name\n            altitude\n            isTandem\n          }\n          jumpType {\n            id\n            name\n          }\n          extras {\n            id\n            name\n          }\n        }\n      }\n    }\n  }\n"]))),Ne={open:je.d,cancelled:je.b,boarding_call:je.e};function Pe(e){var n,t,l,r,a,i,s,u,d,c,m,f=Object(T.b)(),p=e.load,b=e.onPress,g=Object(S.useQuery)(Ce,{variables:{id:Number(p.id)},pollInterval:3e4}),y=g.data,E=(g.loading,g.refetch),I=Object(V.b)(),O=Object(S.useMutation)($e),k=h()(O,2),w=k[0],j=(k[1],o.useCallback((function(e){return x.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,x.a.awrap(w({variables:{id:Number(p.id),pilotId:Number(e.id)}}));case 3:n.next=7;break;case 5:n.prev=5,n.t0=n.catch(0);case 7:case"end":return n.stop()}}),null,null,[[0,5]],Promise)}),[w,JSON.stringify(p)])),z=o.useCallback((function(e){return x.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,x.a.awrap(w({variables:{id:Number(p.id),planeId:Number(e.id)}}));case 3:n.next=7;break;case 5:n.prev=5,n.t0=n.catch(0);case 7:case"end":return n.stop()}}),null,null,[[0,5]],Promise)}),[w,JSON.stringify(p)]),C=(n={},v()(n,A.a.Open,"Open"),v()(n,A.a.BoardingCall,"On call"),v()(n,A.a.Cancelled,"Cancelled"),v()(n,A.a.InFlight,"In air"),v()(n,A.a.Landed,"Landed"),n);return o.createElement(Se.a,{testID:"load-card",style:{margin:16,borderRadius:8,opacity:["cancelled","landed"].includes(null==y||null==(t=y.load)?void 0:t.state)?.5:1},elevation:3,onPress:b},o.createElement(Oe.a,{style:{backgroundColor:Ne[null==y||null==(l=y.load)?void 0:l.state],marginTop:-5,marginRight:-5}},C[null==y||null==(r=y.load)?void 0:r.state]||""),o.createElement(Se.a.Title,{style:{justifyContent:"space-between"},title:"Load #"+p.loadNumber,subtitle:p.name,right:function(){var e,n;return null==y||null==(e=y.load)||!e.dispatchAt||Object(ze.a)(new Date,null==y||null==(n=y.load)?void 0:n.dispatchAt)?null:o.createElement(ge.b,{style:{marginRight:16}},o.createElement(Te.a,{end:new Date(1e3*y.load.dispatchAt)}))}}),o.createElement(Se.a.Content,{style:Ue.cardContent},o.createElement(ge.b,{style:{flexDirection:"row",flexWrap:"wrap"}},o.createElement(we.a,{value:null==y||null==(a=y.load)?void 0:a.plane,small:!0,onSelect:function(e){var n,t,l,r,a;return x.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:if(!(((null==y||null==(n=y.load)||null==(t=n.slots)?void 0:t.length)||0)>(e.maxSlots||0))){o.next=5;break}a=((null==y||null==(l=y.load)||null==(r=l.slots)?void 0:r.length)||0)-(e.maxSlots||0),f(T.a.notifications.showSnackbar({message:"You need to take "+a+" people off the load to fit on this plane",variant:"warning"})),o.next=8;break;case 5:return o.next=7,x.a.awrap(z(e));case 7:E();case 8:case"end":return o.stop()}}),null,null,null,Promise)}}),o.createElement(ke.a,{dropzoneId:Number(null==I||null==(i=I.dropzone)?void 0:i.id),value:null==y||null==(s=y.load)?void 0:s.pilot,onSelect:j,small:!0}),o.createElement(P.a,{mode:"outlined",icon:"parachute",style:Ue.smallChip,textStyle:Ue.smallChipText},null==y||null==(u=y.load)||null==(d=u.slots)?void 0:d.length," / ",null==y||null==(c=y.load)||null==(m=c.plane)?void 0:m.maxSlots))))}var Fe,De,Ae,Ue=u.a.create({cardContent:{marginVertical:8,overflow:"hidden",flexDirection:"row"},smallChip:{height:25,margin:4,alignItems:"center"},smallChipText:{fontSize:12}}),Le=t(48),We=t(163),Ge=t(473),Re=t(318),Me=t(108),Je=t(369),qe=t(679),Be=t(336),He=t(367),Ye=t(635),Qe=Object(S.gql)(Fe||(Fe=E()(["\n  query QueryLoad($id: Int!) {\n    load(id: $id) {\n      id\n      name\n      createdAt\n      dispatchAt\n      hasLanded\n      maxSlots\n      loadNumber\n      isFull\n      isOpen\n      plane {\n        id\n        name\n      }\n      gca {\n        id\n        user {\n          id\n          name\n        }\n      }\n      pilot {\n        id\n        user {\n          id\n          name\n        }\n      }\n      loadMaster {\n        id\n        user {\n          id\n          name\n        }\n      }\n      slots {\n        id\n        createdAt\n        exitWeight\n        passengerName\n        passengerExitWeight\n        \n        dropzoneUser {\n          id\n          user {\n            id\n            name\n            exitWeight\n          }\n        }\n        ticketType {\n          id\n          name\n          altitude\n          isTandem\n\n          extras {\n            id\n            name\n            cost\n          }\n        }\n        jumpType {\n          id\n          name\n        }\n        extras {\n          id\n          name\n        }\n      }\n    }\n  }\n"]))),Ve=Object(S.gql)(De||(De=E()(["\n  mutation UpdateLoad(\n    $id: Int!,\n    $pilotId: Int,\n    $gcaId: Int,\n    $planeId: Int,\n    $isOpen: Boolean,\n    $loadMasterId: Int,\n    $dispatchAt: Int,\n    $hasLanded: Boolean,\n  ){\n    updateLoad(input: {\n      id: $id\n      attributes: {\n        pilotId: $pilotId,\n        gcaId: $gcaId,\n        planeId: $planeId,\n        isOpen: $isOpen,\n        loadMasterId: $loadMasterId\n        dispatchAt: $dispatchAt\n        hasLanded: $hasLanded\n      }\n    }) {\n      load {\n        id\n        name\n        createdAt\n        loadNumber\n        dispatchAt\n        hasLanded\n        maxSlots\n        isFull\n        isOpen\n        plane {\n          id\n          name\n        }\n        gca {\n          id\n          user {\n            id\n            name\n          }\n        }\n        pilot {\n          id\n          user {\n            id\n            name\n          }\n        }\n        loadMaster {\n          id\n          user {\n            id\n            name\n          }\n        }\n        slots {\n          id\n          createdAt\n          exitWeight\n\n          passengerName\n          passengerExitWeight\n\n          user {\n            id\n            name\n          }\n          ticketType {\n            id\n            name\n            altitude\n            isTandem\n          }\n          jumpType {\n            id\n            name\n          }\n          extras {\n            id\n            name\n          }\n        }\n      }\n    }\n  }\n"]))),_e=Object(S.gql)(Ae||(Ae=E()(["\nmutation DeleteSlot($id: Int!) {\n  deleteSlot(input: { id: $id }) {\n    slot {\n      id\n      load {\n        id\n        slots {\n          id\n          createdAt\n          exitWeight\n\n          passengerName\n          passengerExitWeight\n\n          user {\n            id\n            name\n          }\n          ticketType {\n            id\n            name\n            altitude\n            isTandem\n          }\n          jumpType {\n            id\n            name\n          }\n          extras {\n            id\n            name\n          }\n        }  \n      }\n    }\n  }\n}\n"])));function Xe(e){var n,t,l,r,a,i,s,u,d,c,f,p,b,v,g,y,E,I,k,w,z,C,$,N,P,F,D,U,L=Object(T.c)((function(e){return e.global})),W=Object(T.b)(),G=o.useState(!1),R=h()(G,2),M=R[0],J=R[1],q=o.useState(!1),B=h()(q,2),H=B[0],Q=B[1],_=e.load,X=e.onManifest,Z=e.onManifestGroup,K=Object(S.useQuery)(Qe,{variables:{id:Number(_.id)}}),ee=K.data,ne=K.loading,te=K.refetch,le=Object(V.b)(),re=le.currentUser,ae=Object(S.useMutation)(Ve),oe=h()(ae,2),ie=oe[0],se=oe[1],ue=Object(S.useMutation)(_e),de=h()(ue,2),ce=de[0],me=(de[1],o.useCallback((function(e){var n,t,l;return x.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,x.a.awrap(ce({variables:{id:Number(e.id)}}));case 3:null!=(l=r.sent)&&null!=(n=l.data)&&null!=(t=n.deleteSlot)&&t.errors&&W(T.a.notifications.showSnackbar({message:l.data.deleteSlot.errors[0],variant:"error"})),r.next=9;break;case 7:r.prev=7,r.t0=r.catch(0);case 9:case"end":return r.stop()}}),null,null,[[0,7]],Promise)}),[ie,JSON.stringify(_)])),fe=o.useCallback((function(e){return x.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,x.a.awrap(ie({variables:{id:Number(_.id),pilotId:Number(e.id)}}));case 3:n.next=7;break;case 5:n.prev=5,n.t0=n.catch(0);case 7:case"end":return n.stop()}}),null,null,[[0,5]],Promise)}),[ie,JSON.stringify(_)]),pe=o.useCallback((function(e){return x.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,x.a.awrap(ie({variables:{id:Number(_.id),gcaId:Number(e.id)}}));case 3:n.next=7;break;case 5:n.prev=5,n.t0=n.catch(0);case 7:case"end":return n.stop()}}),null,null,[[0,5]],Promise)}),[ie,JSON.stringify(_)]),be=o.useCallback((function(e){return x.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,x.a.awrap(ie({variables:{id:Number(_.id),planeId:Number(e.id)}}));case 3:n.next=7;break;case 5:n.prev=5,n.t0=n.catch(0);case 7:case"end":return n.stop()}}),null,null,[[0,5]],Promise)}),[ie,JSON.stringify(_)]),ve=o.useCallback((function(e){return x.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,x.a.awrap(ie({variables:{id:Number(_.id),loadMasterId:Number(e.id)}}));case 3:n.next=7;break;case 5:n.prev=5,n.t0=n.catch(0);case 7:case"end":return n.stop()}}),null,null,[[0,5]],Promise)}),[ie,JSON.stringify(_)]),he=o.useCallback((function(e){var n;return x.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e?Object(Je.a)(new Date,e).getTime()/1e3:null,t.prev=1,t.next=4,x.a.awrap(ie({variables:{id:Number(_.id),dispatchAt:n?Math.ceil(n):null}}));case 4:t.next=8;break;case 6:t.prev=6,t.t0=t.catch(1);case 8:case"end":return t.stop()}}),null,null,[[1,6]],Promise)}),[ie,JSON.stringify(_)]),ye=o.useCallback((function(){return x.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x.a.awrap(ie({variables:{id:Number(_.id),hasLanded:!0}}));case 3:e.next=7;break;case 5:e.prev=5,e.t0=e.catch(0);case 7:case"end":return e.stop()}}),null,null,[[0,5]],Promise)}),[ie,JSON.stringify(_)]),Ee=Object(Y.a)(A.b.UpdateLoad),Ie=Object(Y.a)(A.b.UpdateSlot),xe=Object(Y.a)(A.b.UpdateUserSlot),Oe=Object(Y.a)(A.b.DeleteSlot),je=Object(Y.a)(A.b.DeleteUserSlot),Te=Object(Y.a)(A.b.CreateSlot),ze=Object(Y.a)(A.b.CreateUserSlot),Ce=Object(Y.a)(A.b.CreateUserSlotWithSelf),$e=Te&&(null==ee||null==(n=ee.load)?void 0:n.isOpen)&&!(null!=ee&&null!=(t=ee.load)&&t.isFull);o.useEffect((function(){var e,n;null!=ee&&null!=(e=ee.load)&&e.maxSlots&&(null==ee||null==(n=ee.load)?void 0:n.maxSlots)<5&&!M&&J(!0)}),[null==ee||null==(l=ee.load)?void 0:l.maxSlots]);var Ne=(ze||Ce)&&!(null!=ee&&null!=(r=ee.load)&&r.hasLanded)&&(!(null!=ee&&null!=(a=ee.load)&&a.dispatchAt)||(null==ee?void 0:ee.load.dispatchAt)>(new Date).getTime()/1e3);return o.createElement(Se.a,{testID:"load-card",style:{margin:16,opacity:null!=ee&&null!=(i=ee.load)&&i.hasLanded?.5:1},elevation:3},o.createElement(Se.a.Title,{style:{justifyContent:"space-between"},title:o.createElement(ge.b,{style:{width:"100%",flex:1,flexDirection:"row",alignItems:"center",justifyContent:"space-between"}},o.createElement(Le.a,null,"Load "+((null==ee||null==(s=ee.load)?void 0:s.loadNumber)||0)),o.createElement(ge.b,{style:{flexGrow:1}}),Ne&&o.createElement(We.a,{icon:"account-group",testID:"manifest-group-button",onPress:function(){W(T.a.forms.manifestGroup.reset()),W(T.a.forms.manifestGroup.setField(["load",_])),Ce&&!ze&&(W(T.a.screens.manifest.setSelected([re])),W(T.a.forms.manifestGroup.setDropzoneUsers([re]))),Z&&Z()}})),subtitle:_.name}),o.createElement(m.a,{visible:ne||se.loading,color:L.theme.colors.accent}),o.createElement(Se.a.Content,{style:{marginVertical:8,height:M?void 0:300,overflow:"hidden"}},o.createElement(ge.b,{style:{flexDirection:"row"}},o.createElement(O.a,{horizontal:!0,showsHorizontalScrollIndicator:!1},o.createElement(we.a,{value:null==ee||null==(u=ee.load)?void 0:u.plane,onSelect:function(e){var n,t,l,r,a;return x.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:if(!(((null==ee||null==(n=ee.load)||null==(t=n.slots)?void 0:t.length)||0)>(e.maxSlots||0))){o.next=5;break}a=((null==ee||null==(l=ee.load)||null==(r=l.slots)?void 0:r.length)||0)-(e.maxSlots||0),W(T.a.notifications.showSnackbar({message:"You need to take "+a+" people off the load to fit on this plane",variant:"warning"})),o.next=8;break;case 5:return o.next=7,x.a.awrap(be(e));case 7:te();case 8:case"end":return o.stop()}}),null,null,null,Promise)}}),o.createElement(Be.b,{dropzoneId:Number(null==le||null==(d=le.dropzone)?void 0:d.id),value:null==ee||null==(c=ee.load)?void 0:c.gca,onSelect:pe}),o.createElement(ke.a,{dropzoneId:Number(null==le||null==(f=le.dropzone)?void 0:f.id),value:null==ee||null==(p=ee.load)?void 0:p.pilot,onSelect:fe}),o.createElement(He.a,{value:null==ee||null==(b=ee.load)?void 0:b.loadMaster,slots:(null==ee?void 0:ee.load.slots)||[],onSelect:ve}))),o.createElement(Ge.a,null,o.createElement(Ge.a.Header,{style:{width:"100%"}},o.createElement(Ge.a.Title,null,"Name"),o.createElement(Ge.a.Title,{numeric:!0},"Jump type"),o.createElement(Ge.a.Title,{numeric:!0},"Altitude")),null==ee||null==(v=ee.load)||null==(g=v.slots)?void 0:g.map((function(n){var t,l,r,a,i,s,u,d,c=null==ee||null==(t=ee.load)||null==(l=t.slots)?void 0:l.filter((function(e){var t=e.groupNumber;return t&&t===n.groupNumber})),m=(null==n||null==(r=n.user)?void 0:r.id)===(null==re?void 0:re.id);return o.createElement(Ye.a,{disabled:m&&!Oe||!m&&!je,key:"slot-"+n.id,rightAction:{label:"Delete",backgroundColor:"red",onPress:function(){return me(n)}}},o.createElement(Ge.a.Row,{testID:"slot-row",disabled:!(null==ee||null==(a=ee.load)||!a.hasLanded),onPress:function(){var t;(null==(t=n.user)?void 0:t.id)===(null==re?void 0:re.id)?Ie&&(null!=c&&c.length?e.onSlotGroupPress(c):e.onSlotPress(n)):xe&&(null!=c&&c.length?e.onSlotGroupPress(c):e.onSlotPress(n))},pointerEvents:"none"},o.createElement(Ge.a.Cell,null,o.createElement(Re.a,{style:Ke.slotText},null==n||null==(i=n.dropzoneUser)||null==(s=i.user)?void 0:s.name)),o.createElement(Ge.a.Cell,{numeric:!0},o.createElement(Re.a,{style:Ke.slotText},null==n||null==(u=n.jumpType)?void 0:u.name)),o.createElement(Ge.a.Cell,{numeric:!0},o.createElement(Re.a,{style:Ke.slotText},((null==n||null==(d=n.ticketType)?void 0:d.altitude)||14e3)/1e3,"k"))))})),Array.from({length:((null==ee||null==(y=ee.load)?void 0:y.maxSlots)||0)-((null==ee||null==(E=ee.load)||null==(I=E.slots)?void 0:I.length)||0)},(function(e,n){return n})).map((function(e){return o.createElement(Ge.a.Row,{key:_.id+"-empty-slot-"+e,testID:"slot-row"},o.createElement(Ge.a.Cell,null,o.createElement(Re.a,{style:Ke.slotText},"- Available -")),o.createElement(Ge.a.Cell,{numeric:!0},"-"),o.createElement(Ge.a.Cell,{numeric:!0},"-"))})))),!(null==ee||null==(k=ee.load)||!k.dispatchAt)&&(null==ee||null==(w=ee.load)?void 0:w.dispatchAt)>(new Date).getTime()/1e3&&o.createElement(ge.b,{style:{flex:1,backgroundColor:"black",padding:8}},o.createElement(Re.a,{style:{color:"#FFFFFF"}},"Take-off in "+Object(qe.a)(new Date,1e3*(null==ee||null==(z=ee.load)?void 0:z.dispatchAt))+" min")),o.createElement(Se.a.Actions,null,null!=ee&&null!=(C=ee.load)&&C.maxSlots&&(null==ee||null==($=ee.load)?void 0:$.maxSlots)<5?null:o.createElement(j.a,{onPress:function(){return J(!M)},testID:M?"show-less":"show-more"},M?"Show less":"Show more"),o.createElement(ge.b,{style:{flexGrow:1}}),!Ee||null!=ee&&null!=(N=ee.load)&&N.hasLanded?null:null!=ee&&null!=(P=ee.load)&&P.dispatchAt?o.createElement(j.a,{mode:"outlined",onPress:function(){return he(null)},testID:"dispatch-cancel"},"Cancel"):o.createElement(Me.a,{onDismiss:function(){return Q(!1)},visible:H,anchor:o.createElement(j.a,{mode:"outlined",onPress:function(){return Q(!0)},testID:"dispatch-button"},"Dispatch")},o.createElement(Me.a.Item,{testID:"dispatch-call",onPress:function(){Q(!1),he(20)},title:"20 minute call"}),o.createElement(Me.a.Item,{testID:"dispatch-call",onPress:function(){Q(!1),he(15)},title:"15 minute call"}),o.createElement(Me.a.Item,{testID:"dispatch-call",onPress:function(){Q(!1),he(10)},title:"10 minute call"}),o.createElement(Me.a.Item,{onPress:function(){Q(!1),he(5)},title:"5 minute call"})),null!=ee&&null!=(F=ee.load)&&F.hasLanded?null:null!=ee&&null!=(D=ee.load)&&D.dispatchAt&&(null==ee?void 0:ee.load.dispatchAt)<(new Date).getTime()/1e3&&Ee?o.createElement(j.a,{style:{marginLeft:8},mode:"contained",onPress:function(){var e,n,t,l;return null!=ee&&null!=(e=ee.load)&&null!=(n=e.loadMaster)&&n.id?null!=ee&&null!=(t=ee.load)&&null!=(l=t.pilot)&&l.id?void ye():W(T.a.notifications.showSnackbar({message:"You must select a pilot before this load can be finalized",variant:"warning"})):W(T.a.notifications.showSnackbar({message:"You must select a load master before this load can be finalized",variant:"warning"}))}},"Mark as landed"):o.createElement(j.a,{style:{marginLeft:8},mode:"contained",testID:"manifest-button",onPress:function(){return X()},disabled:!$e||Boolean((null==ee||null==(U=ee.load)?void 0:U.dispatchAt)&&ee.load.dispatchAt<(new Date).getTime()/1e3)},"Manifest")))}var Ze,Ke=u.a.create({container:{flex:1,alignItems:"center",justifyContent:"center",marginVertical:8},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},slotText:{fontSize:12},fab:{position:"absolute",margin:16,right:0,bottom:0}}),en=t(630),nn=t(660),tn=t(629),ln=Object(S.gql)(Ze||(Ze=E()(["\n  mutation CreateLoad(\n    $name: String,\n    $pilotId: Int,\n    $gcaId: Int,\n    $maxSlots: Int!,\n    $planeId: Int,\n    $isOpen: Boolean,\n  ){\n    createLoad(input: {\n      attributes: {\n        name: $name,\n        pilotId: $pilotId,\n        gcaId: $gcaId,\n        maxSlots: $maxSlots,\n        planeId: $planeId,\n        isOpen: $isOpen,\n      }\n    }) {\n      load {\n        id\n        name\n        pilot {\n          id\n          user {\n            id \n            name\n          }\n        }\n        gca {\n          id\n          user {\n            id \n            name\n          }\n        }\n        maxSlots\n        isOpen\n      }\n      fieldErrors {\n        field,\n        message\n      }\n      errors\n    }\n  }\n"])));function rn(e){var n=e.open,t=e.onClose,l=e.onSuccess,r=Object(T.c)((function(e){return e.forms.load})),a=Object(T.c)((function(e){return e.global})).currentDropzoneId,i=Object(T.b)(),s=Object(S.useMutation)(ln),u=h()(s,2),d=u[0],c=u[1],m=o.useCallback((function(){var e=!1;return r.fields.maxSlots.value<1&&(e=!0,i(T.a.forms.load.setFieldError(["maxSlots","Please specify amount of allowed jumpers"]))),r.fields.plane.value||(e=!0,i(T.a.forms.load.setFieldError(["plane","What plane is flying this load?"]))),r.fields.gca.value||(e=!0,i(T.a.forms.load.setFieldError(["gca","You must have a GCA for this load"]))),!e}),[JSON.stringify(r.fields),i]),f=o.useCallback((function(){var e,n,t,o,s,u,c,f,p,b,v,g,h,y,E,I,S,O,k,w,j,z,C,$,N;return x.a.async((function(P){for(;;)switch(P.prev=P.next){case 0:if(e=r.fields,n=e.name,t=e.gca,e.loadMaster,o=e.plane,s=e.maxSlots,u=e.pilot,c=e.isOpen,!m()){P.next=15;break}return P.prev=2,P.next=5,x.a.awrap(d({variables:{dropzoneId:a,name:n.value,maxSlots:s.value,planeId:null!=(f=o.value)&&f.id?Number(null==(p=o.value)?void 0:p.id):null,pilotId:null!=(b=u.value)&&b.id?Number(null==(v=u.value)?void 0:v.id):null,gcaId:null!=(g=t.value)&&g.id?Number(null==(h=t.value)?void 0:h.id):null,isOpen:!!c.value}}));case 5:if(z=P.sent,null==(y=z.data)||null==(E=y.createLoad)||null==(I=E.fieldErrors)||I.map((function(e){var n=e.field,t=e.message;switch(n){case"name":return i(T.a.forms.load.setFieldError(["name",t]));case"maxSlots":return i(T.a.forms.load.setFieldError(["maxSlots",t]));case"plane":return i(T.a.forms.load.setFieldError(["plane",t]));case"gca":return i(T.a.forms.load.setFieldError(["gca",t]));case"is_open":return i(T.a.forms.load.setFieldError(["isOpen",t]));case"pilot":return i(T.a.forms.load.setFieldError(["pilot",t]))}})),null==z||null==(S=z.data)||null==(O=S.createLoad)||null==(k=O.errors)||!k.length){P.next=9;break}return P.abrupt("return",i(en.a.showSnackbar({message:z.data.createLoad.errors[0],variant:"error"})));case 9:null!=(w=z.data)&&null!=(j=w.createLoad)&&j.load&&(N=z.data.createLoad.load,console.log(N),i(en.a.showSnackbar({message:"Load "+N.name+" created",variant:"success"})),null!=(C=z.data)&&null!=($=C.createLoad)&&$.fieldErrors||(l(z.data.createLoad.load),i(T.a.forms.load.reset()))),P.next=15;break;case 12:P.prev=12,P.t0=P.catch(2),i(en.a.showSnackbar({message:P.t0.message,variant:"error"}));case 15:case"end":return P.stop()}}),null,null,[[2,12]],Promise)}),[JSON.stringify(r.fields),i,d]);return o.createElement(tn.a,{open:n,onClose:t,buttonAction:f,buttonLabel:"Create",snapPoints:["30%",650],loading:c.loading,title:"New Load"},o.createElement(nn.a,null))}function an(){var e,n,t,l,r,u=Object(T.c)((function(e){return e.global})),b=Object(T.c)((function(e){return e.forms})),v=Object(T.c)((function(e){return e.screens.manifest})),g=Object(T.b)(),h=Object(V.b)(),y=h.dropzone,E=h.currentUser,I=h.loading,x=h.refetch,S=Object(a.useNavigation)(),O=Object(a.useIsFocused)();o.useEffect((function(){O&&x()}),[O]);var k=!(null==y||null==(e=y.planes)||!e.length),w=!(null==y||null==(n=y.ticketTypes)||!n.length),j=!(null==y||!y.isPublic),z=k&&w;o.useEffect((function(){var e,n,t,l;null!=y&&y.primaryColor&&(null==y?void 0:y.primaryColor)!==(null==(e=u.theme)||null==(n=e.colors)?void 0:n.primary)&&g(T.a.global.setPrimaryColor(y.primaryColor)),null!=y&&y.secondaryColor&&(null==y?void 0:y.secondaryColor)!==(null==(t=u.theme)||null==(l=t.colors)?void 0:l.accent)&&g(T.a.global.setPrimaryColor(y.secondaryColor))}),[null==y?void 0:y.primaryColor,null==y?void 0:y.secondaryColor]);var C=Object(Y.a)(A.b.CreateLoad),$=o.useCallback((function(e){return E.hasLicense?E.hasMembership?E.hasRigInspection?E.hasReserveInDate?E.hasExitWeight?E.hasCredits?(g(T.a.forms.manifest.setOpen(!0)),g(T.a.forms.manifest.setField(["dropzoneUser",E])),void g(T.a.forms.manifest.setField(["load",e]))):g(T.a.notifications.showSnackbar({message:"You have no credits on your account",variant:"warning"})):g(T.a.notifications.showSnackbar({message:"Update your exit weight on your profile before manifesting",variant:"warning"})):g(T.a.notifications.showSnackbar({message:"Your rig needs a reserve repack",variant:"warning"})):g(T.a.notifications.showSnackbar({message:"Your rig needs to be inspected before manifesting",variant:"warning"})):g(T.a.notifications.showSnackbar({message:"Your membership is out of date",variant:"warning"})):g(T.a.notifications.showSnackbar({message:"You need to select a license on your user profile",variant:"warning"}))}),[JSON.stringify(null==y?void 0:y.currentUser)]),N=Object(d.a)().width,P=Math.ceil(N/400)||1;return o.createElement(o.Fragment,null,o.createElement(m.a,{visible:I,indeterminate:!0,color:u.theme.colors.accent}),o.createElement(ge.b,{style:on.header},o.createElement(f.a.Row,{onValueChange:function(e){return g(T.a.screens.manifest.setDisplayStyle(e))},value:v.display},o.createElement(f.a,{icon:"page-layout-header",value:"list"}),o.createElement(f.a,{icon:"page-layout-body",value:"cards"}))),o.createElement(ge.b,{style:on.container},!I&&(z?o.createElement(ge.b,{style:{width:"100%",flex:1,height:i.a.get("window").height}},((null==y||null==(t=y.loads)||null==(l=t.edges)?void 0:l.length)||0)<1?o.createElement(ue.a,{title:"No loads so far today",subtitle:"How's the weather?"}):o.createElement(c.a,{testID:"loads",keyExtractor:function(e){var n;return"load-"+(null==e||null==(n=e.node)?void 0:n.id)},key:"loads-columns-"+P,style:{flex:1,height:i.a.get("window").height},contentContainerStyle:{flexGrow:1,paddingBottom:100},numColumns:P,data:(null==y||null==(r=y.loads)?void 0:r.edges)||[],refreshing:I,onRefresh:x,refreshControl:o.createElement(s.a,{refreshing:I,onRefresh:function(){return x()}}),renderItem:function(e){var n=e.item;e.index;return"list"===v.display?o.createElement(Xe,{key:"load-"+n.node.id,load:n.node,onSlotPress:function(e){g(T.a.forms.manifest.setOpen(e)),g(T.a.forms.manifest.setField(["load",n.node]))},onSlotGroupPress:function(e){g(T.a.forms.manifestGroup.reset()),g(T.a.forms.manifestGroup.setFromSlots(e)),g(T.a.forms.manifestGroup.setField(["load",n.node])),S.navigate("ManifestGroupScreen")},onManifest:function(){$(n.node)},onManifestGroup:function(){g(T.a.forms.manifestGroup.reset()),g(T.a.forms.manifestGroup.setOpen(!0)),g(T.a.forms.manifestGroup.setField(["load",n.node]))}}):o.createElement(Pe,{key:"load-"+n.node.id,load:n.node,onPress:function(){return S.navigate("LoadScreen",{load:n.node})}})}})):o.createElement(ye,{hasPlanes:k,hasTicketTypes:w,isPublic:j})),C&&z&&o.createElement(p.a,{style:on.fab,small:!0,icon:"plus",onPress:function(){return g(T.a.forms.load.setOpen(!0))},label:"New load"})),o.createElement(te,{open:b.manifest.open,onClose:function(){return g(T.a.forms.manifest.setOpen(!1))},onSuccess:function(){return g(T.a.forms.manifest.setOpen(!1))}}),o.createElement(be,{open:b.manifestGroup.open,onClose:function(){return g(T.a.forms.manifestGroup.setOpen(!1))},onSuccess:function(){return g(T.a.forms.manifestGroup.setOpen(!1))}}),o.createElement(rn,{onSuccess:function(){g(T.a.forms.load.setOpen(!1)),x()},open:b.load.open,onClose:function(){return g(T.a.forms.load.setOpen(!1))}}))}var on=u.a.create({container:{flex:1,alignItems:"center",justifyContent:"center"},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},fab:{position:"absolute",margin:16,right:0,bottom:0},header:{alignItems:"flex-end",justifyContent:"flex-end",padding:16}})}}]);
//# sourceMappingURL=7.1fcc70e3.chunk.js.map