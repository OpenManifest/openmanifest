(this.webpackJsonp=this.webpackJsonp||[]).push([[6],{617:function(e,n,t){"use strict";t.d(n,"a",(function(){return c}));var r=t(0),l=t(1),a=t(148),o=t(253),i=t(395),s=t(388),u=t(202),d=t(7);function c(e){var n=e.buttonLabel,t=e.buttonAction,l=e.title,c=e.loading,m=e.children,f=Object(d.c)((function(e){return e.global}));return r.createElement(o.a,null,r.createElement(i.a,{visible:!!e.open,dismissable:!1,style:{maxWidth:500,alignSelf:"center"}},r.createElement(s.a,{indeterminate:!0,visible:c,color:f.theme.colors.accent}),r.createElement(i.a.Title,null,l),r.createElement(i.a.Content,{pointerEvents:"box-none"},r.createElement(i.a.ScrollArea,null,r.createElement(a.b,null,m))),r.createElement(i.a.Actions,{style:{justifyContent:"flex-end"}},r.createElement(u.a,{onPress:function(){e.onClose()}},"Cancel"),r.createElement(u.a,{onPress:t},n))))}l.a.create({button:{width:"100%",borderRadius:16,padding:5},contentContainer:{paddingHorizontal:16,paddingBottom:32},sheet:{elevation:3,backgroundColor:"white",flexGrow:1,height:"100%",display:"flex",flexDirection:"column",justifyContent:"center"},sheetHeader:{elevation:2,borderTopLeftRadius:20,borderTopRightRadius:20,height:40,shadowColor:"#000",shadowOffset:{width:0,height:-4},backgroundColor:"white",shadowOpacity:.22,shadowRadius:2.22}})},618:function(e,n,t){"use strict";t.d(n,"a",(function(){return a}));var r=t(161),l=t(331),a=r.a.actions;l.a},619:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var r=t(47),l=t(0),a=t(7);function o(e,n){var t=n.getPayload;return function(n){var o=n.variables,i=n.onError,s=Object(a.b)(),u=Object(r.useQuery)(e,{variables:o}),d=u.data,c=u.loading,m=u.previousData,f=u.refetch,p=u.error,v=l.useMemo((function(){return t(d)}),[JSON.stringify(d)]);return l.useEffect((function(){JSON.stringify(m),JSON.stringify(d);null!=p&&p.message&&(!1!==n.showSnackbarErrors&&s(a.a.notifications.showSnackbar({message:p.message,variant:"error"})),i&&p.message)}),[n.onError,null==p?void 0:p.message]),{loading:c,data:v,refetch:f}}}},623:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(0),l=t(10),a=t(148),o=t(333);function i(e){var n=e.children,t=e.rightAction,i=e.disabled,s=r.useRef();return r.createElement(o.a,{ref:s,enabled:!i,renderRightActions:function(e,n){var o=n.interpolate({inputRange:[-100,0],outputRange:[1,0]}),i=n.interpolate({inputRange:[-150,0],outputRange:[0,10]});return r.createElement(a.d,{onPress:function(){var e;null==t||t.onPress(),null==s||null==(e=s.current)||e.close()}},r.createElement(l.a.View,{style:{flexGrow:1,backgroundColor:null==t?void 0:t.backgroundColor,justifyContent:"center",height:"100%",width:75,transform:[{translateX:i}]}},r.createElement(l.a.Text,{style:{color:"white",paddingHorizontal:10,fontWeight:"600",transform:[{scale:o}]}},null==t?void 0:t.label)))},useNativeAnimations:!0},n)}},630:function(e,n,t){"use strict";t.d(n,"a",(function(){return v}));var r,l=t(11),a=t.n(l),o=t(36),i=t.n(o),s=t(47),u=t(37),d=t(0),c=t(218),m=t(24),f=t(7),p=Object(u.a)(r||(r=i()(["\n  query QueryAvailableRigs(\n    $dropzoneId: Int!\n    $userId: Int!\n  ) {\n    dropzone(id: $dropzoneId) {\n      id\n      dropzoneUser(userId: $userId) {\n        id\n        availableRigs {\n          id\n          make\n          model\n          canopySize\n          serial\n\n          user {\n            id\n          }\n        }\n      }\n    }\n  }\n"])));function v(e){var n,t,r,l,o,i,u,v,b=d.useState(!1),g=a()(b,2),h=g[0],y=g[1],E=Object(f.c)((function(e){return e.global})).currentDropzoneId,I=Object(s.useLazyQuery)(p),x=a()(I,2),S=x[0],O=x[1].data;return d.useEffect((function(){e.userId&&e.dropzoneId&&S({variables:{dropzoneId:E,userId:Number(e.userId)}})}),[e.userId,e.dropzoneId]),d.useEffect((function(){var n,t,r;!e.value&&e.autoSelectFirst&&null!=O&&null!=(n=O.dropzone)&&null!=(t=n.dropzoneUser)&&null!=(r=t.availableRigs)&&r.length&&e.onSelect(O.dropzone.dropzoneUser.availableRigs[0])}),[e.autoSelectFirst,JSON.stringify(null==O||null==(n=O.dropzone)||null==(t=n.dropzoneUser)?void 0:t.availableRigs)]),d.createElement(c.a,{onDismiss:function(){return y(!1)},visible:h,anchor:d.createElement(m.b.Item,{onPress:function(){y(!0)},title:e.value?(null==(r=e.value)?void 0:r.make)+" "+(null==(l=e.value)?void 0:l.model)+" ("+((null==(o=e.value)?void 0:o.canopySize)||"?")+"sqft)":"Select rig",description:e.required?null:"Optional",left:function(){return d.createElement(m.b.Icon,{icon:"parachute"})}})},null==O||null==(i=O.dropzone)||null==(u=i.dropzoneUser)||null==(v=u.availableRigs)?void 0:v.map((function(n){return d.createElement(c.a.Item,{key:"rig-select-"+n.id,onPress:function(){y(!1),e.onSelect(n)},style:{width:"100%"},title:(null==n?void 0:n.make)+" "+(null==n?void 0:n.model)+" ("+(null==n?void 0:n.canopySize)+" sqft) "+(n.user?"":"[DROPZONE RIG]")})})))}},637:function(e,n,t){"use strict";t.d(n,"a",(function(){return b})),t.d(n,"b",(function(){return g}));var r,l=t(11),a=t.n(l),o=t(36),i=t.n(o),s=t(47),u=t(37),d=t(0),c=t(316),m=t(218),f=t(97),p=t(116),v=t(7),b=Object(u.a)(r||(r=i()(["\n  query QueryGCAUsers(\n    $dropzoneId: Int!\n    $permissions: [Permission!]\n  ) {\n    dropzone(id: $dropzoneId) {\n      id\n      name\n\n      dropzoneUsers(permissions: $permissions) {\n        edges {\n          node {\n            id\n            role {\n              id\n              name\n            }\n            user {\n              id\n              name\n            }\n          }\n        }\n      }\n    }\n  }\n"])));function g(e){var n,t,r,l,o,i,u,g,h=d.useState(!1),y=a()(h,2),E=y[0],I=y[1],x=Object(v.c)((function(e){return e.global})).currentDropzoneId,S=Object(s.useQuery)(b,{variables:{dropzoneId:Number(x),permissions:["actAsGCA"]}}).data;return Object(p.a)(f.a.UpdateLoad)?d.createElement(m.a,{onDismiss:function(){return I(!1)},visible:E,anchor:d.createElement(c.a,{mode:"outlined",icon:"radio-handheld",style:{marginHorizontal:4},onPress:function(){return I(!0)}},null!=(r=e.value)&&r.id?null==(l=e.value)||null==(o=l.user)?void 0:o.name:"No gca")},null==S||null==(i=S.dropzone)||null==(u=i.dropzoneUsers)||null==(g=u.edges)?void 0:g.map((function(n){var t,r,l;return d.createElement(m.a.Item,{key:"gca-chip-"+(null==n||null==(t=n.node)?void 0:t.id),onPress:function(){I(!1),e.onSelect(null==n?void 0:n.node)},title:null==n||null==(r=n.node)||null==(l=r.user)?void 0:l.name})}))):d.createElement(c.a,{mode:"outlined",icon:"radio-handheld"},(null==(n=e.value)||null==(t=n.user)?void 0:t.name)||"No gca")}},649:function(e,n,t){"use strict";t.d(n,"a",(function(){return C}));var r,l=t(0),a=t(1),o=t(2),i=t(284),s=t(282),u=t(375),d=t(285),c=t(7),m=t(11),f=t.n(m),p=t(24),v=t(36),b=t.n(v),g=t(37),h=t(619),y=Object(g.a)(r||(r=b()(["\nquery QueryDropzoneUsers(\n  $dropzoneId: Int!\n  $permissions: [Permission!]\n) {\n  dropzone(id: $dropzoneId) {\n    id\n    name\n\n    dropzoneUsers(permissions: $permissions) {\n      edges {\n        node {\n          id\n          role {\n            id\n            name\n          }\n          user {\n            id\n            name\n          }\n        }\n      }\n    }\n  }\n}\n"]))),E=Object(h.a)(y,{getPayload:function(e){var n;return null==e||null==(n=e.dropzone)?void 0:n.dropzoneUsers}}),I=t(328);function x(e){var n,t=e.label,r=e.requiredPermissions,a=e.icon,o=(e.required,e.value),i=Object(c.c)((function(e){return e.global})).currentDropzoneId,s=Object(c.b)(),u=E({variables:{dropzoneId:Number(i),permissions:r},onError:function(e){return s(c.a.notifications.showSnackbar({message:e,variant:"error"}))}}),d=u.data;u.loading,u.refetch;return l.createElement(l.Fragment,null,l.createElement(p.b.Subheader,null,t),l.createElement(I.a,{autoSelectFirst:!0,icon:a||"account",items:(null==d||null==(n=d.edges)?void 0:n.map((function(e){return e.node})))||[],selected:[e.value].filter(Boolean),isSelected:function(e){return e.id===(null==o?void 0:o.id)},renderItemLabel:function(e){return null==e?void 0:e.user.name},isDisabled:function(){return!1},onChangeSelected:function(n){var t=f()(n,1)[0];return t?e.onSelect(t):null}}))}var S,O=t(23),j=t.n(O),k=t(47),z=t(133),w=Object(g.a)(S||(S=b()(["\n  query QuerySelectPlanes(\n    $dropzoneId: Int!\n  ) {\n    planes(dropzoneId: $dropzoneId) {\n      id\n      name\n      registration\n      hours\n      minSlots\n      maxSlots\n      nextMaintenanceHours\n      createdAt\n    }\n  }\n"])));function T(e){var n=Object(c.c)((function(e){return e.global})).currentDropzoneId,t=Object(k.useQuery)(w,{variables:{dropzoneId:n}}),r=t.data;t.loading,t.refetch;return l.createElement(l.Fragment,null,l.createElement(p.b.Subheader,null,"Aircraft"),l.createElement(I.a,{autoSelectFirst:!0,items:Object(z.uniqBy)(j()((null==r?void 0:r.planes)||[]),(function(e){return e.id}))||[],selected:[e.value].filter(Boolean),renderItemLabel:function(e){return null==e?void 0:e.name},isDisabled:function(e){return!1},onChangeSelected:function(n){var t=f()(n,1)[0];return t?e.onSelect(t):null}}))}function C(){var e,n,t=Object(c.c)((function(e){return e.forms.load})),r=Object(c.b)();Object(c.c)((function(e){return e.global}));return l.createElement(l.Fragment,null,l.createElement(i.a,{style:P.field,mode:"outlined",label:"Name",error:!!t.fields.name.error,placeholder:"Optional",value:t.fields.name.value||"",onChangeText:function(e){return r(c.a.forms.load.setField(["name",e]))}}),l.createElement(s.a,{type:t.fields.name.error?"error":"info"},t.fields.name.error||"e.g Starcrest load, Tandem load"),l.createElement(i.a,{style:P.field,mode:"outlined",label:"Slots",error:!!t.fields.maxSlots.error,value:null==(e=t.fields.maxSlots)||null==(n=e.value)?void 0:n.toString(),onChangeText:function(e){return r(c.a.forms.load.setField(["maxSlots",Number(e)]))}}),l.createElement(s.a,{type:t.fields.maxSlots.error?"error":"info"},t.fields.maxSlots.error||""),l.createElement(o.a,{style:{width:"100%"}},l.createElement(T,{value:t.fields.plane.value,required:!0,onSelect:function(e){r(c.a.forms.load.setField(["plane",e])),r(c.a.forms.load.setField(["maxSlots",e.maxSlots]))}}),l.createElement(s.a,{type:t.fields.plane.error?"error":"info"},t.fields.plane.error||""),l.createElement(x,{label:"GCA",onSelect:function(e){return r(c.a.forms.load.setField(["gca",e]))},value:t.fields.gca.value||null,requiredPermissions:["actAsGCA"],required:!0}),l.createElement(s.a,{type:t.fields.gca.error?"error":"info"},t.fields.gca.error||""),l.createElement(x,{label:"Pilot",onSelect:function(e){return r(c.a.forms.load.setField(["pilot",e]))},value:t.fields.pilot.value||null,requiredPermissions:["actAsPilot"]}),l.createElement(s.a,{type:t.fields.pilot.error?"error":"info"},t.fields.pilot.error||""),l.createElement(u.a,{style:{marginVertical:8}}),l.createElement(d.a.Item,{label:"Allow public manifesting",status:t.fields.isOpen.value?"checked":"unchecked",onPress:function(){return r(c.a.forms.load.setField(["isOpen",!t.fields.isOpen.value]))}})))}var P=a.a.create({fields:{flex:1,width:"100%"},field:{marginBottom:8,width:"100%"}})},650:function(e,n,t){"use strict";t.d(n,"a",(function(){return D}));var r=t(4),l=t.n(r),a=t(11),o=t.n(a),i=t(23),s=t.n(i),u=t(36),d=t.n(u),c=t(0),m=t(77),f=t(1),p=t(24),v=t(104),b=t(282),g=t(316),h=t(375),y=t(37),E=t(133),I=t(7),x=t(328),S=t(619),O=t(388),j=t(284);var k,z,w=t(630),T=Object(y.a)(k||(k=d()(["\nquery QueryDropzoneUsersManifestDetails(\n  $dropzoneId: Int!\n  $dropzoneUserId: Int!\n) {\n  dropzone(id: $dropzoneId) {\n    id\n    name\n\n    dropzoneUser(id: $dropzoneUserId) {\n      id\n\n      user {\n        id\n        name\n        exitWeight\n        license {\n          id\n          name\n        }\n        rigs {\n          id\n          make\n          model\n          canopySize\n        }\n      }\n      role {\n        id\n        name\n      }\n      user {\n        id\n        name\n        image\n      }\n    }\n  }\n}\n"]))),C=Object(S.a)(T,{getPayload:function(e){var n;return null==e||null==(n=e.dropzone)?void 0:n.dropzoneUser}});function P(e){var n,t,r,l,a,o,i,s,u=e.dropzoneId,d=e.dropzoneUserId,f=e.onChangeRig,b=e.exitWeight,y=e.rigId,x=e.onChangeExitWeight,S=Object(I.c)((function(e){return e})).global,k=C({variables:{dropzoneUserId:d,dropzoneId:u},onError:console.error}),z=k.data,T=k.loading,P=null==z||null==(n=z.user)||null==(t=n.rigs)?void 0:t.find((function(e){var n=e.id;return Number(n)===y}));return c.useEffect((function(){var e;!b&&null!=z&&null!=(e=z.user)&&e.exitWeight&&x(Number(z.user.exitWeight))}),[null==z||null==(r=z.user)?void 0:r.exitWeight]),c.createElement(v.a,{style:{width:"100%"},elevation:3},c.createElement(O.a,{indeterminate:!0,color:S.theme.colors.accent,visible:T}),c.createElement(v.a.Title,{title:null==z?void 0:z.user.name,left:function(){var e;return null!=z&&null!=(e=z.user)&&e.image?c.createElement(p.a.Image,{source:{uri:z.user.image},size:24}):c.createElement(p.a.Icon,{icon:"account",size:24})}}),c.createElement(v.a.Content,null,c.createElement(h.a,{style:{marginBottom:8}}),c.createElement(m.a,{horizontal:!0},c.createElement(g.a,{style:{marginHorizontal:1},icon:"lock",mode:"outlined",disabled:!0},null==z||null==(l=z.role)?void 0:l.name),c.createElement(g.a,{style:{marginHorizontal:1},icon:"ticket-account",mode:"outlined",disabled:!0},null==z||null==(a=z.user)||null==(o=a.license)?void 0:o.name),P&&b&&P.canopySize?c.createElement(g.a,{style:{marginHorizontal:1},icon:"escalator-down",mode:"outlined",disabled:!0},(i=b,s=P.canopySize,Object(E.round)(2.20462*i/s,2).toFixed(2))):null),c.createElement(w.a,{userId:d,dropzoneId:u,onSelect:f,value:P,autoSelectFirst:!0}),c.createElement(j.a,{value:b?""+b:"",onChangeText:function(e){return x(Number(e))},keyboardType:"number-pad",label:"Exit weight",mode:"outlined"})))}function N(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function $(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?N(Object(t),!0).forEach((function(n){l()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):N(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var F=Object(y.a)(z||(z=d()(["\nquery DropzoneUsersAllowedJumpTypes(\n  $dropzoneId: Int!,\n  $userIds: [Int!]!\n) {\n  dropzone(id: $dropzoneId) {\n    id\n\n    allowedJumpTypes(userId: $userIds) {\n      id\n      name\n    }\n\n    ticketTypes(isPublic: true) {\n      id\n      name\n      cost\n\n      extras {\n        id\n        cost\n        name\n      }\n    }\n  }\n  jumpTypes {\n    id\n    name\n  }\n}\n\n"]))),U=Object(S.a)(F,{getPayload:function(e){var n,t;return{allowedJumpTypes:(null==e||null==(n=e.dropzone)?void 0:n.allowedJumpTypes)||[],ticketTypes:(null==e||null==(t=e.dropzone)?void 0:t.ticketTypes)||[],jumpTypes:(null==e?void 0:e.jumpTypes)||[]}}});function D(){var e,n,t,r,l,a,i,u,d,f,y,S,O,j=Object(I.c)((function(e){return e.forms.manifestGroup})),k=Object(I.c)((function(e){return e.global})),z=Object(I.b)(),w=U({variables:{userIds:null==(e=j.fields.users)||null==(n=e.value)?void 0:n.map((function(e){return e.id})),dropzoneId:k.currentDropzoneId},onError:console.error}),T=w.data;w.loading;return c.createElement(c.Fragment,null,c.createElement(p.b.Subheader,null,"Jump type"),c.createElement(v.a,{elevation:2,style:{marginBottom:16,flexShrink:1}},c.createElement(v.a.Content,null,c.createElement(x.a,{autoSelectFirst:!0,items:Object(E.uniqBy)([].concat(s()((null==T?void 0:T.allowedJumpTypes)||[]),s()((null==T?void 0:T.jumpTypes)||[])),(function(e){return e.id}))||[],selected:j.fields.jumpType.value?[j.fields.jumpType.value]:[],renderItemLabel:function(e){return e.name},isDisabled:function(e){var n;return!(null!=T&&null!=(n=T.allowedJumpTypes)&&n.map((function(e){return e.id})).includes(e.id))},onChangeSelected:function(e){var n=o()(e,1)[0];return z(I.a.forms.manifestGroup.setField(["jumpType",n]))}}),c.createElement(b.a,{type:j.fields.jumpType.error?"error":"info"},j.fields.jumpType.error||""))),c.createElement(p.b.Subheader,null,"Ticket"),c.createElement(v.a,{elevation:2,style:{width:"100%"}},c.createElement(v.a.Content,null,c.createElement(x.a,{autoSelectFirst:!0,items:(null==T?void 0:T.ticketTypes)||[],selected:j.fields.ticketType.value?[j.fields.ticketType.value]:[],renderItemLabel:function(e){return e.name},isDisabled:function(){return!1},onChangeSelected:function(e){var n=o()(e,1)[0];return z(I.a.forms.manifestGroup.setField(["ticketType",n]))}}),c.createElement(b.a,{type:j.fields.ticketType.error?"error":"info"},j.fields.ticketType.error||""),null!=j&&null!=(t=j.fields)&&null!=(r=t.ticketType)&&null!=(l=r.value)&&null!=(a=l.extras)&&a.length?c.createElement(p.b.Subheader,null,"Ticket addons"):null,c.createElement(m.a,{horizontal:!0,style:A.ticketAddons},null==j||null==(i=j.fields)||null==(u=i.ticketType)||null==(d=u.value)||null==(f=d.extras)?void 0:f.map((function(e){var n,t,r,l;return c.createElement(g.a,{selected:null==j||null==(n=j.fields)||null==(t=n.extras.value)?void 0:t.some((function(n){return n.id===e.id})),onPress:null!=j&&null!=(r=j.fields)&&null!=(l=r.extras.value)&&l.some((function(n){return n.id===e.id}))?function(){var n,t;return z(I.a.forms.manifestGroup.setField(["extras",null==j||null==(n=j.fields)||null==(t=n.extras.value)?void 0:t.filter((function(n){return n.id!==e.id}))]))}:function(){var n,t;return z(I.a.forms.manifestGroup.setField(["extras",[].concat(s()((null==j||null==(n=j.fields)||null==(t=n.extras)?void 0:t.value)||[]),[e])]))}},e.name+" ($"+e.cost+")")}))),c.createElement(b.a,{type:j.fields.extras.error?"error":"info"},j.fields.extras.error||""))),c.createElement(h.a,null),c.createElement(p.b.Subheader,null,"Group"),null==(y=j.fields)||null==(S=y.users)||null==(O=S.value)?void 0:O.map((function(e){return c.createElement(P,{dropzoneId:k.currentDropzoneId,dropzoneUserId:Number(e.id),rigId:Number(e.rigId)||void 0,exitWeight:e.exitWeight,onChangeExitWeight:function(n){var t;return z(I.a.forms.manifestGroup.setField(["users",null==(t=j.fields.users.value)?void 0:t.map((function(t){return t.id===e.id?$($({},e),{},{exitWeight:n}):t}))]))},onChangeRig:function(n){var t;return z(I.a.forms.manifestGroup.setField(["users",null==(t=j.fields.users.value)?void 0:t.map((function(t){return t.id===e.id?$($({},e),{},{rigId:Number(n.id)}):t}))]))}})})))}var A=f.a.create({fields:{flex:1},field:{marginBottom:8},ticketAddons:{marginBottom:8}})},782:function(e,n,t){"use strict";t.r(n),t.d(n,"default",(function(){return Xe}));var r,l,a=t(56),o=t(0),i=t(31),s=t(224),u=t(1),d=t(226),c=t(148),m=t(388),f=t(396),p=t(4),v=t.n(p),b=t(11),g=t.n(b),h=t(36),y=t.n(h),E=t(8),I=t.n(E),x=t(47),S=t(77),O=t(253),j=t(395),k=t(202),z=t(7),w=t(23),T=t.n(w),C=t(282),P=t(24),N=t(316),$=t(375),F=t(284),U=t(97),D=t(37),A=t(133),W=t(619),G=t(328),L=Object(D.a)(r||(r=y()(["\nquery DropzoneUsersAllowedJumpTypes(\n  $dropzoneId: Int!,\n  $userIds: [Int!]!\n) {\n  dropzone(id: $dropzoneId) {\n    id\n\n    allowedJumpTypes(userId: $userIds) {\n      id\n      name\n    }\n  }\n  jumpTypes {\n    id\n    name\n  }\n}\n\n"]))),J=Object(W.a)(L,{getPayload:function(e){var n,t;return{allowedJumpTypes:(null==e||null==(n=e.dropzone)?void 0:n.allowedJumpTypes)||[],ticketTypes:(null==e||null==(t=e.dropzone)?void 0:t.ticketTypes)||[],jumpTypes:(null==e?void 0:e.jumpTypes)||[]}}});function R(e){var n=Object(z.c)((function(e){return e.global})).currentDropzoneId,t=J({variables:{userIds:[Number(e.userId)||null].filter(Boolean),dropzoneId:Number(n)},onError:console.error}),r=t.data;t.loading;return o.createElement(o.Fragment,null,o.createElement(P.b.Subheader,null,"Jump type"),o.createElement(G.a,{autoSelectFirst:!0,items:Object(A.uniqBy)([].concat(T()((null==r?void 0:r.allowedJumpTypes)||[]),T()((null==r?void 0:r.jumpTypes)||[])),(function(e){return e.id}))||[],selected:[e.value].filter(Boolean),renderItemLabel:function(e){return null==e?void 0:e.name},isDisabled:function(e){var n;return!(null!=r&&null!=(n=r.allowedJumpTypes)&&n.map((function(e){return e.id})).includes(e.id))},onChangeSelected:function(n){var t=g()(n,1)[0];return t?e.onSelect(t):null}}))}var M=Object(D.a)(l||(l=y()(["\nquery DropzoneUsersAllowedTicketTypes(\n  $dropzoneId: Int!,\n  $onlyPublicTickets: Boolean\n) {\n  dropzone(id: $dropzoneId) {\n    id\n\n    ticketTypes(isPublic: $onlyPublicTickets) {\n      id\n      name\n      cost\n      isTandem\n\n      extras {\n        id\n        cost\n        name\n      }\n    }\n  }\n}\n\n"]))),q=Object(W.a)(M,{getPayload:function(e){var n;return{ticketTypes:(null==e||null==(n=e.dropzone)?void 0:n.ticketTypes)||[]}}});function B(e){var n=Object(z.c)((function(e){return e.global})).currentDropzoneId,t=q({variables:{dropzoneId:Number(n),onlyPublicTickets:e.onlyPublicTickets||null},onError:console.error}),r=t.data;t.loading;return o.createElement(o.Fragment,null,o.createElement(P.b.Subheader,null,"Ticket"),o.createElement(G.a,{autoSelectFirst:!0,items:(null==r?void 0:r.ticketTypes)||[],selected:[e.value].filter(Boolean),renderItemLabel:function(e){return null==e?void 0:e.name},isDisabled:function(){return!1},onChangeSelected:function(n){var t=g()(n,1)[0];return t?e.onSelect(t):null}}))}var H=t(116),Q=t(630),Y=t(327);function _(){var e,n,t,r,l,a,i,s,u,d,c,m,f,p,v,b,g,h,y,E,I,x,O,j,k,w,D=Object(z.b)(),A=Object(Y.a)(),W=Object(z.c)((function(e){return e.forms.manifest}));o.useEffect((function(){var e;if(null!=(e=W.fields.dropzoneUser)&&e.value){var n,t,r,l,a,o,i;if(!W.fields.exitWeight.value)D(z.a.forms.manifest.setField(["exitWeight",Number((null==(r=W.fields.dropzoneUser)||null==(l=r.value)||null==(a=l.user)?void 0:a.exitWeight)||60)]));if(!W.fields.rig.value&&null!=(n=W.fields.dropzoneUser.value.user)&&null!=(t=n.rigs)&&t.length)D(z.a.forms.manifest.setField(["rig",null==(o=W.fields.dropzoneUser)||null==(i=o.value)?void 0:i.user.rigs[0]]))}}),[null==(e=W.fields)||null==(n=e.dropzoneUser)||null==(t=n.value)?void 0:t.id]);var G=null==W||null==(r=W.original)?void 0:r.id,L=Object(H.a)(G?U.a.UpdateUserSlot:U.a.CreateUserSlot);return o.createElement(o.Fragment,null,o.createElement(R,{value:W.fields.jumpType.value,required:!0,userId:Number(null==W||null==(l=W.fields)||null==(a=l.dropzoneUser)||null==(i=a.value)||null==(s=i.user)?void 0:s.id)||null,onSelect:function(e){return D(z.a.forms.manifest.setField(["jumpType",e]))}}),o.createElement(C.a,{type:W.fields.jumpType.error?"error":"info"},W.fields.jumpType.error||""),o.createElement(B,{value:W.fields.ticketType.value,required:!0,onlyPublicTickets:!L,onSelect:function(e){return D(z.a.forms.manifest.setField(["ticketType",e]))}}),o.createElement(C.a,{type:W.fields.ticketType.error?"error":"info"},W.fields.ticketType.error||""),null!=W&&null!=(u=W.fields)&&null!=(d=u.ticketType)&&null!=(c=d.value)&&null!=(m=c.extras)&&m.length?o.createElement(P.b.Subheader,null,"Ticket addons"):null,o.createElement(S.a,{horizontal:!0,style:X.ticketAddons},null==W||null==(f=W.fields)||null==(p=f.ticketType)||null==(v=p.value)||null==(b=v.extras)?void 0:b.map((function(e){var n,t,r,l;return o.createElement(N.a,{selected:null==W||null==(n=W.fields)||null==(t=n.extras.value)?void 0:t.some((function(n){return n.id===e.id})),onPress:null!=W&&null!=(r=W.fields)&&null!=(l=r.extras.value)&&l.some((function(n){return n.id===e.id}))?function(){var n,t;return D(z.a.forms.manifest.setField(["extras",null==W||null==(n=W.fields)||null==(t=n.extras.value)?void 0:t.filter((function(n){return n.id!==e.id}))]))}:function(){var n,t;return D(z.a.forms.manifest.setField(["extras",[].concat(T()((null==W||null==(n=W.fields)||null==(t=n.extras)?void 0:t.value)||[]),[e])]))}},e.name+" ($"+e.cost+")")}))),o.createElement(C.a,{type:W.fields.extras.error?"error":"info"},W.fields.extras.error||""),o.createElement($.a,null),W.fields.dropzoneUser?o.createElement(Q.a,{value:W.fields.rig.value,userId:Number(null==(g=W.fields.dropzoneUser)||null==(h=g.value)||null==(y=h.user)?void 0:y.id),dropzoneId:Number(null==A||null==(E=A.dropzone)?void 0:E.id),onSelect:function(e){return D(z.a.forms.manifest.setField(["rig",e]))}}):null,o.createElement(C.a,{type:W.fields.rig.error?"error":"info"},W.fields.rig.error||""),o.createElement(F.a,{style:X.field,mode:"outlined",label:"Exit weight",error:!!W.fields.exitWeight.error,value:(null==(I=W.fields.exitWeight)||null==(x=I.value)?void 0:x.toString())||"",keyboardType:"numbers-and-punctuation",right:function(){return o.createElement(F.a.Affix,{text:"kg"})},onChangeText:function(e){return D(z.a.forms.manifest.setField(["exitWeight",Number(e)]))}}),o.createElement(C.a,{type:W.fields.exitWeight.error?"error":"info"},W.fields.exitWeight.error||""),null!=(O=W.fields.ticketType.value)&&O.isTandem?o.createElement(o.Fragment,null,o.createElement(P.b.Subheader,null,"Passenger"),o.createElement(F.a,{style:X.field,mode:"outlined",label:"Passenger name",error:!!W.fields.passengerName.error,value:(null==(j=W.fields.passengerName)||null==(k=j.value)?void 0:k.toString())||"",onChangeText:function(e){return D(z.a.forms.manifest.setField(["passengerName",e]))}}),o.createElement(F.a,{style:X.field,mode:"outlined",label:"Passenger exit weight",error:!!W.fields.passengerExitWeight.error,value:(null==(w=W.fields.passengerExitWeight.value)?void 0:w.toString())||"",onChangeText:function(e){return D(z.a.forms.manifest.setField(["passengerExitWeight",Number(e)]))}})):null)}var V,X=u.a.create({fields:{flex:1},field:{marginBottom:8},ticketAddons:{marginBottom:8}});function Z(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function K(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?Z(Object(t),!0).forEach((function(n){v()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Z(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var ee=Object(x.gql)(V||(V=y()(["\n  mutation CreateSlot(\n    $jumpTypeId: Int\n    $extraIds: [Int!]\n    $loadId: Int\n    $rigId: Int\n    $ticketTypeId: Int\n    $dropzoneUserId: Int\n    $exitWeight: Float\n    $passengerName: String\n    $passengerExitWeight: Float\n  ) {\n    createSlot(\n      input: {\n        attributes: {\n          jumpTypeId: $jumpTypeId\n          extraIds: $extraIds\n          loadId: $loadId\n          rigId: $rigId\n          ticketTypeId: $ticketTypeId\n          dropzoneUserId: $dropzoneUserId\n          exitWeight: $exitWeight\n          passengerExitWeight: $passengerExitWeight\n          passengerName: $passengerName\n        }\n      }\n    ) {\n      errors\n      fieldErrors {\n        field\n        message\n      }\n      slot {\n        id\n        jumpType {\n          id\n          name\n        }\n        extras {\n          id\n          name\n        }\n        exitWeight\n        load {\n          id\n          name\n          createdAt\n          dispatchAt\n          hasLanded\n          maxSlots\n          isFull\n          isOpen\n          plane {\n            id\n            name\n          }\n          gca {\n            id\n            user {\n              id\n              name\n            }\n          }\n          pilot {\n            id\n            user {\n              id\n              name\n            }\n          }\n          loadMaster {\n            id\n            user {\n              id\n              name\n            }\n          }\n          slots {\n            id\n            createdAt\n            user {\n              id\n              name\n            }\n            passengerName\n            passengerExitWeight\n            ticketType {\n              id\n              name\n              isTandem\n              altitude\n            }\n            jumpType {\n              id\n              name\n            }\n            extras {\n              id\n              name\n            }\n          }\n        }\n      }\n    }\n  }\n"])));function ne(e){var n,t,r,l,a,i,s=Object(z.b)(),u=Object(z.c)((function(e){return e.forms.manifest})),d=Object(z.c)((function(e){return e.global})),c=Object(x.useMutation)(ee),f=g()(c,2),p=f[0],v=f[1],b=o.useCallback((function(){var e,n,t=!1;return null!=(e=u.fields.jumpType.value)&&e.id||(t=!0,s(z.a.forms.manifest.setFieldError(["jumpType","You must specify the type of jump"]))),null!=(n=u.fields.ticketType.value)&&n.id||(t=!0,s(z.a.forms.manifest.setFieldError(["ticketType","You must select a ticket type to manifest"]))),!t}),[JSON.stringify(u.fields)]),h=o.useCallback((function(){var n,t,r,l,a,o,i,d,c,m,f,v,g,h,y,E,x,S,O,j,k,w,T,C,P;return I.a.async((function(N){for(;;)switch(N.prev=N.next){case 0:if(b()){N.next=2;break}return N.abrupt("return");case 2:return N.prev=2,N.next=5,I.a.awrap(p({variables:K({jumpTypeId:Number(null==(n=u.fields.jumpType.value)?void 0:n.id),extraIds:null==(t=u.fields.extras)||null==(r=t.value)?void 0:r.map((function(e){var n=e.id;return Number(n)})),loadId:Number(null==(l=u.fields.load.value)?void 0:l.id),rigId:null!=(a=u.fields.rig.value)&&a.id?Number(null==(o=u.fields.rig.value)?void 0:o.id):null,ticketTypeId:Number(null==(i=u.fields.ticketType)||null==(d=i.value)?void 0:d.id),dropzoneUserId:Number(null==(c=u.fields.dropzoneUser)||null==(m=c.value)?void 0:m.id),exitWeight:u.fields.exitWeight.value},null!=(f=u.fields.ticketType.value)&&f.isTandem?{passengerName:null==(v=u.fields.passengerName)?void 0:v.value,passengerExitWeight:null==(g=u.fields.passengerExitWeight)?void 0:g.value}:{})}));case 5:if(T=N.sent,null==(h=T.data)||null==(y=h.createSlot)||null==(E=y.fieldErrors)||E.map((function(e){var n=e.field,t=e.message;switch(n){case"jump_type":return s(z.a.forms.manifest.setFieldError(["jumpType",t]));case"load":return s(z.a.forms.manifest.setFieldError(["load",t]));case"credits":case"extras":case"extra_ids":return s(z.a.forms.manifest.setFieldError(["extras",t]));case"ticket_type":return s(z.a.forms.manifest.setFieldError(["ticketType",t]));case"rig":return s(z.a.forms.manifest.setFieldError(["rig",t]));case"dropzone_user":return s(z.a.forms.manifest.setFieldError(["dropzoneUser",t]));case"exit_weight":return s(z.a.forms.manifest.setFieldError(["exitWeight",t]))}})),null==T||null==(x=T.data)||null==(S=x.createSlot)||null==(O=S.errors)||!O.length){N.next=9;break}return N.abrupt("return",s(z.a.notifications.showSnackbar({message:null==T||null==(C=T.data)||null==(P=C.createSlot)?void 0:P.errors[0],variant:"error"})));case 9:null!=(j=T.data)&&null!=(k=j.createSlot)&&null!=(w=k.fieldErrors)&&w.length||e.onSuccess(),N.next=15;break;case 12:N.prev=12,N.t0=N.catch(2),s(z.a.notifications.showSnackbar({message:N.t0.message,variant:"error"}));case 15:case"end":return N.stop()}}),null,null,[[2,12]],Promise)}),[JSON.stringify(u.fields),p,e.onSuccess]);return o.createElement(O.a,null,o.createElement(j.a,{visible:!!e.open,style:{maxHeight:500}},o.createElement(m.a,{indeterminate:!0,visible:v.loading,color:d.theme.colors.accent}),o.createElement(j.a.Title,null,"Manifest "+(null==u||null==(n=u.fields)||null==(t=n.dropzoneUser)||null==(r=t.value)||null==(l=r.user)?void 0:l.name)+" on "+(null==(a=u.fields.load)||null==(i=a.value)?void 0:i.name)),o.createElement(j.a.ScrollArea,null,o.createElement(S.a,null,o.createElement(_,null))),o.createElement(j.a.Actions,{style:{justifyContent:"flex-end"}},o.createElement(k.a,{onPress:function(){s(z.a.forms.manifest.reset()),e.onClose()}},"Cancel"),o.createElement(k.a,{onPress:h},"Manifest"))))}var te,re=t(2),le=t(629),ae=t(650),oe=t(464),ie=t(285),se=t(330),ue=Object(D.a)(te||(te=y()(["\n  query QueryDropzoneUsersSearch(\n    $dropzoneId: Int!\n    $search: String\n  ) {\n    dropzone(id: $dropzoneId) {\n      id\n      name\n\n      dropzoneUsers(search: $search, licensed: true) {\n        edges {\n          node {\n            id\n            role {\n              id\n              name\n            }\n            user {\n              id\n              image\n              name\n              exitWeight\n            }\n\n            availableRigs {\n              id\n              make\n              model\n              canopySize\n              serial\n\n              user {\n                id\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n"])));function de(e){var n,t,r,l,a,i,s=Object(z.c)((function(e){return e})).screens,u=Object(z.b)(),d=o.useState(""),m=g()(d,2),f=m[0],p=m[1],v=Object(z.c)((function(e){return e.global})).currentDropzoneId,b=Object(x.useQuery)(ue,{variables:{dropzoneId:Number(v),search:f}}),h=b.data,y=(b.loading,Object(Y.a)().currentUser),E=Object(H.a)(U.a.CreateUserSlot),I=Object(H.a)(U.a.CreateUserSlotWithSelf);return o.createElement(o.Fragment,null,o.createElement(oe.a,{value:f,onChangeText:p,placeholder:"Search skydivers"}),o.createElement(re.a,{style:{height:380}},o.createElement(c.b,{contentContainerStyle:{paddingTop:16}},!(null!=h&&null!=(n=h.dropzone)&&null!=(t=n.dropzoneUsers)&&null!=(r=t.edges)&&r.length)&&o.createElement(se.a,{title:"No users",subtitle:""}),null==h||null==(l=h.dropzone)||null==(a=l.dropzoneUsers)||null==(i=a.edges)?void 0:i.map((function(e){var n,t,r,l,a;return o.createElement(o.Fragment,null,o.createElement(P.b.Item,{style:{width:"100%"},key:"user-"+(null==e||null==(n=e.node)?void 0:n.id),title:null==e||null==(t=e.node)?void 0:t.user.name,description:null==e||null==(r=e.node)||null==(l=r.role)?void 0:l.name,left:function(){var n,t,r;return null!=e&&null!=(n=e.node)&&null!=(t=n.user)&&t.image?o.createElement(P.a.Image,{source:{uri:null==e||null==(r=e.node)?void 0:r.user.image},style:{alignSelf:"center",marginHorizontal:12},size:32}):o.createElement(P.b.Icon,{icon:"account"})},right:function(){var n;return o.createElement(ie.a,{status:null!=(n=s.manifest.selectedUsers)&&n.map((function(e){return e.id})).includes(e.node.id)?"checked":"unchecked"})},disabled:(null==e||null==(a=e.node)?void 0:a.user.id)===(null==y?void 0:y.id)&&I&&!E,onPress:function(){var n,t;u(z.a.screens.manifest.setSelected(null!=(n=s.manifest.selectedUsers)&&n.find((function(n){var t;return n.id===""+(null==e||null==(t=e.node)?void 0:t.id)}))?null==(t=s.manifest.selectedUsers)?void 0:t.filter((function(n){var t;return n.id!==""+(null==e||null==(t=e.node)?void 0:t.id)})):[].concat(T()(s.manifest.selectedUsers),[e.node])))}}),o.createElement($.a,{style:{width:"100%"},key:"divider-"+(null==e?void 0:e.node.id)}))})))),o.createElement(k.a,{onPress:function(){u(z.a.forms.manifestGroup.setDropzoneUsers(s.manifest.selectedUsers)),e.onNext()},style:me.button,mode:"contained"},"Next"))}var ce,me=u.a.create({button:{width:"100%",borderRadius:16,padding:5},scrollView:{height:100}}),fe=Object(x.gql)(ce||(ce=y()(["\n  mutation CreateSlot(\n    $jumpTypeId: Int\n    $extraIds: [Int!]\n    $loadId: Int\n    $ticketTypeId: Int\n    $userGroup: [SlotUser!]!,\n  ) {\n    createSlots(\n      input: {\n        attributes: {\n          jumpTypeId: $jumpTypeId\n          extraIds: $extraIds\n          loadId: $loadId\n          ticketTypeId: $ticketTypeId\n          userGroup: $userGroup,\n        }\n      }\n    ) {\n      errors\n      fieldErrors {\n        field\n        message\n      }\n      \n      load {\n        id\n        name\n        loadNumber\n        createdAt\n        dispatchAt\n        hasLanded\n        maxSlots\n        isFull\n        isOpen\n        plane {\n          id\n          name\n        }\n        gca {\n          id\n          user {\n            id\n            name\n          }\n        }\n        pilot {\n          id\n          user {\n            id\n            name\n          }\n        }\n        loadMaster {\n          id\n          user {\n            id\n            name\n          }\n        }\n        slots {\n          id\n          createdAt\n          user {\n            id\n            name\n          }\n          passengerName\n          passengerExitWeight\n          ticketType {\n            id\n            name\n            isTandem\n            altitude\n          }\n          jumpType {\n            id\n            name\n          }\n          extras {\n            id\n            name\n          }\n        }\n      }\n    }\n  }\n"])));function pe(e){var n,t,r,l,a=e.open,i=Object(z.b)(),s=Object(z.c)((function(e){return e.forms.manifestGroup})),u=(Object(z.c)((function(e){return e.global})),Object(x.useMutation)(fe)),d=g()(u,2),m=d[0],f=d[1],p=o.useState(0),v=g()(p,2),b=v[0],h=v[1],y=o.useCallback((function(){var e,n,t=!1;return null!=(e=s.fields.jumpType.value)&&e.id||(t=!0,i(z.a.forms.manifestGroup.setFieldError(["jumpType","You must specify the type of jump"]))),null!=(n=s.fields.ticketType.value)&&n.id||(t=!0,i(z.a.forms.manifestGroup.setFieldError(["ticketType","You must select a ticket type to manifest"]))),!t}),[JSON.stringify(s.fields)]),E=o.useCallback((function(){var n,t,r,l,a,o,u,d,c,f,p,v,b,g,h,E,x;return I.a.async((function(S){for(;;)switch(S.prev=S.next){case 0:if(y()){S.next=2;break}return S.abrupt("return");case 2:return S.prev=2,S.next=5,I.a.awrap(m({variables:{jumpTypeId:Number(null==(n=s.fields.jumpType.value)?void 0:n.id),ticketTypeId:Number(null==(t=s.fields.ticketType.value)?void 0:t.id),extraIds:null==(r=s.fields.extras)||null==(l=r.value)?void 0:l.map((function(e){var n=e.id;return Number(n)})),loadId:Number(null==(a=s.fields.load.value)?void 0:a.id),userGroup:s.fields.users.value}}));case 5:if(h=S.sent,null==(o=h.data)||null==(u=o.createSlots)||null==(d=u.fieldErrors)||d.map((function(e){var n=e.field,t=e.message;switch(n){case"jump_type":return i(z.a.forms.manifestGroup.setFieldError(["jumpType",t]));case"load":return i(z.a.forms.manifestGroup.setFieldError(["load",t]));case"credits":case"extras":case"extra_ids":return i(z.a.forms.manifestGroup.setFieldError(["extras",t]));case"ticket_type":return i(z.a.forms.manifestGroup.setFieldError(["ticketType",t]))}})),null==h||null==(c=h.data)||null==(f=c.createSlots)||null==(p=f.errors)||!p.length){S.next=9;break}return S.abrupt("return",i(z.a.notifications.showSnackbar({message:null==h||null==(E=h.data)||null==(x=E.createSlots)?void 0:x.errors[0],variant:"error"})));case 9:null!=(v=h.data)&&null!=(b=v.createSlots)&&null!=(g=b.fieldErrors)&&g.length||e.onClose(),S.next=15;break;case 12:S.prev=12,S.t0=S.catch(2),i(z.a.notifications.showSnackbar({message:S.t0.message,variant:"error"}));case 15:case"end":return S.stop()}}),null,null,[[2,12]],Promise)}),[JSON.stringify(s.fields),m,e.onSuccess]),S=o.useRef(null);o.useEffect((function(){var e,n,t;null!=(e=s.fields.ticketType)&&null!=(n=e.value)&&n.isTandem&&(null==S||null==(t=S.current)||t.snapTo(0))}),[null==(n=s.fields.ticketType)||null==(t=n.value)?void 0:t.isTandem]),o.useEffect((function(){var n,t;a?null==S||null==(n=S.current)||n.snapTo(1):(null==S||null==(t=S.current)||t.close(),e.onClose())}),[a]);o.useMemo((function(){return[0,550]}),[]);return o.createElement(O.a,null,o.createElement(j.a,{visible:!!e.open,onDismiss:e.onClose},o.createElement(re.a,{style:{backgroundColor:"white"},testID:"manifest-group-sheet"},o.createElement(re.a,{pointerEvents:((null==(r=s.fields.users)||null==(l=r.value)?void 0:l.length)||0)>0?void 0:"none"},o.createElement(le.b,{defaultIndex:b,mode:"fixed",onChangeIndex:h},o.createElement(le.a,{label:"Create group"},o.createElement(re.a,null)),o.createElement(le.a,{label:"Configure jump"},o.createElement(re.a,null)))),0===b?o.createElement(re.a,{style:ve.userListContainer},o.createElement(de,{onNext:function(){return h(1)}})):o.createElement(c.b,{contentContainerStyle:{paddingBottom:200,flexGrow:1}},o.createElement(ae.a,null),o.createElement(re.a,{style:ve.buttonContainer},o.createElement(k.a,{onPress:E,loading:f.loading,mode:"contained",style:ve.button},"Save"))))))}var ve=u.a.create({button:{width:"100%",borderRadius:16,padding:5},buttonContainer:{paddingHorizontal:16,backgroundColor:"white"},contentContainer:{paddingHorizontal:16,paddingBottom:32},userListContainer:{height:"100%",backgroundColor:"white",width:"100%",padding:16},sheet:{elevation:3,backgroundColor:"white",flexGrow:1,height:"100%",display:"flex",flexDirection:"column",justifyContent:"center",paddingBottom:32},sheetHeader:{elevation:2,borderTopLeftRadius:15,borderTopRightRadius:15,height:30,shadowColor:"#000",shadowOffset:{width:0,height:-4},backgroundColor:"white",shadowOpacity:.22,shadowRadius:2.22}}),be=t(159),ge=t(360);function he(e){var n=e.hasPlanes,t=e.hasTicketTypes,r=(e.isPublic,Object(ge.a)());return o.createElement(be.b,{style:{width:"70%"}},o.createElement(be.a,{style:Ee.title},"Set up dropzone"),o.createElement(be.b,{style:Ee.separator,lightColor:"#eee",darkColor:"rgba(255,255,255,0.1)"}),o.createElement(P.b.Item,{title:"Create dropzone",left:function(){return o.createElement(P.b.Icon,{color:r.success,icon:"check"})}}),o.createElement(P.b.Item,{title:"Add a plane",left:function(){return n?o.createElement(P.b.Icon,{color:r.success,icon:"check"}):o.createElement(P.b.Icon,{color:r.error,icon:"close"})}}),o.createElement(P.b.Item,{title:"Configure jump tickets",left:function(){return t?o.createElement(P.b.Icon,{color:r.success,icon:"check"}):o.createElement(P.b.Icon,{color:r.error,icon:"close"})}}))}var ye,Ee=u.a.create({container:{flex:1,alignItems:"center",justifyContent:"center"},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"}}),Ie=t(104),xe=t(44),Se=t(160),Oe=t(462),je=t(315),ke=t(218),ze=t(668),we=t(669),Te=t(637);function Ce(e){var n,t,r,l,a,i,s=o.useState(!1),u=g()(s,2),d=u[0],c=u[1],m=Object(H.a)(U.a.UpdateLoad);return m?o.createElement(ke.a,{onDismiss:function(){return c(!1)},visible:d,anchor:o.createElement(N.a,{mode:"outlined",icon:"shield-account",style:{marginHorizontal:4},onPress:function(){return m&&c(!0)}},null!=(r=e.value)&&r.id?null==(l=e.value)||null==(a=l.user)?void 0:a.name:"No loadmaster")},null==(i=e.slots)?void 0:i.map((function(n){var t,r;return o.createElement(ke.a.Item,{key:"lm-chip-"+n.id,onPress:function(){c(!1),e.onSelect(n.dropzoneUser)},title:null==n||null==(t=n.dropzoneUser)||null==(r=t.user)?void 0:r.name})}))):o.createElement(N.a,{mode:"outlined",icon:"shield-account"},(null==(n=e.value)||null==(t=n.user)?void 0:t.name)||"No loadmaster")}var Pe,Ne=Object(D.a)(ye||(ye=y()(["\n  query QueryPilotUsers(\n    $dropzoneId: Int!\n    $permissions: [Permission!]\n  ) {\n    dropzone(id: $dropzoneId) {\n      id\n      name\n\n      dropzoneUsers(permissions: $permissions) {\n        edges {\n          node {\n            id\n            role {\n              id\n              name\n            }\n            user {\n              id\n              name\n            }\n          }\n        }\n      }\n    }\n  }\n"])));function $e(e){var n,t,r,l,a,i,s,u,d=o.useState(!1),c=g()(d,2),m=c[0],f=c[1],p=Object(z.c)((function(e){return e.global})).currentDropzoneId,v=Object(x.useQuery)(Ne,{variables:{dropzoneId:p,permissions:["actAsPilot"]}}).data;return Object(H.a)(U.a.UpdateLoad)?o.createElement(ke.a,{onDismiss:function(){return f(!1)},visible:m,anchor:o.createElement(N.a,{mode:"outlined",icon:"shield-airplane",style:{marginHorizontal:4},onPress:function(){return f(!0)}},null!=(r=e.value)&&r.id?null==(l=e.value)||null==(a=l.user)?void 0:a.name:"No pilot")},null==v||null==(i=v.dropzone)||null==(s=i.dropzoneUsers)||null==(u=s.edges)?void 0:u.map((function(n){var t,r;return o.createElement(ke.a.Item,{key:"pilot-select-"+n.node.id,onPress:function(){f(!1),e.onSelect(null==n?void 0:n.node)},title:null==n||null==(t=n.node)||null==(r=t.user)?void 0:r.name})}))):o.createElement(N.a,{mode:"outlined",icon:"radio-handheld"},(null==(n=e.value)||null==(t=n.user)?void 0:t.name)||"No pilot")}var Fe=Object(D.a)(Pe||(Pe=y()(["\n  query QueryChipPlanes(\n    $dropzoneId: Int!\n  ) {\n    planes(dropzoneId: $dropzoneId) {\n      id\n      name\n      registration\n      hours\n      minSlots\n      maxSlots\n      nextMaintenanceHours\n      createdAt\n    }\n  }\n"])));function Ue(e){var n,t,r,l=o.useState(!1),a=g()(l,2),i=a[0],s=a[1],u=Object(z.c)((function(e){return e.global})).currentDropzoneId,d=Object(x.useQuery)(Fe,{variables:{dropzoneId:Number(u)}}).data,c=Object(H.a)(U.a.UpdateLoad);return c?o.createElement(ke.a,{onDismiss:function(){return s(!1)},visible:i,anchor:o.createElement(N.a,{mode:"outlined",icon:"airplane",style:{marginHorizontal:4},onPress:function(){return c&&s(!0)}},(null==(t=e.value)?void 0:t.name)||"No plane")},null==d||null==(r=d.planes)?void 0:r.map((function(n){return o.createElement(ke.a.Item,{key:"lm-plane-chip-"+n.id,onPress:function(){s(!1),e.onSelect(n)},title:n.name})}))):o.createElement(N.a,{mode:"outlined",icon:"airplane-takeoff"},(null==(n=e.value)?void 0:n.name)||"No plane")}var De,Ae,We,Ge=t(623),Le=Object(x.gql)(De||(De=y()(["\n  query QueryLoad($id: Int!) {\n    load(id: $id) {\n      id\n      name\n      createdAt\n      dispatchAt\n      hasLanded\n      maxSlots\n      loadNumber\n      isFull\n      isOpen\n      plane {\n        id\n        name\n      }\n      gca {\n        id\n        user {\n          id\n          name\n        }\n      }\n      pilot {\n        id\n        user {\n          id\n          name\n        }\n      }\n      loadMaster {\n        id\n        user {\n          id\n          name\n        }\n      }\n      slots {\n        id\n        createdAt\n        exitWeight\n        passengerName\n        passengerExitWeight\n        \n        dropzoneUser {\n          id\n          user {\n            id\n            name\n            exitWeight\n          }\n        }\n        ticketType {\n          id\n          name\n          altitude\n          isTandem\n\n          extras {\n            id\n            name\n            cost\n          }\n        }\n        jumpType {\n          id\n          name\n        }\n        extras {\n          id\n          name\n        }\n      }\n    }\n  }\n"]))),Je=Object(x.gql)(Ae||(Ae=y()(["\n  mutation UpdateLoad(\n    $id: Int!,\n    $pilotId: Int,\n    $gcaId: Int,\n    $planeId: Int,\n    $isOpen: Boolean,\n    $loadMasterId: Int,\n    $dispatchAt: Int,\n    $hasLanded: Boolean,\n  ){\n    updateLoad(input: {\n      id: $id\n      attributes: {\n        pilotId: $pilotId,\n        gcaId: $gcaId,\n        planeId: $planeId,\n        isOpen: $isOpen,\n        loadMasterId: $loadMasterId\n        dispatchAt: $dispatchAt\n        hasLanded: $hasLanded\n      }\n    }) {\n      load {\n        id\n        name\n        createdAt\n        loadNumber\n        dispatchAt\n        hasLanded\n        maxSlots\n        isFull\n        isOpen\n        plane {\n          id\n          name\n        }\n        gca {\n          id\n          user {\n            id\n            name\n          }\n        }\n        pilot {\n          id\n          user {\n            id\n            name\n          }\n        }\n        loadMaster {\n          id\n          user {\n            id\n            name\n          }\n        }\n        slots {\n          id\n          createdAt\n          exitWeight\n\n          passengerName\n          passengerExitWeight\n\n          user {\n            id\n            name\n          }\n          ticketType {\n            id\n            name\n            altitude\n            isTandem\n          }\n          jumpType {\n            id\n            name\n          }\n          extras {\n            id\n            name\n          }\n        }\n      }\n    }\n  }\n"]))),Re=Object(x.gql)(We||(We=y()(["\nmutation DeleteSlot($id: Int!) {\n  deleteSlot(input: { id: $id }) {\n    slot {\n      id\n      load {\n        id\n        slots {\n          id\n          createdAt\n          exitWeight\n\n          passengerName\n          passengerExitWeight\n\n          user {\n            id\n            name\n          }\n          ticketType {\n            id\n            name\n            altitude\n            isTandem\n          }\n          jumpType {\n            id\n            name\n          }\n          extras {\n            id\n            name\n          }\n        }  \n      }\n    }\n  }\n}\n"])));function Me(e){var n,t,r,l,a,i,s,u,d,c,f,p,v,b,h,y,E,O,j,w,T,C,P,N,$,F,D,A,W=Object(z.c)((function(e){return e.global})),G=Object(z.b)(),L=o.useState(!1),J=g()(L,2),R=J[0],M=J[1],q=o.useState(!1),B=g()(q,2),Q=B[0],_=B[1],V=e.load,X=e.onManifest,Z=e.onManifestGroup,K=Object(x.useQuery)(Le,{variables:{id:Number(V.id)}}),ee=K.data,ne=K.loading,te=K.refetch,re=Object(Y.a)(),le=re.currentUser,ae=Object(x.useMutation)(Je),oe=g()(ae,2),ie=oe[0],se=oe[1],ue=Object(x.useMutation)(Re),de=g()(ue,2),ce=de[0],me=(de[1],o.useCallback((function(e){var n,t,r;return I.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:return l.prev=0,l.next=3,I.a.awrap(ce({variables:{id:Number(e.id)}}));case 3:null!=(r=l.sent)&&null!=(n=r.data)&&null!=(t=n.deleteSlot)&&t.errors&&G(z.a.notifications.showSnackbar({message:r.data.deleteSlot.errors[0],variant:"error"})),l.next=9;break;case 7:l.prev=7,l.t0=l.catch(0);case 9:case"end":return l.stop()}}),null,null,[[0,7]],Promise)}),[ie,JSON.stringify(V)])),fe=o.useCallback((function(e){return I.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,I.a.awrap(ie({variables:{id:Number(V.id),pilotId:Number(e.id)}}));case 3:n.next=7;break;case 5:n.prev=5,n.t0=n.catch(0);case 7:case"end":return n.stop()}}),null,null,[[0,5]],Promise)}),[ie,JSON.stringify(V)]),pe=o.useCallback((function(e){return I.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,I.a.awrap(ie({variables:{id:Number(V.id),gcaId:Number(e.id)}}));case 3:n.next=7;break;case 5:n.prev=5,n.t0=n.catch(0);case 7:case"end":return n.stop()}}),null,null,[[0,5]],Promise)}),[ie,JSON.stringify(V)]),ve=o.useCallback((function(e){return I.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,I.a.awrap(ie({variables:{id:Number(V.id),planeId:Number(e.id)}}));case 3:n.next=7;break;case 5:n.prev=5,n.t0=n.catch(0);case 7:case"end":return n.stop()}}),null,null,[[0,5]],Promise)}),[ie,JSON.stringify(V)]),ge=o.useCallback((function(e){return I.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,I.a.awrap(ie({variables:{id:Number(V.id),loadMasterId:Number(e.id)}}));case 3:n.next=7;break;case 5:n.prev=5,n.t0=n.catch(0);case 7:case"end":return n.stop()}}),null,null,[[0,5]],Promise)}),[ie,JSON.stringify(V)]),he=o.useCallback((function(e){var n;return I.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e?Object(ze.a)(new Date,e).getTime()/1e3:null,t.prev=1,t.next=4,I.a.awrap(ie({variables:{id:Number(V.id),dispatchAt:n?Math.ceil(n):null}}));case 4:t.next=8;break;case 6:t.prev=6,t.t0=t.catch(1);case 8:case"end":return t.stop()}}),null,null,[[1,6]],Promise)}),[ie,JSON.stringify(V)]),ye=o.useCallback((function(){return I.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,I.a.awrap(ie({variables:{id:Number(V.id),hasLanded:!0}}));case 3:e.next=7;break;case 5:e.prev=5,e.t0=e.catch(0);case 7:case"end":return e.stop()}}),null,null,[[0,5]],Promise)}),[ie,JSON.stringify(V)]),Ee=Object(H.a)(U.a.UpdateLoad),Pe=Object(H.a)(U.a.UpdateSlot),Ne=Object(H.a)(U.a.UpdateUserSlot),Fe=Object(H.a)(U.a.DeleteSlot),De=Object(H.a)(U.a.DeleteUserSlot),Ae=Object(H.a)(U.a.CreateSlot),We=Object(H.a)(U.a.CreateUserSlot),Me=Object(H.a)(U.a.CreateUserSlotWithSelf),qe=Ae&&(null==ee||null==(n=ee.load)?void 0:n.isOpen)&&!(null!=ee&&null!=(t=ee.load)&&t.isFull);o.useEffect((function(){var e,n;null!=ee&&null!=(e=ee.load)&&e.maxSlots&&(null==ee||null==(n=ee.load)?void 0:n.maxSlots)<5&&!R&&M(!0)}),[null==ee||null==(r=ee.load)?void 0:r.maxSlots]);var He=(We||Me)&&!(null!=ee&&null!=(l=ee.load)&&l.hasLanded)&&(!(null!=ee&&null!=(a=ee.load)&&a.dispatchAt)||(null==ee?void 0:ee.load.dispatchAt)>(new Date).getTime()/1e3);return o.createElement(Ie.a,{testID:"load-card",style:{margin:16,opacity:null!=ee&&null!=(i=ee.load)&&i.hasLanded?.5:1},elevation:3},o.createElement(Ie.a.Title,{style:{justifyContent:"space-between"},title:o.createElement(be.b,{style:{width:"100%",flex:1,flexDirection:"row",alignItems:"center",justifyContent:"space-between"}},o.createElement(xe.a,null,"Load "+((null==ee||null==(s=ee.load)?void 0:s.loadNumber)||0)),o.createElement(be.b,{style:{flexGrow:1}}),He&&o.createElement(Se.a,{icon:"account-group",testID:"manifest-group-button",onPress:function(){G(z.a.forms.manifestGroup.reset()),G(z.a.forms.manifestGroup.setField(["load",V])),Me&&!We&&(G(z.a.screens.manifest.setSelected([le])),G(z.a.forms.manifestGroup.setDropzoneUsers([le]))),Z&&Z()}})),subtitle:V.name}),o.createElement(m.a,{visible:ne||se.loading,color:W.theme.colors.accent}),o.createElement(Ie.a.Content,{style:{marginVertical:8,height:R?void 0:300,overflow:"hidden"}},o.createElement(be.b,{style:{flexDirection:"row"}},o.createElement(S.a,{horizontal:!0,showsHorizontalScrollIndicator:!1},o.createElement(Ue,{value:null==ee||null==(u=ee.load)?void 0:u.plane,onSelect:function(e){var n,t,r,l,a;return I.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:if(!(((null==ee||null==(n=ee.load)||null==(t=n.slots)?void 0:t.length)||0)>(e.maxSlots||0))){o.next=5;break}a=((null==ee||null==(r=ee.load)||null==(l=r.slots)?void 0:l.length)||0)-(e.maxSlots||0),G(z.a.notifications.showSnackbar({message:"You need to take "+a+" people off the load to fit on this plane",variant:"warning"})),o.next=8;break;case 5:return o.next=7,I.a.awrap(ve(e));case 7:te();case 8:case"end":return o.stop()}}),null,null,null,Promise)}}),o.createElement(Te.b,{dropzoneId:Number(null==re||null==(d=re.dropzone)?void 0:d.id),value:null==ee||null==(c=ee.load)?void 0:c.gca,onSelect:pe}),o.createElement($e,{dropzoneId:Number(null==re||null==(f=re.dropzone)?void 0:f.id),value:null==ee||null==(p=ee.load)?void 0:p.pilot,onSelect:fe}),o.createElement(Ce,{value:null==ee||null==(v=ee.load)?void 0:v.loadMaster,slots:(null==ee?void 0:ee.load.slots)||[],onSelect:ge}))),o.createElement(Oe.a,null,o.createElement(Oe.a.Header,{style:{width:"100%"}},o.createElement(Oe.a.Title,null,"Name"),o.createElement(Oe.a.Title,{numeric:!0},"Jump type"),o.createElement(Oe.a.Title,{numeric:!0},"Altitude")),null==ee||null==(b=ee.load)||null==(h=b.slots)?void 0:h.map((function(n){var t,r,l,a,i,s,u,d,c=null==ee||null==(t=ee.load)||null==(r=t.slots)?void 0:r.filter((function(e){var t=e.groupNumber;return t&&t===n.groupNumber})),m=(null==n||null==(l=n.user)?void 0:l.id)===(null==le?void 0:le.id);return o.createElement(Ge.a,{disabled:m&&!Fe||!m&&!De,key:"slot-"+n.id,rightAction:{label:"Delete",backgroundColor:"red",onPress:function(){return me(n)}}},o.createElement(Oe.a.Row,{testID:"slot-row",disabled:!(null==ee||null==(a=ee.load)||!a.hasLanded),onPress:function(){var t;(null==(t=n.user)?void 0:t.id)===(null==le?void 0:le.id)?Pe&&(null!=c&&c.length?e.onSlotGroupPress(c):e.onSlotPress(n)):Ne&&(null!=c&&c.length?e.onSlotGroupPress(c):e.onSlotPress(n))},pointerEvents:"none"},o.createElement(Oe.a.Cell,null,o.createElement(je.a,{style:Be.slotText},null==n||null==(i=n.dropzoneUser)||null==(s=i.user)?void 0:s.name)),o.createElement(Oe.a.Cell,{numeric:!0},o.createElement(je.a,{style:Be.slotText},null==n||null==(u=n.jumpType)?void 0:u.name)),o.createElement(Oe.a.Cell,{numeric:!0},o.createElement(je.a,{style:Be.slotText},((null==n||null==(d=n.ticketType)?void 0:d.altitude)||14e3)/1e3,"k"))))})),Array.from({length:((null==ee||null==(y=ee.load)?void 0:y.maxSlots)||0)-((null==ee||null==(E=ee.load)||null==(O=E.slots)?void 0:O.length)||0)},(function(e,n){return n})).map((function(e){return o.createElement(Oe.a.Row,{key:V.id+"-empty-slot-"+e,testID:"slot-row"},o.createElement(Oe.a.Cell,null,o.createElement(je.a,{style:Be.slotText},"- Available -")),o.createElement(Oe.a.Cell,{numeric:!0},"-"),o.createElement(Oe.a.Cell,{numeric:!0},"-"))})))),!(null==ee||null==(j=ee.load)||!j.dispatchAt)&&(null==ee||null==(w=ee.load)?void 0:w.dispatchAt)>(new Date).getTime()/1e3&&o.createElement(be.b,{style:{flex:1,backgroundColor:"black",padding:8}},o.createElement(je.a,{style:{color:"#FFFFFF"}},"Take-off in "+Object(we.a)(new Date,1e3*(null==ee||null==(T=ee.load)?void 0:T.dispatchAt))+" min")),o.createElement(Ie.a.Actions,null,null!=ee&&null!=(C=ee.load)&&C.maxSlots&&(null==ee||null==(P=ee.load)?void 0:P.maxSlots)<5?null:o.createElement(k.a,{onPress:function(){return M(!R)},testID:R?"show-less":"show-more"},R?"Show less":"Show more"),o.createElement(be.b,{style:{flexGrow:1}}),!Ee||null!=ee&&null!=(N=ee.load)&&N.hasLanded?null:null!=ee&&null!=($=ee.load)&&$.dispatchAt?o.createElement(k.a,{mode:"outlined",onPress:function(){return he(null)},testID:"dispatch-cancel"},"Cancel"):o.createElement(ke.a,{onDismiss:function(){return _(!1)},visible:Q,anchor:o.createElement(k.a,{mode:"outlined",onPress:function(){return _(!0)},testID:"dispatch-button"},"Dispatch")},o.createElement(ke.a.Item,{testID:"dispatch-call",onPress:function(){_(!1),he(20)},title:"20 minute call"}),o.createElement(ke.a.Item,{testID:"dispatch-call",onPress:function(){_(!1),he(15)},title:"15 minute call"}),o.createElement(ke.a.Item,{testID:"dispatch-call",onPress:function(){_(!1),he(10)},title:"10 minute call"}),o.createElement(ke.a.Item,{onPress:function(){_(!1),he(5)},title:"5 minute call"})),null!=ee&&null!=(F=ee.load)&&F.hasLanded?null:null!=ee&&null!=(D=ee.load)&&D.dispatchAt&&(null==ee?void 0:ee.load.dispatchAt)<(new Date).getTime()/1e3&&Ee?o.createElement(k.a,{style:{marginLeft:8},mode:"contained",onPress:function(){var e,n,t,r;return null!=ee&&null!=(e=ee.load)&&null!=(n=e.loadMaster)&&n.id?null!=ee&&null!=(t=ee.load)&&null!=(r=t.pilot)&&r.id?void ye():G(z.a.notifications.showSnackbar({message:"You must select a pilot before this load can be finalized",variant:"warning"})):G(z.a.notifications.showSnackbar({message:"You must select a load master before this load can be finalized",variant:"warning"}))}},"Mark as landed"):o.createElement(k.a,{style:{marginLeft:8},mode:"contained",testID:"manifest-button",onPress:function(){return X()},disabled:!qe||Boolean((null==ee||null==(A=ee.load)?void 0:A.dispatchAt)&&ee.load.dispatchAt<(new Date).getTime()/1e3)},"Manifest")))}var qe,Be=u.a.create({container:{flex:1,alignItems:"center",justifyContent:"center",marginVertical:8},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},slotText:{fontSize:12},fab:{position:"absolute",margin:16,right:0,bottom:0}}),He=t(618),Qe=t(649),Ye=t(617),_e=Object(x.gql)(qe||(qe=y()(["\n  mutation CreateLoad(\n    $name: String,\n    $pilotId: Int,\n    $gcaId: Int,\n    $maxSlots: Int!,\n    $planeId: Int,\n    $isOpen: Boolean,\n  ){\n    createLoad(input: {\n      attributes: {\n        name: $name,\n        pilotId: $pilotId,\n        gcaId: $gcaId,\n        maxSlots: $maxSlots,\n        planeId: $planeId,\n        isOpen: $isOpen,\n      }\n    }) {\n      load {\n        id\n        name\n        pilot {\n          id\n          user {\n            id \n            name\n          }\n        }\n        gca {\n          id\n          user {\n            id \n            name\n          }\n        }\n        maxSlots\n        isOpen\n      }\n      fieldErrors {\n        field,\n        message\n      }\n      errors\n    }\n  }\n"])));function Ve(e){var n=e.open,t=e.onClose,r=e.onSuccess,l=Object(z.c)((function(e){return e.forms.load})),a=Object(z.c)((function(e){return e.global})).currentDropzoneId,i=Object(z.b)(),s=Object(x.useMutation)(_e),u=g()(s,2),d=u[0],c=u[1],m=o.useCallback((function(){var e=!1;return l.fields.maxSlots.value<1&&(e=!0,i(z.a.forms.load.setFieldError(["maxSlots","Please specify amount of allowed jumpers"]))),l.fields.plane.value||(e=!0,i(z.a.forms.load.setFieldError(["plane","What plane is flying this load?"]))),l.fields.gca.value||(e=!0,i(z.a.forms.load.setFieldError(["gca","You must have a GCA for this load"]))),!e}),[JSON.stringify(l.fields),i]),f=o.useCallback((function(){var e,n,t,o,s,u,c,f,p,v,b,g,h,y,E,x,S,O,j,k,w,T,C,P,N;return I.a.async((function($){for(;;)switch($.prev=$.next){case 0:if(e=l.fields,n=e.name,t=e.gca,e.loadMaster,o=e.plane,s=e.maxSlots,u=e.pilot,c=e.isOpen,!m()){$.next=15;break}return $.prev=2,$.next=5,I.a.awrap(d({variables:{dropzoneId:a,name:n.value,maxSlots:s.value,planeId:null!=(f=o.value)&&f.id?Number(null==(p=o.value)?void 0:p.id):null,pilotId:null!=(v=u.value)&&v.id?Number(null==(b=u.value)?void 0:b.id):null,gcaId:null!=(g=t.value)&&g.id?Number(null==(h=t.value)?void 0:h.id):null,isOpen:!!c.value}}));case 5:if(T=$.sent,null==(y=T.data)||null==(E=y.createLoad)||null==(x=E.fieldErrors)||x.map((function(e){var n=e.field,t=e.message;switch(n){case"name":return i(z.a.forms.load.setFieldError(["name",t]));case"maxSlots":return i(z.a.forms.load.setFieldError(["maxSlots",t]));case"plane":return i(z.a.forms.load.setFieldError(["plane",t]));case"gca":return i(z.a.forms.load.setFieldError(["gca",t]));case"is_open":return i(z.a.forms.load.setFieldError(["isOpen",t]));case"pilot":return i(z.a.forms.load.setFieldError(["pilot",t]))}})),null==T||null==(S=T.data)||null==(O=S.createLoad)||null==(j=O.errors)||!j.length){$.next=9;break}return $.abrupt("return",i(He.a.showSnackbar({message:T.data.createLoad.errors[0],variant:"error"})));case 9:null!=(k=T.data)&&null!=(w=k.createLoad)&&w.load&&(N=T.data.createLoad.load,console.log(N),i(He.a.showSnackbar({message:"Load "+N.name+" created",variant:"success"})),null!=(C=T.data)&&null!=(P=C.createLoad)&&P.fieldErrors||(r(T.data.createLoad.load),i(z.a.forms.load.reset()))),$.next=15;break;case 12:$.prev=12,$.t0=$.catch(2),i(He.a.showSnackbar({message:$.t0.message,variant:"error"}));case 15:case"end":return $.stop()}}),null,null,[[2,12]],Promise)}),[JSON.stringify(l.fields),i,d]);return o.createElement(Ye.a,{open:n,onClose:t,buttonAction:f,buttonLabel:"Create",snapPoints:["30%",650],loading:c.loading,title:"New Load"},o.createElement(Qe.a,null))}function Xe(){var e,n,t,r,l,u=Object(z.c)((function(e){return e.global})),p=Object(z.c)((function(e){return e.forms})),v=Object(z.b)(),b=Object(Y.a)(),g=b.dropzone,h=b.currentUser,y=b.loading,E=b.refetch,I=Object(a.useNavigation)(),x=Object(a.useIsFocused)();o.useEffect((function(){x&&E()}),[x]);var S=!(null==g||null==(e=g.planes)||!e.length),O=!(null==g||null==(n=g.ticketTypes)||!n.length),j=!(null==g||!g.isPublic),k=S&&O;o.useEffect((function(){var e,n,t,r;null!=g&&g.primaryColor&&(null==g?void 0:g.primaryColor)!==(null==(e=u.theme)||null==(n=e.colors)?void 0:n.primary)&&v(z.a.global.setPrimaryColor(g.primaryColor)),null!=g&&g.secondaryColor&&(null==g?void 0:g.secondaryColor)!==(null==(t=u.theme)||null==(r=t.colors)?void 0:r.accent)&&v(z.a.global.setPrimaryColor(g.secondaryColor))}),[null==g?void 0:g.primaryColor,null==g?void 0:g.secondaryColor]);var w=Object(H.a)(U.a.CreateLoad),T=o.useCallback((function(e){return h.hasLicense?h.hasMembership?h.hasRigInspection?h.hasReserveInDate?h.hasExitWeight?h.hasCredits?(v(z.a.forms.manifest.setOpen(!0)),v(z.a.forms.manifest.setField(["dropzoneUser",h])),void v(z.a.forms.manifest.setField(["load",e]))):v(z.a.notifications.showSnackbar({message:"You have no credits on your account",variant:"warning"})):v(z.a.notifications.showSnackbar({message:"Update your exit weight on your profile before manifesting",variant:"warning"})):v(z.a.notifications.showSnackbar({message:"Your rig needs a reserve repack",variant:"warning"})):v(z.a.notifications.showSnackbar({message:"Your rig needs to be inspected before manifesting",variant:"warning"})):v(z.a.notifications.showSnackbar({message:"Your membership is out of date",variant:"warning"})):v(z.a.notifications.showSnackbar({message:"You need to select a license on your user profile",variant:"warning"}))}),[JSON.stringify(null==g?void 0:g.currentUser)]),C=Object(d.a)().width,P=Math.ceil(C/400)||1;return o.createElement(o.Fragment,null,o.createElement(m.a,{visible:y,indeterminate:!0,color:u.theme.colors.accent}),o.createElement(be.b,{style:Ze.container},!y&&(k?o.createElement(be.b,{style:{width:"100%",flex:1,height:i.a.get("window").height}},((null==g||null==(t=g.loads)||null==(r=t.edges)?void 0:r.length)||0)<1?o.createElement(se.a,{title:"No loads so far today",subtitle:"How's the weather?"}):o.createElement(c.a,{testID:"loads",keyExtractor:function(e){var n;return"load-"+(null==e||null==(n=e.node)?void 0:n.id)},key:"loads-columns-"+P,style:{flex:1,height:i.a.get("window").height},contentContainerStyle:{flexGrow:1},numColumns:P,data:(null==g||null==(l=g.loads)?void 0:l.edges)||[],refreshing:y,onRefresh:E,refreshControl:o.createElement(s.a,{refreshing:y,onRefresh:function(){return E()}}),renderItem:function(e){var n=e.item;e.index;return null!=n&&n.node?o.createElement(Me,{key:"load-"+n.node.id,load:n.node,onSlotPress:function(e){v(z.a.forms.manifest.setOpen(e)),v(z.a.forms.manifest.setField(["load",n.node]))},onSlotGroupPress:function(e){v(z.a.forms.manifestGroup.reset()),v(z.a.forms.manifestGroup.setFromSlots(e)),v(z.a.forms.manifestGroup.setField(["load",n.node])),I.navigate("ManifestGroupScreen")},onManifest:function(){T(n.node)},onManifestGroup:function(){v(z.a.forms.manifestGroup.reset()),v(z.a.forms.manifestGroup.setOpen(!0)),v(z.a.forms.manifestGroup.setField(["load",n.node]))}}):null}})):o.createElement(he,{hasPlanes:S,hasTicketTypes:O,isPublic:j})),w&&k&&o.createElement(f.a,{style:Ze.fab,small:!0,icon:"plus",onPress:function(){return v(z.a.forms.load.setOpen(!0))},label:"New load"})),o.createElement(ne,{open:p.manifest.open,onClose:function(){return v(z.a.forms.manifest.setOpen(!1))},onSuccess:function(){return v(z.a.forms.manifest.setOpen(!1))}}),o.createElement(pe,{open:p.manifestGroup.open,onClose:function(){return v(z.a.forms.manifestGroup.setOpen(!1))},onSuccess:function(){return v(z.a.forms.manifestGroup.setOpen(!1))}}),o.createElement(Ve,{onSuccess:function(){v(z.a.forms.load.setOpen(!1)),E()},open:p.load.open,onClose:function(){return v(z.a.forms.load.setOpen(!1))}}))}var Ze=u.a.create({container:{flex:1,alignItems:"center",justifyContent:"center"},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},fab:{position:"absolute",margin:16,right:0,bottom:0}})}}]);
//# sourceMappingURL=6.526bfaef.chunk.js.map