{"version":3,"sources":["components/notifications/index.ts","components/forms/plane/PlaneForm.tsx","screens/authenticated/planes/CreatePlaneScreen.tsx"],"names":["actions","slice","Notifications","DropzoneForm","state","useAppSelector","forms","plane","dispatch","useAppDispatch","style","styles","field","mode","label","error","fields","name","value","onChangeText","newValue","setField","type","registration","hours","toString","placeholder","Number","minSlots","keyboardType","maxSlots","StyleSheet","create","width","flex","marginBottom","MUTATION_CREATE_PLANE","gql","CreatePlaneScreen","currentDropzone","useCurrentDropzone","navigation","useNavigation","useMutation","mutationCreatePlane","data","isFocused","useIsFocused","React","reset","validate","hasError","length","setFieldError","JSON","stringify","onSave","a","async","nextMaintenanceHours","variables","dropzoneId","dropzone","id","result","createPlane","snackbar","showSnackbar","message","variant","goBack","contentContainerStyle","content","size","color","alignSelf","disabled","loading","onPress","paddingHorizontal","title","fontSize","fontWeight","separator","marginVertical","height"],"mappings":"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","file":"static/js/17.860cc3ed.chunk.js","sourcesContent":["import slice from \"./slice\";\nimport Notifications from \"./Notifications\";\n\nconst { actions } = slice;\n\nexport { actions };\nexport default Notifications;\n","import * as React from 'react';\nimport { StyleSheet } from 'react-native';\nimport { TextInput, HelperText } from 'react-native-paper';\nimport { actions, useAppSelector, useAppDispatch } from '../../../redux';\n\n\nexport default function DropzoneForm() {\n  const state = useAppSelector(state => state.forms.plane);\n  const dispatch = useAppDispatch();\n\n  return ( \n    <>\n      <TextInput\n        style={styles.field}\n        mode=\"outlined\"\n        label=\"Name\"\n        error={!!state.fields.name.error}\n        value={state.fields.name.value}\n        onChangeText={(newValue) => dispatch(actions.forms.plane.setField([\"name\", newValue]))}\n      />\n      <HelperText type={!!state.fields.name.error ? \"error\" : \"info\"}>\n        { state.fields.name.error || \"\" }\n      </HelperText>\n\n      <TextInput\n        style={styles.field}\n        mode=\"outlined\"\n        label=\"Registration\"\n        error={!!state.fields.registration.error}\n        value={state.fields.registration.value}\n        onChangeText={(newValue) => dispatch(actions.forms.plane.setField([\"registration\", newValue]))}\n      />\n      <HelperText type={!!state.fields.registration.error ? \"error\" : \"info\"}>\n        { state.fields.registration.error || \"\" }\n      </HelperText>\n\n      <TextInput\n        style={styles.field}\n        mode=\"outlined\"\n        label=\"hours\"\n        error={!!state.fields.hours.error}\n        value={state.fields.hours?.value?.toString()}\n        placeholder=\"Optional\"\n        onChangeText={(newValue) => dispatch(actions.forms.plane.setField([\"hours\", Number(newValue)]))}\n      />\n      <HelperText type={!!state.fields.hours.error ? \"error\" : \"info\"}>\n        { state.fields.hours.error || \"\" }\n      </HelperText>\n\n      <TextInput\n        style={styles.field}\n        mode=\"outlined\"\n        label=\"Min slots\"\n        error={!!state.fields.minSlots.error}\n        value={state.fields.minSlots.value?.toString()}\n        keyboardType=\"number-pad\"\n        onChangeText={(newValue) => dispatch(actions.forms.plane.setField([\"minSlots\", Number(newValue)]))}\n      />\n      <HelperText type={!!state.fields.minSlots.error ? \"error\" : \"info\"}>\n        { state.fields.minSlots.error || \"Minimum tickets required to send it\" }\n      </HelperText>\n\n      <TextInput\n        style={styles.field}\n        mode=\"outlined\"\n        label=\"Max slots\"\n        error={!!state.fields.maxSlots.error}\n        value={state.fields.maxSlots?.value.toString()}\n        keyboardType=\"number-pad\"\n        onChangeText={(newValue) => dispatch(actions.forms.plane.setField([\"maxSlots\", Number(newValue)]))}\n      />\n      <HelperText type={!!state.fields.maxSlots.error ? \"error\" : \"info\"}>\n        { state.fields.maxSlots.error || \"Maximum amount of jumpers who can be manifested on one load\" }\n      </HelperText>\n    </>\n  );\n}\n\nconst styles = StyleSheet.create({\n  fields: {\n    width: \"100%\",\n    flex: 1,\n  },\n  field: {\n    width: \"100%\",\n    marginBottom: 8,\n  }\n});\n","import * as React from 'react';\nimport { StyleSheet, Text } from 'react-native';\nimport { Button } from 'react-native-paper';\nimport { gql, useMutation } from \"@apollo/client\";\nimport { actions, useAppSelector, useAppDispatch } from '../../../redux';\n\nimport { View } from '../../../components/Themed';\nimport { actions as snackbar } from \"../../../components/notifications\";\n\nimport { Mutation } from '../../../graphql/schema';\nimport PlaneForm from '../../../components/forms/plane/PlaneForm';\nimport { useIsFocused, useNavigation } from '@react-navigation/core';\nimport ScrollableScreen from '../../../components/layout/ScrollableScreen';\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\nimport useCurrentDropzone from '../../../graphql/hooks/useCurrentDropzone';\n\n\nconst MUTATION_CREATE_PLANE = gql`\n  mutation CreatePlane(\n    $name: String!,\n    $registration: String!,\n    $dropzoneId: Int!\n    $minSlots: Int!\n    $maxSlots: Int!\n    $hours: Int\n    $nextMaintenanceHours: Int\n  ){\n    createPlane(input: {\n      attributes: {\n        name: $name,\n        registration: $registration,\n        dropzoneId: $dropzoneId\n        minSlots: $minSlots\n        maxSlots: $maxSlots\n        hours: $hours\n        nextMaintenanceHours: $nextMaintenanceHours\n      }\n    }) {\n      plane {\n        id\n        name\n        registration\n        minSlots\n        maxSlots\n        hours\n        nextMaintenanceHours\n\n        dropzone {\n          id\n          name\n          planes {\n            id\n            name\n            registration\n            minSlots\n            maxSlots\n            hours\n            nextMaintenanceHours\n          }\n        }\n      }\n    }\n  }\n`;\n\nexport default function CreatePlaneScreen() {\n  const state  = useAppSelector(state => state.forms.plane);\n  const currentDropzone = useCurrentDropzone();\n  const dispatch = useAppDispatch();\n\n  const navigation = useNavigation();\n\n  const [mutationCreatePlane, data] = useMutation<Mutation>(MUTATION_CREATE_PLANE);\n  const isFocused = useIsFocused();\n  React.useEffect(() => {\n    if (isFocused) {\n      dispatch(actions.forms.plane.reset());\n    }\n  }, [isFocused]);\n\n  const validate = React.useCallback((): boolean => {\n    let hasError = false;\n    if (state.fields.name.value.length < 3) {\n      hasError = true;\n      dispatch(\n        actions.forms.plane.setFieldError([\"name\", \"Name is too short\"])\n      );\n    }\n\n    if (state.fields.registration.value.length < 3) {\n      hasError = true;\n      dispatch(\n        actions.forms.plane.setFieldError([\"registration\", \"Registration is too short\"])\n      );\n    }\n\n    if (!state.fields.maxSlots.value) {\n      hasError = true;\n      dispatch(\n        actions.forms.plane.setFieldError([\"maxSlots\", \"Max slots must be specified\"])\n      );\n    }\n\n    return !hasError;\n  }, [JSON.stringify(state.fields), dispatch]);\n\n  const onSave = React.useCallback(async () => {\n    const { name, registration, maxSlots, minSlots, hours, nextMaintenanceHours } = state.fields;\n\n    \n\n    if (validate()) {\n      try {\n        const result = await mutationCreatePlane({\n          variables: {\n            dropzoneId: Number(currentDropzone?.dropzone?.id),\n            name: name.value,\n            registration: registration.value,\n            minSlots: minSlots.value,\n            maxSlots: maxSlots.value,\n            hours: hours.value,\n            nextMaintenanceHours: nextMaintenanceHours.value,\n          }\n        });\n        \n        if (result.data?.createPlane?.plane) {\n          const { plane } = result.data.createPlane;\n          dispatch(\n            snackbar.showSnackbar({ message: `Added plane ${plane.name}`, variant: \"success\" })\n          );\n          navigation.goBack();\n        }\n      } catch (error) {\n        dispatch(\n          snackbar.showSnackbar({ message: error.message, variant: \"error\" })\n        );\n      }\n    }\n    \n  }, [JSON.stringify(state.fields), dispatch, mutationCreatePlane]);\n\n  return (\n    <ScrollableScreen contentContainerStyle={styles.content}>\n        <MaterialCommunityIcons name=\"airplane\" size={100} color=\"#999999\" style={{ alignSelf: \"center\" }} />\n        <PlaneForm />\n        <View style={styles.fields}>\n          <Button mode=\"contained\" disabled={data.loading} onPress={onSave} loading={data.loading}>\n            Save\n          </Button>\n      </View>\n    </ScrollableScreen>\n  );\n}\n\nconst styles = StyleSheet.create({\n  content: {\n    paddingHorizontal: 48,\n  },\n  title: {\n    fontSize: 20,\n    fontWeight: 'bold',\n  },\n  separator: {\n    marginVertical: 30,\n    height: 1,\n    width: '80%',\n  },\n  fields: {\n    width: \"100%\",\n    marginBottom: 16\n  },\n  field: {\n    marginBottom: 8,\n  }\n});\n"],"sourceRoot":""}