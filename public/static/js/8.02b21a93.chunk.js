(this.webpackJsonp=this.webpackJsonp||[]).push([[8],{532:function(e,n,t){"use strict";var l=t(533),r=t(0),a=t(2),o=t(317);n.a=function(e){var n=e.items,t=e.selected,i=e.isSelected,s=e.isDisabled,u=e.icon,d=e.renderItemLabel,c=e.onChangeSelected,m=e.autoSelectFirst;return r.useEffect((function(){(!t||!t.length&&n.length&&m)&&c([n[0]])}),[JSON.stringify(t),JSON.stringify(n),m]),r.createElement(a.a,{style:{flexDirection:"row",flexWrap:"wrap"}},n.map((function(e){return r.createElement(o.a,{key:JSON.stringify(e),mode:"outlined",icon:!t.some((function(n){return Object(l.isEqual)(e,n)}))&&u?u:void 0,style:{margin:1},disabled:s(e),selected:i?i(e):t.some((function(n){return Object(l.isEqual)(e,n)})),onPress:function(){return c(1===t.length?[e]:Object(l.xorBy)(t,[e],JSON.stringify))}},d(e))})))}},534:function(e,n,t){"use strict";t.d(n,"a",(function(){return s}));var l=t(0),r=t(1),a=t(137),o=t(316),i=t(82);function s(e){var n=e.title,t=e.subtitle;return l.createElement(i.b,{style:u.empty},l.createElement(a.a,null,n),l.createElement(o.a,{style:{textAlign:"center"}},t))}var u=r.a.create({container:{flex:1,padding:8,display:"flex"},fab:{position:"absolute",margin:16,right:0,bottom:0},empty:{flex:1,alignItems:"center",justifyContent:"center",width:"100%",height:"100%"}})},535:function(e,n,t){"use strict";t.d(n,"a",(function(){return c}));var l=t(0),r=t(1),a=t(389),o=t(167),i=t(155),s=t(326),u=t(125),d=t(19);function c(e){var n=e.buttonLabel,t=e.buttonAction,r=e.title,c=e.loading,m=e.children,f=Object(d.c)((function(e){return e.global}));return l.createElement(o.a,null,l.createElement(i.a,{visible:!!e.open,dismissable:!1,style:{maxWidth:500,alignSelf:"center"}},l.createElement(s.a,{indeterminate:!0,visible:c,color:f.theme.colors.accent}),l.createElement(i.a.Title,null,r),l.createElement(i.a.Content,{pointerEvents:"box-none"},l.createElement(i.a.ScrollArea,null,l.createElement(a.b,null,m))),l.createElement(i.a.Actions,{style:{justifyContent:"flex-end"}},l.createElement(u.a,{onPress:function(){e.onClose()}},"Cancel"),l.createElement(u.a,{onPress:t},n))))}r.a.create({button:{width:"100%",borderRadius:16,padding:5},contentContainer:{paddingHorizontal:16,paddingBottom:32},sheet:{elevation:3,backgroundColor:"white",flexGrow:1,height:"100%",display:"flex",flexDirection:"column",justifyContent:"center"},sheetHeader:{elevation:2,borderTopLeftRadius:20,borderTopRightRadius:20,height:40,shadowColor:"#000",shadowOffset:{width:0,height:-4},backgroundColor:"white",shadowOpacity:.22,shadowRadius:2.22}})},536:function(e,n,t){"use strict";t.d(n,"a",(function(){return a}));var l=t(130),r=t(278),a=l.a.actions;r.a},537:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var l=t(49),r=t(0),a=t(19);function o(e,n){var t=n.getPayload;return function(n){var o=n.variables,i=n.onError,s=Object(a.b)(),u=Object(l.useQuery)(e,{variables:o}),d=u.data,c=u.loading,m=u.previousData,f=u.refetch,p=u.error,v=r.useMemo((function(){return t(d)}),[JSON.stringify(d)]);return r.useEffect((function(){JSON.stringify(m),JSON.stringify(d);null!=p&&p.message&&(!1!==n.showSnackbarErrors&&s(a.a.notifications.showSnackbar({message:p.message,variant:"error"})),i&&p.message)}),[n.onError,null==p?void 0:p.message]),{loading:c,data:v,refetch:f}}}},544:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var l=t(0),r=t(4),a=t(389),o=t(279);function i(e){var n=e.children,t=e.rightAction,i=e.disabled,s=l.useRef();return l.createElement(o.a,{ref:s,enabled:!i,renderRightActions:function(e,n){var o=n.interpolate({inputRange:[-100,0],outputRange:[1,0]}),i=n.interpolate({inputRange:[-150,0],outputRange:[0,10]});return l.createElement(a.d,{onPress:function(){var e;null==t||t.onPress(),null==s||null==(e=s.current)||e.close()}},l.createElement(r.a.View,{style:{flexGrow:1,backgroundColor:null==t?void 0:t.backgroundColor,justifyContent:"center",height:"100%",width:75,transform:[{translateX:i}]}},l.createElement(r.a.Text,{style:{color:"white",paddingHorizontal:10,fontWeight:"600",transform:[{scale:o}]}},null==t?void 0:t.label)))},useNativeAnimations:!0},n)}},554:function(e,n,t){"use strict";t.d(n,"a",(function(){return v}));var l,r=t(11),a=t.n(r),o=t(57),i=t.n(o),s=t(49),u=t(58),d=t(0),c=t(176),m=t(56),f=t(276),p=Object(u.a)(l||(l=i()(["\n  query QueryAvailableRigs(\n    $dropzoneId: Int!\n    $userId: Int!\n  ) {\n    dropzone(id: $dropzoneId) {\n      id\n      dropzoneUser(userId: $userId) {\n        id\n        availableRigs {\n          id\n          make\n          model\n          canopySize\n          serial\n\n          user {\n            id\n          }\n        }\n      }\n    }\n  }\n"])));function v(e){var n,t,l,r,o,i,u,v,b=d.useState(!1),g=a()(b,2),h=g[0],y=g[1],E=Object(f.a)(),I=Object(s.useLazyQuery)(p),x=a()(I,2),S=x[0],O=x[1].data;return d.useEffect((function(){var n;e.userId&&e.dropzoneId&&S({variables:{dropzoneId:Number(null==E||null==(n=E.dropzone)?void 0:n.id),userId:Number(e.userId)}})}),[e.userId,e.dropzoneId]),d.useEffect((function(){var n,t,l;!e.value&&e.autoSelectFirst&&null!=O&&null!=(n=O.dropzone)&&null!=(t=n.dropzoneUser)&&null!=(l=t.availableRigs)&&l.length&&e.onSelect(O.dropzone.dropzoneUser.availableRigs[0])}),[e.autoSelectFirst,JSON.stringify(null==O||null==(n=O.dropzone)||null==(t=n.dropzoneUser)?void 0:t.availableRigs)]),d.createElement(c.a,{onDismiss:function(){return y(!1)},visible:h,anchor:d.createElement(m.b.Item,{onPress:function(){y(!0)},title:e.value?(null==(l=e.value)?void 0:l.make)+" "+(null==(r=e.value)?void 0:r.model)+" ("+((null==(o=e.value)?void 0:o.canopySize)||"?")+"sqft)":"Select rig",description:e.required?null:"Optional",left:function(){return d.createElement(m.b.Icon,{icon:"parachute"})}})},null==O||null==(i=O.dropzone)||null==(u=i.dropzoneUser)||null==(v=u.availableRigs)?void 0:v.map((function(n){return d.createElement(c.a.Item,{key:"rig-select-"+n.id,onPress:function(){y(!1),e.onSelect(n)},style:{width:"100%"},title:(null==n?void 0:n.make)+" "+(null==n?void 0:n.model)+" ("+(null==n?void 0:n.canopySize)+" sqft) "+(n.user?"":"[DROPZONE RIG]")})})))}},574:function(e,n,t){"use strict";t.d(n,"a",(function(){return N}));var l,r=t(0),a=t(1),o=t(2),i=t(266),s=t(238),u=t(318),d=t(240),c=t(19),m=t(11),f=t.n(m),p=t(56),v=t(276),b=t(57),g=t.n(b),h=t(58),y=t(537),E=Object(h.a)(l||(l=g()(["\nquery QueryDropzoneUsers(\n  $dropzoneId: Int!\n  $permissions: [Permission!]\n) {\n  dropzone(id: $dropzoneId) {\n    id\n    name\n\n    dropzoneUsers(permissions: $permissions) {\n      edges {\n        node {\n          id\n          role {\n            id\n            name\n          }\n          user {\n            id\n            name\n          }\n        }\n      }\n    }\n  }\n}\n"]))),I=Object(y.a)(E,{getPayload:function(e){var n;return null==e||null==(n=e.dropzone)?void 0:n.dropzoneUsers}}),x=t(532);function S(e){var n,t,l=e.label,a=e.requiredPermissions,o=e.icon,i=(e.required,e.value),s=Object(v.a)(),u=Object(c.b)(),d=I({variables:{dropzoneId:Number(null==s||null==(n=s.dropzone)?void 0:n.id),permissions:a},onError:function(e){return u(c.a.notifications.showSnackbar({message:e,variant:"error"}))}}),m=d.data;d.loading,d.refetch;return r.createElement(r.Fragment,null,r.createElement(p.b.Subheader,null,l),r.createElement(x.a,{autoSelectFirst:!0,icon:o||"account",items:(null==m||null==(t=m.edges)?void 0:t.map((function(e){return e.node})))||[],selected:[e.value].filter(Boolean),isSelected:function(e){return e.id===(null==i?void 0:i.id)},renderItemLabel:function(e){return null==e?void 0:e.user.name},isDisabled:function(){return!1},onChangeSelected:function(n){var t=f()(n,1)[0];return t?e.onSelect(t):null}}))}var O,j=t(22),k=t.n(j),z=t(49),w=t(533),T=Object(h.a)(O||(O=g()(["\n  query QueryPlanes(\n    $dropzoneId: Int!\n  ) {\n    planes(dropzoneId: $dropzoneId) {\n      id\n      name\n      registration\n      hours\n      minSlots\n      maxSlots\n      nextMaintenanceHours\n      createdAt\n    }\n  }\n"])));function C(e){var n,t=Object(v.a)(),l=Object(z.useQuery)(T,{variables:{dropzoneId:Number(null==(n=t.dropzone)?void 0:n.id)}}),a=l.data;l.loading,l.refetch;return r.createElement(r.Fragment,null,r.createElement(p.b.Subheader,null,"Aircraft"),r.createElement(x.a,{autoSelectFirst:!0,items:Object(w.uniqBy)(k()((null==a?void 0:a.planes)||[]),(function(e){return e.id}))||[],selected:[e.value].filter(Boolean),renderItemLabel:function(e){return null==e?void 0:e.name},isDisabled:function(e){return!1},onChangeSelected:function(n){var t=f()(n,1)[0];return t?e.onSelect(t):null}}))}function N(){var e,n,t=Object(c.c)((function(e){return e.forms.load})),l=Object(c.b)();Object(c.c)((function(e){return e.global}));return r.createElement(r.Fragment,null,r.createElement(i.a,{style:P.field,mode:"outlined",label:"Name",error:!!t.fields.name.error,placeholder:"Optional",value:t.fields.name.value||"",autoFocus:!0,onChangeText:function(e){return l(c.a.forms.load.setField(["name",e]))}}),r.createElement(s.a,{type:t.fields.name.error?"error":"info"},t.fields.name.error||"e.g Starcrest load, Tandem load"),r.createElement(i.a,{style:P.field,mode:"outlined",label:"Slots",error:!!t.fields.maxSlots.error,value:null==(e=t.fields.maxSlots)||null==(n=e.value)?void 0:n.toString(),onChangeText:function(e){return l(c.a.forms.load.setField(["maxSlots",Number(e)]))}}),r.createElement(s.a,{type:t.fields.maxSlots.error?"error":"info"},t.fields.maxSlots.error||""),r.createElement(o.a,{style:{width:"100%"}},r.createElement(C,{value:t.fields.plane.value,required:!0,onSelect:function(e){l(c.a.forms.load.setField(["plane",e])),l(c.a.forms.load.setField(["maxSlots",e.maxSlots]))}}),r.createElement(s.a,{type:t.fields.plane.error?"error":"info"},t.fields.plane.error||""),r.createElement(S,{label:"GCA",onSelect:function(e){return l(c.a.forms.load.setField(["gca",e]))},value:t.fields.gca.value||null,requiredPermissions:["actAsGCA"],required:!0}),r.createElement(s.a,{type:t.fields.gca.error?"error":"info"},t.fields.gca.error||""),r.createElement(S,{label:"Pilot",onSelect:function(e){return l(c.a.forms.load.setField(["pilot",e]))},value:t.fields.pilot.value||null,requiredPermissions:["actAsPilot"]}),r.createElement(s.a,{type:t.fields.pilot.error?"error":"info"},t.fields.pilot.error||""),r.createElement(u.a,{style:{marginVertical:8}}),r.createElement(d.a.Item,{label:"Allow public manifesting",status:t.fields.isOpen.value?"checked":"unchecked",onPress:function(){return l(c.a.forms.load.setField(["isOpen",!t.fields.isOpen.value]))}})))}var P=a.a.create({fields:{flex:1,width:"100%"},field:{marginBottom:8,width:"100%"}})},575:function(e,n,t){"use strict";t.d(n,"a",(function(){return A}));var l=t(3),r=t.n(l),a=t(11),o=t.n(a),i=t(22),s=t.n(i),u=t(57),d=t.n(u),c=t(0),m=t(77),f=t(1),p=t(56),v=t(104),b=t(238),g=t(317),h=t(318),y=t(58),E=t(533),I=t(19),x=t(532),S=t(537),O=t(326),j=t(266);var k,z=t(554),w=Object(y.a)(k||(k=d()(["\nquery QueryDropzoneUsersManifestDetails(\n  $dropzoneId: Int!\n  $dropzoneUserId: Int!\n) {\n  dropzone(id: $dropzoneId) {\n    id\n    name\n\n    dropzoneUser(userId: $dropzoneUserId) {\n      id\n\n      user {\n        id\n        name\n        exitWeight\n        license {\n          id\n          name\n        }\n        rigs {\n          id\n          make\n          model\n          canopySize\n        }\n      }\n      role {\n        id\n        name\n      }\n      user {\n        id\n        name\n        image\n      }\n    }\n  }\n}\n"]))),T=Object(S.a)(w,{getPayload:function(e){var n;return null==e||null==(n=e.dropzone)?void 0:n.dropzoneUser}});function C(e){var n,t,l,r,a,o,i,s,u=e.dropzoneId,d=e.dropzoneUserId,f=e.onChangeRig,b=e.exitWeight,y=e.rigId,x=e.onChangeExitWeight,S=Object(I.c)((function(e){return e})).global,k=T({variables:{dropzoneUserId:d,dropzoneId:u},onError:console.error}),w=k.data,C=k.loading,N=null==w||null==(n=w.user)||null==(t=n.rigs)?void 0:t.find((function(e){var n=e.id;return Number(n)===y}));return c.useEffect((function(){var e;!b&&null!=w&&null!=(e=w.user)&&e.exitWeight&&x(Number(w.user.exitWeight))}),[null==w||null==(l=w.user)?void 0:l.exitWeight]),c.createElement(v.a,{style:{width:"100%"},elevation:3},c.createElement(O.a,{indeterminate:!0,color:S.theme.colors.accent,visible:C}),c.createElement(v.a.Title,{title:null==w?void 0:w.user.name,left:function(){var e;return null!=w&&null!=(e=w.user)&&e.image?c.createElement(p.a.Image,{source:{uri:w.user.image},size:24}):c.createElement(p.a.Icon,{icon:"account",size:24})}}),c.createElement(v.a.Content,null,c.createElement(h.a,{style:{marginBottom:8}}),c.createElement(m.a,{horizontal:!0},c.createElement(g.a,{style:{marginHorizontal:1},icon:"lock",mode:"outlined",disabled:!0},null==w||null==(r=w.role)?void 0:r.name),c.createElement(g.a,{style:{marginHorizontal:1},icon:"ticket-account",mode:"outlined",disabled:!0},null==w||null==(a=w.user)||null==(o=a.license)?void 0:o.name),N&&b&&N.canopySize?c.createElement(g.a,{style:{marginHorizontal:1},icon:"escalator-down",mode:"outlined",disabled:!0},(i=b,s=N.canopySize,Object(E.round)(2.20462*i/s,2).toFixed(2))):null),c.createElement(z.a,{userId:d,dropzoneId:u,onSelect:f,value:N,autoSelectFirst:!0}),c.createElement(j.a,{value:b?""+b:"",onChangeText:function(e){return x(Number(e))},keyboardType:"number-pad",label:"Exit weight",mode:"outlined"})))}var N,P=t(276);function $(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);n&&(l=l.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,l)}return t}function F(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?$(Object(t),!0).forEach((function(n){r()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):$(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var U=Object(y.a)(N||(N=d()(["\nquery DropzoneUsersAllowedJumpTypes(\n  $dropzoneId: Int!,\n  $userIds: [Int!]!\n) {\n  dropzone(id: $dropzoneId) {\n    id\n\n    allowedJumpTypes(userId: $userIds) {\n      id\n      name\n    }\n\n    ticketTypes(isPublic: true) {\n      id\n      name\n      cost\n\n      extras {\n        id\n        cost\n        name\n      }\n    }\n  }\n  jumpTypes {\n    id\n    name\n  }\n}\n\n"]))),D=Object(S.a)(U,{getPayload:function(e){var n,t;return{allowedJumpTypes:(null==e||null==(n=e.dropzone)?void 0:n.allowedJumpTypes)||[],ticketTypes:(null==e||null==(t=e.dropzone)?void 0:t.ticketTypes)||[],jumpTypes:(null==e?void 0:e.jumpTypes)||[]}}});function A(){var e,n,t,l,r,a,i,u,d,f,y,S,O,j,k=Object(I.c)((function(e){return e.forms.manifestGroup})),z=(Object(I.c)((function(e){return e.global})),Object(P.a)()),w=Object(I.b)(),T=D({variables:{userIds:null==(e=k.fields.users)||null==(n=e.value)?void 0:n.map((function(e){return e.id})),dropzoneId:Number(null==z||null==(t=z.dropzone)?void 0:t.id)},onError:console.error}),N=T.data;T.loading;return c.createElement(c.Fragment,null,c.createElement(p.b.Subheader,null,"Jump type"),c.createElement(v.a,{elevation:2,style:{marginBottom:16,flexShrink:1}},c.createElement(v.a.Content,null,c.createElement(x.a,{autoSelectFirst:!0,items:Object(E.uniqBy)([].concat(s()((null==N?void 0:N.allowedJumpTypes)||[]),s()((null==N?void 0:N.jumpTypes)||[])),(function(e){return e.id}))||[],selected:k.fields.jumpType.value?[k.fields.jumpType.value]:[],renderItemLabel:function(e){return e.name},isDisabled:function(e){var n;return!(null!=N&&null!=(n=N.allowedJumpTypes)&&n.map((function(e){return e.id})).includes(e.id))},onChangeSelected:function(e){var n=o()(e,1)[0];return w(I.a.forms.manifestGroup.setField(["jumpType",n]))}}),c.createElement(b.a,{type:k.fields.jumpType.error?"error":"info"},k.fields.jumpType.error||""))),c.createElement(p.b.Subheader,null,"Ticket"),c.createElement(v.a,{elevation:2,style:{width:"100%"}},c.createElement(v.a.Content,null,c.createElement(x.a,{autoSelectFirst:!0,items:(null==N?void 0:N.ticketTypes)||[],selected:k.fields.ticketType.value?[k.fields.ticketType.value]:[],renderItemLabel:function(e){return e.name},isDisabled:function(){return!1},onChangeSelected:function(e){var n=o()(e,1)[0];return w(I.a.forms.manifestGroup.setField(["ticketType",n]))}}),c.createElement(b.a,{type:k.fields.ticketType.error?"error":"info"},k.fields.ticketType.error||""),null!=k&&null!=(l=k.fields)&&null!=(r=l.ticketType)&&null!=(a=r.value)&&null!=(i=a.extras)&&i.length?c.createElement(p.b.Subheader,null,"Ticket addons"):null,c.createElement(m.a,{horizontal:!0,style:L.ticketAddons},null==k||null==(u=k.fields)||null==(d=u.ticketType)||null==(f=d.value)||null==(y=f.extras)?void 0:y.map((function(e){var n,t,l,r;return c.createElement(g.a,{selected:null==k||null==(n=k.fields)||null==(t=n.extras.value)?void 0:t.some((function(n){return n.id===e.id})),onPress:null!=k&&null!=(l=k.fields)&&null!=(r=l.extras.value)&&r.some((function(n){return n.id===e.id}))?function(){var n,t;return w(I.a.forms.manifestGroup.setField(["extras",null==k||null==(n=k.fields)||null==(t=n.extras.value)?void 0:t.filter((function(n){return n.id!==e.id}))]))}:function(){var n,t;return w(I.a.forms.manifestGroup.setField(["extras",[].concat(s()((null==k||null==(n=k.fields)||null==(t=n.extras)?void 0:t.value)||[]),[e])]))}},e.name+" ($"+e.cost+")")}))),c.createElement(b.a,{type:k.fields.extras.error?"error":"info"},k.fields.extras.error||""))),c.createElement(h.a,null),c.createElement(p.b.Subheader,null,"Group"),null==(S=k.fields)||null==(O=S.users)||null==(j=O.value)?void 0:j.map((function(e){var n;return c.createElement(C,{dropzoneId:Number(null==z||null==(n=z.dropzone)?void 0:n.id),dropzoneUserId:Number(e.id),rigId:Number(e.rigId)||void 0,exitWeight:e.exitWeight,onChangeExitWeight:function(n){var t;return w(I.a.forms.manifestGroup.setField(["users",null==(t=k.fields.users.value)?void 0:t.map((function(t){return t.id===e.id?F(F({},e),{},{exitWeight:n}):t}))]))},onChangeRig:function(n){var t;return w(I.a.forms.manifestGroup.setField(["users",null==(t=k.fields.users.value)?void 0:t.map((function(t){return t.id===e.id?F(F({},e),{},{rigId:Number(n.id)}):t}))]))}})})))}var L=f.a.create({fields:{flex:1},field:{marginBottom:8},ticketAddons:{marginBottom:8}})},711:function(e,n,t){"use strict";t.r(n),t.d(n,"default",(function(){return Ke}));var l,r,a=t(50),o=t(0),i=t(29),s=t(182),u=t(1),d=t(185),c=t(389),m=t(326),f=t(331),p=t(3),v=t.n(p),b=t(11),g=t.n(b),h=t(57),y=t.n(h),E=t(6),I=t.n(E),x=t(49),S=t(77),O=t(167),j=t(155),k=t(125),z=t(19),w=t(22),T=t.n(w),C=t(238),N=t(56),P=t(317),$=t(318),F=t(266),U=t(98),D=t(58),A=t(533),L=t(537),W=t(276),G=t(532),J=Object(D.a)(l||(l=y()(["\nquery DropzoneUsersAllowedJumpTypes(\n  $dropzoneId: Int!,\n  $userIds: [Int!]!\n) {\n  dropzone(id: $dropzoneId) {\n    id\n\n    allowedJumpTypes(userId: $userIds) {\n      id\n      name\n    }\n  }\n  jumpTypes {\n    id\n    name\n  }\n}\n\n"]))),q=Object(L.a)(J,{getPayload:function(e){var n,t;return{allowedJumpTypes:(null==e||null==(n=e.dropzone)?void 0:n.allowedJumpTypes)||[],ticketTypes:(null==e||null==(t=e.dropzone)?void 0:t.ticketTypes)||[],jumpTypes:(null==e?void 0:e.jumpTypes)||[]}}});function R(e){var n,t=Object(W.a)(),l=q({variables:{userIds:[Number(e.userId)||null].filter(Boolean),dropzoneId:Number(null==t||null==(n=t.dropzone)?void 0:n.id)},onError:console.error}),r=l.data;l.loading;return o.createElement(o.Fragment,null,o.createElement(N.b.Subheader,null,"Jump type"),o.createElement(G.a,{autoSelectFirst:!0,items:Object(A.uniqBy)([].concat(T()((null==r?void 0:r.allowedJumpTypes)||[]),T()((null==r?void 0:r.jumpTypes)||[])),(function(e){return e.id}))||[],selected:[e.value].filter(Boolean),renderItemLabel:function(e){return null==e?void 0:e.name},isDisabled:function(e){var n;return!(null!=r&&null!=(n=r.allowedJumpTypes)&&n.map((function(e){return e.id})).includes(e.id))},onChangeSelected:function(n){var t=g()(n,1)[0];return t?e.onSelect(t):null}}))}var M=Object(D.a)(r||(r=y()(["\nquery DropzoneUsersAllowedTicketTypes(\n  $dropzoneId: Int!,\n  $onlyPublicTickets: Boolean\n) {\n  dropzone(id: $dropzoneId) {\n    id\n\n    ticketTypes(isPublic: $onlyPublicTickets) {\n      id\n      name\n      cost\n      isTandem\n\n      extras {\n        id\n        cost\n        name\n      }\n    }\n  }\n}\n\n"]))),B=Object(L.a)(M,{getPayload:function(e){var n;return{ticketTypes:(null==e||null==(n=e.dropzone)?void 0:n.ticketTypes)||[]}}});function H(e){var n,t=Object(W.a)(),l=B({variables:{dropzoneId:Number(null==t||null==(n=t.dropzone)?void 0:n.id),onlyPublicTickets:e.onlyPublicTickets||null},onError:console.error}),r=l.data;l.loading;return o.createElement(o.Fragment,null,o.createElement(N.b.Subheader,null,"Ticket"),o.createElement(G.a,{autoSelectFirst:!0,items:(null==r?void 0:r.ticketTypes)||[],selected:[e.value].filter(Boolean),renderItemLabel:function(e){return null==e?void 0:e.name},isDisabled:function(){return!1},onChangeSelected:function(n){var t=g()(n,1)[0];return t?e.onSelect(t):null}}))}var Q=t(97),Y=t(554);function _(){var e,n,t,l,r,a,i,s,u,d,c,m,f,p,v,b,g,h,y,E,I,x,O,j,k,w,D=Object(z.b)(),A=Object(W.a)(),L=Object(z.c)((function(e){return e.forms.manifest}));o.useEffect((function(){var e;if(null!=(e=L.fields.dropzoneUser)&&e.value){var n,t,l,r,a,o,i;if(!L.fields.exitWeight.value)D(z.a.forms.manifest.setField(["exitWeight",Number((null==(l=L.fields.dropzoneUser)||null==(r=l.value)||null==(a=r.user)?void 0:a.exitWeight)||60)]));if(!L.fields.rig.value&&null!=(n=L.fields.dropzoneUser.value.user)&&null!=(t=n.rigs)&&t.length)D(z.a.forms.manifest.setField(["rig",null==(o=L.fields.dropzoneUser)||null==(i=o.value)?void 0:i.user.rigs[0]]))}}),[null==(e=L.fields)||null==(n=e.dropzoneUser)||null==(t=n.value)?void 0:t.id]);var G=null==L||null==(l=L.original)?void 0:l.id,J=Object(Q.a)(G?U.a.UpdateUserSlot:U.a.CreateUserSlot);return o.createElement(o.Fragment,null,o.createElement(R,{value:L.fields.jumpType.value,required:!0,userId:Number(null==L||null==(r=L.fields)||null==(a=r.dropzoneUser)||null==(i=a.value)||null==(s=i.user)?void 0:s.id)||null,onSelect:function(e){return D(z.a.forms.manifest.setField(["jumpType",e]))}}),o.createElement(C.a,{type:L.fields.jumpType.error?"error":"info"},L.fields.jumpType.error||""),o.createElement(H,{value:L.fields.ticketType.value,required:!0,onlyPublicTickets:!J,onSelect:function(e){return D(z.a.forms.manifest.setField(["ticketType",e]))}}),o.createElement(C.a,{type:L.fields.ticketType.error?"error":"info"},L.fields.ticketType.error||""),null!=L&&null!=(u=L.fields)&&null!=(d=u.ticketType)&&null!=(c=d.value)&&null!=(m=c.extras)&&m.length?o.createElement(N.b.Subheader,null,"Ticket addons"):null,o.createElement(S.a,{horizontal:!0,style:X.ticketAddons},null==L||null==(f=L.fields)||null==(p=f.ticketType)||null==(v=p.value)||null==(b=v.extras)?void 0:b.map((function(e){var n,t,l,r;return o.createElement(P.a,{selected:null==L||null==(n=L.fields)||null==(t=n.extras.value)?void 0:t.some((function(n){return n.id===e.id})),onPress:null!=L&&null!=(l=L.fields)&&null!=(r=l.extras.value)&&r.some((function(n){return n.id===e.id}))?function(){var n,t;return D(z.a.forms.manifest.setField(["extras",null==L||null==(n=L.fields)||null==(t=n.extras.value)?void 0:t.filter((function(n){return n.id!==e.id}))]))}:function(){var n,t;return D(z.a.forms.manifest.setField(["extras",[].concat(T()((null==L||null==(n=L.fields)||null==(t=n.extras)?void 0:t.value)||[]),[e])]))}},e.name+" ($"+e.cost+")")}))),o.createElement(C.a,{type:L.fields.extras.error?"error":"info"},L.fields.extras.error||""),o.createElement($.a,null),L.fields.dropzoneUser?o.createElement(Y.a,{value:L.fields.rig.value,userId:Number(null==(g=L.fields.dropzoneUser)||null==(h=g.value)||null==(y=h.user)?void 0:y.id),dropzoneId:Number(null==A||null==(E=A.dropzone)?void 0:E.id),onSelect:function(e){return D(z.a.forms.manifest.setField(["rig",e]))}}):null,o.createElement(C.a,{type:L.fields.rig.error?"error":"info"},L.fields.rig.error||""),o.createElement(F.a,{style:X.field,mode:"outlined",label:"Exit weight",error:!!L.fields.exitWeight.error,value:(null==(I=L.fields.exitWeight)||null==(x=I.value)?void 0:x.toString())||"",keyboardType:"numbers-and-punctuation",right:function(){return o.createElement(F.a.Affix,{text:"kg"})},onChangeText:function(e){return D(z.a.forms.manifest.setField(["exitWeight",Number(e)]))}}),o.createElement(C.a,{type:L.fields.exitWeight.error?"error":"info"},L.fields.exitWeight.error||""),null!=(O=L.fields.ticketType.value)&&O.isTandem?o.createElement(o.Fragment,null,o.createElement(N.b.Subheader,null,"Passenger"),o.createElement(F.a,{style:X.field,mode:"outlined",label:"Passenger name",error:!!L.fields.passengerName.error,value:(null==(j=L.fields.passengerName)||null==(k=j.value)?void 0:k.toString())||"",onChangeText:function(e){return D(z.a.forms.manifest.setField(["passengerName",e]))}}),o.createElement(F.a,{style:X.field,mode:"outlined",label:"Passenger exit weight",error:!!L.fields.passengerExitWeight.error,value:(null==(w=L.fields.passengerExitWeight.value)?void 0:w.toString())||"",onChangeText:function(e){return D(z.a.forms.manifest.setField(["passengerExitWeight",Number(e)]))}})):null)}var V,X=u.a.create({fields:{flex:1},field:{marginBottom:8},ticketAddons:{marginBottom:8}});function Z(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);n&&(l=l.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,l)}return t}function K(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?Z(Object(t),!0).forEach((function(n){v()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Z(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var ee=Object(x.gql)(V||(V=y()(["\n  mutation CreateSlot(\n    $jumpTypeId: Int\n    $extraIds: [Int!]\n    $loadId: Int\n    $rigId: Int\n    $ticketTypeId: Int\n    $dropzoneUserId: Int\n    $exitWeight: Float\n    $passengerName: String\n    $passengerExitWeight: Float\n  ) {\n    createSlot(\n      input: {\n        attributes: {\n          jumpTypeId: $jumpTypeId\n          extraIds: $extraIds\n          loadId: $loadId\n          rigId: $rigId\n          ticketTypeId: $ticketTypeId\n          dropzoneUserId: $dropzoneUserId\n          exitWeight: $exitWeight\n          passengerExitWeight: $passengerExitWeight\n          passengerName: $passengerName\n        }\n      }\n    ) {\n      errors\n      fieldErrors {\n        field\n        message\n      }\n      slot {\n        id\n        jumpType {\n          id\n          name\n        }\n        extras {\n          id\n          name\n        }\n        exitWeight\n        load {\n          id\n          name\n          createdAt\n          dispatchAt\n          hasLanded\n          maxSlots\n          isFull\n          isOpen\n          plane {\n            id\n            name\n          }\n          gca {\n            id\n            user {\n              id\n              name\n            }\n          }\n          pilot {\n            id\n            user {\n              id\n              name\n            }\n          }\n          loadMaster {\n            id\n            user {\n              id\n              name\n            }\n          }\n          slots {\n            id\n            createdAt\n            user {\n              id\n              name\n            }\n            passengerName\n            passengerExitWeight\n            ticketType {\n              id\n              name\n              isTandem\n              altitude\n            }\n            jumpType {\n              id\n              name\n            }\n            extras {\n              id\n              name\n            }\n          }\n        }\n      }\n    }\n  }\n"])));function ne(e){var n,t,l,r,a,i,s=Object(z.b)(),u=Object(z.c)((function(e){return e.forms.manifest})),d=Object(z.c)((function(e){return e.global})),c=Object(x.useMutation)(ee),f=g()(c,2),p=f[0],v=f[1],b=o.useCallback((function(){var e,n,t=!1;return null!=(e=u.fields.jumpType.value)&&e.id||(t=!0,s(z.a.forms.manifest.setFieldError(["jumpType","You must specify the type of jump"]))),null!=(n=u.fields.ticketType.value)&&n.id||(t=!0,s(z.a.forms.manifest.setFieldError(["ticketType","You must select a ticket type to manifest"]))),!t}),[JSON.stringify(u.fields)]),h=o.useCallback((function(){var n,t,l,r,a,o,i,d,c,m,f,v,g,h,y,E,x,S,O,j,k,w,T,C,N;return I.a.async((function(P){for(;;)switch(P.prev=P.next){case 0:if(b()){P.next=2;break}return P.abrupt("return");case 2:return P.prev=2,P.next=5,I.a.awrap(p({variables:K({jumpTypeId:Number(null==(n=u.fields.jumpType.value)?void 0:n.id),extraIds:null==(t=u.fields.extras)||null==(l=t.value)?void 0:l.map((function(e){var n=e.id;return Number(n)})),loadId:Number(null==(r=u.fields.load.value)?void 0:r.id),rigId:null!=(a=u.fields.rig.value)&&a.id?Number(null==(o=u.fields.rig.value)?void 0:o.id):null,ticketTypeId:Number(null==(i=u.fields.ticketType)||null==(d=i.value)?void 0:d.id),dropzoneUserId:Number(null==(c=u.fields.dropzoneUser)||null==(m=c.value)?void 0:m.id),exitWeight:u.fields.exitWeight.value},null!=(f=u.fields.ticketType.value)&&f.isTandem?{passengerName:null==(v=u.fields.passengerName)?void 0:v.value,passengerExitWeight:null==(g=u.fields.passengerExitWeight)?void 0:g.value}:{})}));case 5:if(T=P.sent,null==(h=T.data)||null==(y=h.createSlot)||null==(E=y.fieldErrors)||E.map((function(e){var n=e.field,t=e.message;switch(n){case"jump_type":return s(z.a.forms.manifest.setFieldError(["jumpType",t]));case"load":return s(z.a.forms.manifest.setFieldError(["load",t]));case"credits":case"extras":case"extra_ids":return s(z.a.forms.manifest.setFieldError(["extras",t]));case"ticket_type":return s(z.a.forms.manifest.setFieldError(["ticketType",t]));case"rig":return s(z.a.forms.manifest.setFieldError(["rig",t]));case"dropzone_user":return s(z.a.forms.manifest.setFieldError(["dropzoneUser",t]));case"exit_weight":return s(z.a.forms.manifest.setFieldError(["exitWeight",t]))}})),null==T||null==(x=T.data)||null==(S=x.createSlot)||null==(O=S.errors)||!O.length){P.next=9;break}return P.abrupt("return",s(z.a.notifications.showSnackbar({message:null==T||null==(C=T.data)||null==(N=C.createSlot)?void 0:N.errors[0],variant:"error"})));case 9:null!=(j=T.data)&&null!=(k=j.createSlot)&&null!=(w=k.fieldErrors)&&w.length||e.onSuccess(),P.next=15;break;case 12:P.prev=12,P.t0=P.catch(2),s(z.a.notifications.showSnackbar({message:P.t0.message,variant:"error"}));case 15:case"end":return P.stop()}}),null,null,[[2,12]],Promise)}),[JSON.stringify(u.fields),p,e.onSuccess]);return o.createElement(O.a,null,o.createElement(j.a,{visible:!!e.open,style:{maxHeight:500}},o.createElement(m.a,{indeterminate:!0,visible:v.loading,color:d.theme.colors.accent}),o.createElement(j.a.Title,null,"Manifest "+(null==u||null==(n=u.fields)||null==(t=n.dropzoneUser)||null==(l=t.value)||null==(r=l.user)?void 0:r.name)+" on "+(null==(a=u.fields.load)||null==(i=a.value)?void 0:i.name)),o.createElement(j.a.ScrollArea,null,o.createElement(S.a,null,o.createElement(_,null))),o.createElement(j.a.Actions,{style:{justifyContent:"flex-end"}},o.createElement(k.a,{onPress:function(){s(z.a.forms.manifest.reset()),e.onClose()}},"Cancel"),o.createElement(k.a,{onPress:h},"Manifest"))))}var te,le=t(2),re=t(552),ae=t(575),oe=t(394),ie=t(240),se=t(534),ue=Object(D.a)(te||(te=y()(["\n  query QueryDropzoneUsersSearch(\n    $dropzoneId: Int!\n    $search: String\n  ) {\n    dropzone(id: $dropzoneId) {\n      id\n      name\n\n      dropzoneUsers(search: $search, licensed: true) {\n        edges {\n          node {\n            id\n            role {\n              id\n              name\n            }\n            user {\n              id\n              image\n              name\n            }\n          }\n        }\n      }\n    }\n  }\n"])));function de(e){var n,t,l,r,a,i,s,u=Object(z.c)((function(e){return e})),d=(u.global,u.screens),m=(u.forms,Object(z.b)()),f=o.useState(""),p=g()(f,2),v=p[0],b=p[1],h=Object(W.a)(),y=Object(x.useQuery)(ue,{variables:{dropzoneId:Number(null==h||null==(n=h.dropzone)?void 0:n.id),search:v}}),E=y.data,I=(y.loading,Object(W.a)().currentUser),S=Object(Q.a)(U.a.CreateUserSlot),O=Object(Q.a)(U.a.CreateUserSlotWithSelf);return o.createElement(o.Fragment,null,o.createElement(oe.a,{value:v,onChangeText:b,placeholder:"Search skydivers"}),o.createElement(le.a,{style:{height:380}},o.createElement(c.b,{contentContainerStyle:{paddingTop:16}},!(null!=E&&null!=(t=E.dropzone)&&null!=(l=t.dropzoneUsers)&&null!=(r=l.edges)&&r.length)&&o.createElement(se.a,{title:"No users",subtitle:""}),null==E||null==(a=E.dropzone)||null==(i=a.dropzoneUsers)||null==(s=i.edges)?void 0:s.map((function(e){var n,t,l,r,a;return o.createElement(o.Fragment,null,o.createElement(N.b.Item,{style:{width:"100%"},key:"user-"+(null==e||null==(n=e.node)?void 0:n.id),title:null==e||null==(t=e.node)?void 0:t.user.name,description:null==e||null==(l=e.node)||null==(r=l.role)?void 0:r.name,left:function(){var n,t,l;return null!=e&&null!=(n=e.node)&&null!=(t=n.user)&&t.image?o.createElement(N.a.Image,{source:{uri:null==e||null==(l=e.node)?void 0:l.user.image},style:{alignSelf:"center",marginHorizontal:12},size:32}):o.createElement(N.b.Icon,{icon:"account"})},right:function(){var n;return o.createElement(ie.a,{status:null!=(n=d.manifest.selectedUsers)&&n.map((function(e){return e.id})).includes(e.node.id)?"checked":"unchecked"})},disabled:(null==e||null==(a=e.node)?void 0:a.user.id)===(null==I?void 0:I.id)&&O&&!S,onPress:function(){var n,t;return m(z.a.screens.manifest.setSelected(null!=(n=d.manifest.selectedUsers)&&n.find((function(n){var t;return n.id===""+(null==e||null==(t=e.node)?void 0:t.id)}))?null==(t=d.manifest.selectedUsers)?void 0:t.filter((function(n){var t;return n.id!==""+(null==e||null==(t=e.node)?void 0:t.id)})):[].concat(T()(d.manifest.selectedUsers),[e.node])))}}),o.createElement($.a,{style:{width:"100%"},key:"divider-"+(null==e?void 0:e.node.id)}))})))),o.createElement(k.a,{onPress:function(){m(z.a.forms.manifestGroup.setDropzoneUsers(d.manifest.selectedUsers)),e.onNext()},style:me.button,mode:"contained"},"Next"))}var ce,me=u.a.create({button:{width:"100%",borderRadius:16,padding:5},scrollView:{height:100}}),fe=Object(x.gql)(ce||(ce=y()(["\n  mutation CreateSlot(\n    $jumpTypeId: Int\n    $extraIds: [Int!]\n    $loadId: Int\n    $ticketTypeId: Int\n    $userGroup: [SlotUser!]!,\n  ) {\n    createSlots(\n      input: {\n        attributes: {\n          jumpTypeId: $jumpTypeId\n          extraIds: $extraIds\n          loadId: $loadId\n          ticketTypeId: $ticketTypeId\n          userGroup: $userGroup,\n        }\n      }\n    ) {\n      errors\n      fieldErrors {\n        field\n        message\n      }\n      \n      load {\n        id\n        name\n        loadNumber\n        createdAt\n        dispatchAt\n        hasLanded\n        maxSlots\n        isFull\n        isOpen\n        plane {\n          id\n          name\n        }\n        gca {\n          id\n          user {\n            id\n            name\n          }\n        }\n        pilot {\n          id\n          user {\n            id\n            name\n          }\n        }\n        loadMaster {\n          id\n          user {\n            id\n            name\n          }\n        }\n        slots {\n          id\n          createdAt\n          user {\n            id\n            name\n          }\n          passengerName\n          passengerExitWeight\n          ticketType {\n            id\n            name\n            isTandem\n            altitude\n          }\n          jumpType {\n            id\n            name\n          }\n          extras {\n            id\n            name\n          }\n        }\n      }\n    }\n  }\n"])));function pe(e){var n,t,l,r,a=e.open,i=Object(z.b)(),s=Object(z.c)((function(e){return e.forms.manifestGroup})),u=(Object(z.c)((function(e){return e.global})),Object(x.useMutation)(fe)),d=g()(u,2),m=d[0],f=d[1],p=o.useState(0),v=g()(p,2),b=v[0],h=v[1],y=o.useCallback((function(){var e,n,t=!1;return null!=(e=s.fields.jumpType.value)&&e.id||(t=!0,i(z.a.forms.manifestGroup.setFieldError(["jumpType","You must specify the type of jump"]))),null!=(n=s.fields.ticketType.value)&&n.id||(t=!0,i(z.a.forms.manifestGroup.setFieldError(["ticketType","You must select a ticket type to manifest"]))),!t}),[JSON.stringify(s.fields)]),E=o.useCallback((function(){var n,t,l,r,a,o,u,d,c,f,p,v,b,g,h,E,x;return I.a.async((function(S){for(;;)switch(S.prev=S.next){case 0:if(y()){S.next=2;break}return S.abrupt("return");case 2:return S.prev=2,S.next=5,I.a.awrap(m({variables:{jumpTypeId:Number(null==(n=s.fields.jumpType.value)?void 0:n.id),ticketTypeId:Number(null==(t=s.fields.ticketType.value)?void 0:t.id),extraIds:null==(l=s.fields.extras)||null==(r=l.value)?void 0:r.map((function(e){var n=e.id;return Number(n)})),loadId:Number(null==(a=s.fields.load.value)?void 0:a.id),userGroup:s.fields.users.value}}));case 5:if(h=S.sent,null==(o=h.data)||null==(u=o.createSlots)||null==(d=u.fieldErrors)||d.map((function(e){var n=e.field,t=e.message;switch(n){case"jump_type":return i(z.a.forms.manifestGroup.setFieldError(["jumpType",t]));case"load":return i(z.a.forms.manifestGroup.setFieldError(["load",t]));case"credits":case"extras":case"extra_ids":return i(z.a.forms.manifestGroup.setFieldError(["extras",t]));case"ticket_type":return i(z.a.forms.manifestGroup.setFieldError(["ticketType",t]))}})),null==h||null==(c=h.data)||null==(f=c.createSlots)||null==(p=f.errors)||!p.length){S.next=9;break}return S.abrupt("return",i(z.a.notifications.showSnackbar({message:null==h||null==(E=h.data)||null==(x=E.createSlots)?void 0:x.errors[0],variant:"error"})));case 9:null!=(v=h.data)&&null!=(b=v.createSlots)&&null!=(g=b.fieldErrors)&&g.length||e.onClose(),S.next=15;break;case 12:S.prev=12,S.t0=S.catch(2),i(z.a.notifications.showSnackbar({message:S.t0.message,variant:"error"}));case 15:case"end":return S.stop()}}),null,null,[[2,12]],Promise)}),[JSON.stringify(s.fields),m,e.onSuccess]),S=o.useRef(null);o.useEffect((function(){var e,n,t;null!=(e=s.fields.ticketType)&&null!=(n=e.value)&&n.isTandem&&(null==S||null==(t=S.current)||t.snapTo(0))}),[null==(n=s.fields.ticketType)||null==(t=n.value)?void 0:t.isTandem]),o.useEffect((function(){var n,t;a?null==S||null==(n=S.current)||n.snapTo(1):(null==S||null==(t=S.current)||t.close(),e.onClose())}),[a]);o.useMemo((function(){return[0,550]}),[]);return o.createElement(O.a,null,o.createElement(j.a,{visible:!!e.open,onDismiss:e.onClose},o.createElement(le.a,{style:{backgroundColor:"white"},testID:"manifest-group-sheet"},o.createElement(le.a,{pointerEvents:((null==(l=s.fields.users)||null==(r=l.value)?void 0:r.length)||0)>0?void 0:"none"},o.createElement(re.b,{defaultIndex:b,mode:"fixed",onChangeIndex:h},o.createElement(re.a,{label:"Create group"},o.createElement(le.a,null)),o.createElement(re.a,{label:"Configure jump"},o.createElement(le.a,null)))),0===b?o.createElement(le.a,{style:ve.userListContainer},o.createElement(de,{onNext:function(){return h(1)}})):o.createElement(c.b,{contentContainerStyle:{paddingBottom:200,flexGrow:1}},o.createElement(ae.a,null),o.createElement(le.a,{style:ve.buttonContainer},o.createElement(k.a,{onPress:E,loading:f.loading,mode:"contained",style:ve.button},"Save"))))))}var ve=u.a.create({button:{width:"100%",borderRadius:16,padding:5},buttonContainer:{paddingHorizontal:16,backgroundColor:"white"},contentContainer:{paddingHorizontal:16,paddingBottom:32},userListContainer:{height:"100%",backgroundColor:"white",width:"100%",padding:16},sheet:{elevation:3,backgroundColor:"white",flexGrow:1,height:"100%",display:"flex",flexDirection:"column",justifyContent:"center",paddingBottom:32},sheetHeader:{elevation:2,borderTopLeftRadius:15,borderTopRightRadius:15,height:30,shadowColor:"#000",shadowOffset:{width:0,height:-4},backgroundColor:"white",shadowOpacity:.22,shadowRadius:2.22}}),be=t(82),ge=t(301);function he(e){var n=e.hasPlanes,t=e.hasTicketTypes,l=(e.isPublic,Object(ge.a)());return o.createElement(be.b,{style:{width:"70%"}},o.createElement(be.a,{style:Ie.title},"Set up dropzone"),o.createElement(be.b,{style:Ie.separator,lightColor:"#eee",darkColor:"rgba(255,255,255,0.1)"}),o.createElement(N.b.Item,{title:"Create dropzone",left:function(){return o.createElement(N.b.Icon,{color:l.success,icon:"check"})}}),o.createElement(N.b.Item,{title:"Add a plane",left:function(){return n?o.createElement(N.b.Icon,{color:l.success,icon:"check"}):o.createElement(N.b.Icon,{color:l.error,icon:"close"})}}),o.createElement(N.b.Item,{title:"Configure jump tickets",left:function(){return t?o.createElement(N.b.Icon,{color:l.success,icon:"check"}):o.createElement(N.b.Icon,{color:l.error,icon:"close"})}}))}var ye,Ee,Ie=u.a.create({container:{flex:1,alignItems:"center",justifyContent:"center"},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"}}),xe=t(104),Se=t(32),Oe=t(129),je=t(391),ke=t(316),ze=t(176),we=t(594),Te=t(595),Ce=Object(D.a)(ye||(ye=y()(["\n  query QueryDropzoneUsers(\n    $dropzoneId: Int!\n    $permissions: [Permission!]\n  ) {\n    dropzone(id: $dropzoneId) {\n      id\n      name\n\n      dropzoneUsers(permissions: $permissions) {\n        edges {\n          node {\n            id\n            role {\n              id\n              name\n            }\n            user {\n              id\n              name\n            }\n          }\n        }\n      }\n    }\n  }\n"])));function Ne(e){var n,t,l,r,a,i,s,u,d,c=o.useState(!1),m=g()(c,2),f=m[0],p=m[1],v=Object(W.a)(),b=Object(x.useQuery)(Ce,{variables:{dropzoneId:Number(null==v||null==(n=v.dropzone)?void 0:n.id),permissions:["actAsGCA"]}}).data;return Object(Q.a)(U.a.UpdateLoad)?o.createElement(ze.a,{onDismiss:function(){return p(!1)},visible:f,anchor:o.createElement(P.a,{mode:"outlined",icon:"radio-handheld",style:{marginHorizontal:4},onPress:function(){return p(!0)}},null!=(r=e.value)&&r.id?null==(a=e.value)||null==(i=a.user)?void 0:i.name:"No gca")},null==b||null==(s=b.dropzone)||null==(u=s.dropzoneUsers)||null==(d=u.edges)?void 0:d.map((function(n){var t,l,r;return o.createElement(ze.a.Item,{key:"gca-chip-"+(null==n||null==(t=n.node)?void 0:t.id),onPress:function(){p(!1),e.onSelect(null==n?void 0:n.node)},title:null==n||null==(l=n.node)||null==(r=l.user)?void 0:r.name})}))):o.createElement(P.a,{mode:"outlined",icon:"radio-handheld"},(null==(t=e.value)||null==(l=t.user)?void 0:l.name)||"No gca")}function Pe(e){var n,t,l,r,a,i,s=o.useState(!1),u=g()(s,2),d=u[0],c=u[1],m=Object(Q.a)(U.a.UpdateLoad);return m?o.createElement(ze.a,{onDismiss:function(){return c(!1)},visible:d,anchor:o.createElement(P.a,{mode:"outlined",icon:"parachute",style:{marginHorizontal:4},onPress:function(){return m&&c(!0)}},null!=(l=e.value)&&l.id?null==(r=e.value)||null==(a=r.user)?void 0:a.name:"No loadmaster")},null==(i=e.slots)?void 0:i.map((function(n){var t,l;return o.createElement(ze.a.Item,{key:"lm-chip-"+n.id,onPress:function(){c(!1),e.onSelect(n.dropzoneUser)},title:null==n||null==(t=n.dropzoneUser)||null==(l=t.user)?void 0:l.name})}))):o.createElement(P.a,{mode:"outlined",icon:"radio-handheld"},(null==(n=e.value)||null==(t=n.user)?void 0:t.name)||"No loadmaster")}var $e,Fe=Object(D.a)(Ee||(Ee=y()(["\n  query QueryDropzoneUsers(\n    $dropzoneId: Int!\n    $permissions: [Permission!]\n  ) {\n    dropzone(id: $dropzoneId) {\n      id\n      name\n\n      dropzoneUsers(permissions: $permissions) {\n        edges {\n          node {\n            id\n            role {\n              id\n              name\n            }\n            user {\n              id\n              name\n            }\n          }\n        }\n      }\n    }\n  }\n"])));function Ue(e){var n,t,l,r,a,i,s,u,d,c=o.useState(!1),m=g()(c,2),f=m[0],p=m[1],v=Object(W.a)(),b=Object(x.useQuery)(Fe,{variables:{dropzoneId:Number(null==v||null==(n=v.dropzone)?void 0:n.id),permissions:["actAsPilot"]}}).data;return Object(Q.a)(U.a.UpdateLoad)?o.createElement(ze.a,{onDismiss:function(){return p(!1)},visible:f,anchor:o.createElement(P.a,{mode:"outlined",icon:"airplane-takeoff",style:{marginHorizontal:4},onPress:function(){return p(!0)}},null!=(r=e.value)&&r.id?null==(a=e.value)||null==(i=a.user)?void 0:i.name:"No pilot")},null==b||null==(s=b.dropzone)||null==(u=s.dropzoneUsers)||null==(d=u.edges)?void 0:d.map((function(n){var t,l;return o.createElement(ze.a.Item,{key:"pilot-select-"+n.node.id,onPress:function(){p(!1),e.onSelect(null==n?void 0:n.node)},title:null==n||null==(t=n.node)||null==(l=t.user)?void 0:l.name})}))):o.createElement(P.a,{mode:"outlined",icon:"radio-handheld"},(null==(t=e.value)||null==(l=t.user)?void 0:l.name)||"No pilot")}var De=Object(D.a)($e||($e=y()(["\n  query QueryPlanes(\n    $dropzoneId: Int!\n  ) {\n    planes(dropzoneId: $dropzoneId) {\n      id\n      name\n      registration\n      hours\n      minSlots\n      maxSlots\n      nextMaintenanceHours\n      createdAt\n    }\n  }\n"])));function Ae(e){var n,t,l,r,a=o.useState(!1),i=g()(a,2),s=i[0],u=i[1],d=Object(W.a)(),c=Object(x.useQuery)(De,{variables:{dropzoneId:Number(null==d||null==(n=d.dropzone)?void 0:n.id)}}).data,m=Object(Q.a)(U.a.UpdateLoad);return m?o.createElement(ze.a,{onDismiss:function(){return u(!1)},visible:s,anchor:o.createElement(P.a,{mode:"outlined",icon:"airplane",style:{marginHorizontal:4},onPress:function(){return m&&u(!0)}},(null==(l=e.value)?void 0:l.name)||"No plane")},null==c||null==(r=c.planes)?void 0:r.map((function(n){return o.createElement(ze.a.Item,{key:"lm-plane-chip-"+n.id,onPress:function(){u(!1),e.onSelect(n)},title:n.name})}))):o.createElement(P.a,{mode:"outlined",icon:"airplane-takeoff"},(null==(t=e.value)?void 0:t.name)||"No plane")}var Le,We,Ge,Je=t(544),qe=Object(x.gql)(Le||(Le=y()(["\n  query QueryLoad($id: Int!) {\n    load(id: $id) {\n      id\n      name\n      createdAt\n      dispatchAt\n      hasLanded\n      maxSlots\n      loadNumber\n      isFull\n      isOpen\n      plane {\n        id\n        name\n      }\n      gca {\n        id\n        user {\n          id\n          name\n        }\n      }\n      pilot {\n        id\n        user {\n          id\n          name\n        }\n      }\n      loadMaster {\n        id\n        user {\n          id\n          name\n        }\n      }\n      slots {\n        id\n        createdAt\n        exitWeight\n        passengerName\n        passengerExitWeight\n        \n        dropzoneUser {\n          id\n          user {\n            id\n            name\n          }\n        }\n        ticketType {\n          id\n          name\n          altitude\n          isTandem\n\n          extras {\n            id\n            name\n            cost\n          }\n        }\n        jumpType {\n          id\n          name\n        }\n        extras {\n          id\n          name\n        }\n      }\n    }\n  }\n"]))),Re=Object(x.gql)(We||(We=y()(["\n  mutation UpdateLoad(\n    $id: Int!,\n    $pilotId: Int,\n    $gcaId: Int,\n    $planeId: Int,\n    $isOpen: Boolean,\n    $loadMasterId: Int,\n    $dispatchAt: Int,\n    $hasLanded: Boolean,\n  ){\n    updateLoad(input: {\n      id: $id\n      attributes: {\n        pilotId: $pilotId,\n        gcaId: $gcaId,\n        planeId: $planeId,\n        isOpen: $isOpen,\n        loadMasterId: $loadMasterId\n        dispatchAt: $dispatchAt\n        hasLanded: $hasLanded\n      }\n    }) {\n      load {\n        id\n        name\n        createdAt\n        loadNumber\n        dispatchAt\n        hasLanded\n        maxSlots\n        isFull\n        isOpen\n        plane {\n          id\n          name\n        }\n        gca {\n          id\n          user {\n            id\n            name\n          }\n        }\n        pilot {\n          id\n          user {\n            id\n            name\n          }\n        }\n        loadMaster {\n          id\n          user {\n            id\n            name\n          }\n        }\n        slots {\n          id\n          createdAt\n          exitWeight\n\n          passengerName\n          passengerExitWeight\n\n          user {\n            id\n            name\n          }\n          ticketType {\n            id\n            name\n            altitude\n            isTandem\n          }\n          jumpType {\n            id\n            name\n          }\n          extras {\n            id\n            name\n          }\n        }\n      }\n    }\n  }\n"]))),Me=Object(x.gql)(Ge||(Ge=y()(["\nmutation DeleteSlot($id: Int!) {\n  deleteSlot(input: { id: $id }) {\n    slot {\n      id\n      load {\n        id\n        slots {\n          id\n          createdAt\n          exitWeight\n\n          passengerName\n          passengerExitWeight\n\n          user {\n            id\n            name\n          }\n          ticketType {\n            id\n            name\n            altitude\n            isTandem\n          }\n          jumpType {\n            id\n            name\n          }\n          extras {\n            id\n            name\n          }\n        }  \n      }\n    }\n  }\n}\n"])));function Be(e){var n,t,l,r,a,i,s,u,d,c,f,p,v,b,h,y,E,O,j,w,T,C,N,P,$,F,D,A,L,G,J=Object(z.c)((function(e){return e.global})),q=Object(z.b)(),R=o.useState(!1),M=g()(R,2),B=M[0],H=M[1],Y=o.useState(!1),_=g()(Y,2),V=_[0],X=_[1],Z=e.load,K=e.onManifest,ee=e.onManifestGroup,ne=Object(x.useQuery)(qe,{variables:{id:Number(Z.id)}}),te=ne.data,le=ne.loading,re=ne.refetch,ae=Object(W.a)(),oe=ae.currentUser,ie=Object(x.useMutation)(Re),se=g()(ie,2),ue=se[0],de=se[1],ce=Object(x.useMutation)(Me),me=g()(ce,2),fe=me[0],pe=(me[1],o.useCallback((function(e){var n,t,l;return I.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,I.a.awrap(fe({variables:{id:Number(e.id)}}));case 3:null!=(l=r.sent)&&null!=(n=l.data)&&null!=(t=n.deleteSlot)&&t.errors&&q(z.a.notifications.showSnackbar({message:l.data.deleteSlot.errors[0],variant:"error"})),r.next=9;break;case 7:r.prev=7,r.t0=r.catch(0);case 9:case"end":return r.stop()}}),null,null,[[0,7]],Promise)}),[ue,JSON.stringify(Z)])),ve=o.useCallback((function(e){return I.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,I.a.awrap(ue({variables:{id:Number(Z.id),pilotId:Number(e.id)}}));case 3:n.next=7;break;case 5:n.prev=5,n.t0=n.catch(0);case 7:case"end":return n.stop()}}),null,null,[[0,5]],Promise)}),[ue,JSON.stringify(Z)]),ge=o.useCallback((function(e){return I.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,I.a.awrap(ue({variables:{id:Number(Z.id),gcaId:Number(e.id)}}));case 3:n.next=7;break;case 5:n.prev=5,n.t0=n.catch(0);case 7:case"end":return n.stop()}}),null,null,[[0,5]],Promise)}),[ue,JSON.stringify(Z)]),he=o.useCallback((function(e){return I.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,I.a.awrap(ue({variables:{id:Number(Z.id),planeId:Number(e.id)}}));case 3:n.next=7;break;case 5:n.prev=5,n.t0=n.catch(0);case 7:case"end":return n.stop()}}),null,null,[[0,5]],Promise)}),[ue,JSON.stringify(Z)]),ye=o.useCallback((function(e){return I.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,I.a.awrap(ue({variables:{id:Number(Z.id),loadMasterId:Number(e.id)}}));case 3:n.next=7;break;case 5:n.prev=5,n.t0=n.catch(0);case 7:case"end":return n.stop()}}),null,null,[[0,5]],Promise)}),[ue,JSON.stringify(Z)]),Ee=o.useCallback((function(e){var n;return I.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e?Object(we.a)(new Date,e).getTime()/1e3:null,t.prev=1,t.next=4,I.a.awrap(ue({variables:{id:Number(Z.id),dispatchAt:n?Math.ceil(n):null}}));case 4:t.next=8;break;case 6:t.prev=6,t.t0=t.catch(1);case 8:case"end":return t.stop()}}),null,null,[[1,6]],Promise)}),[ue,JSON.stringify(Z)]),Ie=o.useCallback((function(){return I.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,I.a.awrap(ue({variables:{id:Number(Z.id),hasLanded:!0}}));case 3:e.next=7;break;case 5:e.prev=5,e.t0=e.catch(0);case 7:case"end":return e.stop()}}),null,null,[[0,5]],Promise)}),[ue,JSON.stringify(Z)]),Ce=Object(Q.a)(U.a.UpdateLoad),$e=Object(Q.a)(U.a.UpdateSlot),Fe=Object(Q.a)(U.a.UpdateUserSlot),De=Object(Q.a)(U.a.DeleteSlot),Le=Object(Q.a)(U.a.DeleteUserSlot),We=Object(Q.a)(U.a.CreateSlot),Ge=Object(Q.a)(U.a.CreateUserSlot),Be=Object(Q.a)(U.a.CreateUserSlotWithSelf),He=We&&(null==te||null==(n=te.load)?void 0:n.isOpen)&&!(null!=te&&null!=(t=te.load)&&t.isFull);o.useEffect((function(){var e,n;null!=te&&null!=(e=te.load)&&e.maxSlots&&(null==te||null==(n=te.load)?void 0:n.maxSlots)<5&&!B&&H(!0)}),[null==te||null==(l=te.load)?void 0:l.maxSlots]);var Ye=(Ge||Be)&&!(null!=te&&null!=(r=te.load)&&r.hasLanded)&&(!(null!=te&&null!=(a=te.load)&&a.dispatchAt)||(null==te?void 0:te.load.dispatchAt)>(new Date).getTime()/1e3);return o.createElement(xe.a,{testID:"load-card",style:{margin:16,opacity:null!=te&&null!=(i=te.load)&&i.hasLanded?.5:1},elevation:3},o.createElement(xe.a.Title,{style:{justifyContent:"space-between"},title:o.createElement(be.b,{style:{width:"100%",flex:1,flexDirection:"row",alignItems:"center",justifyContent:"space-between"}},o.createElement(Se.a,null,"Load "+((null==te||null==(s=te.load)?void 0:s.loadNumber)||0)),o.createElement(be.b,{style:{flexGrow:1}}),Ye&&o.createElement(Oe.a,{icon:"account-group",testID:"manifest-group-button",onPress:function(){q(z.a.forms.manifestGroup.reset()),q(z.a.forms.manifestGroup.setField(["load",Z])),Be&&!Ge&&(q(z.a.screens.manifest.setSelected([oe])),q(z.a.forms.manifestGroup.setDropzoneUsers([oe]))),ee&&ee()}})),subtitle:Z.name}),o.createElement(m.a,{visible:le||de.loading,color:J.theme.colors.accent}),o.createElement(xe.a.Content,{style:{marginVertical:8,height:B?void 0:300,overflow:"hidden"}},o.createElement(be.b,{style:{flexDirection:"row"}},o.createElement(S.a,{horizontal:!0,showsHorizontalScrollIndicator:!1},o.createElement(Ae,{dropzoneId:Number(null==(u=J.currentDropzone)?void 0:u.id),value:null==te||null==(d=te.load)?void 0:d.plane,onSelect:function(e){var n,t,l,r,a;return I.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:if(!(((null==te||null==(n=te.load)||null==(t=n.slots)?void 0:t.length)||0)>(e.maxSlots||0))){o.next=5;break}a=((null==te||null==(l=te.load)||null==(r=l.slots)?void 0:r.length)||0)-(e.maxSlots||0),q(z.a.notifications.showSnackbar({message:"You need to take "+a+" people off the load to fit on this plane",variant:"warning"})),o.next=8;break;case 5:return o.next=7,I.a.awrap(he(e));case 7:re();case 8:case"end":return o.stop()}}),null,null,null,Promise)}}),o.createElement(Ne,{dropzoneId:Number(null==ae||null==(c=ae.dropzone)?void 0:c.id),value:null==te||null==(f=te.load)?void 0:f.gca,onSelect:ge}),o.createElement(Ue,{dropzoneId:Number(null==ae||null==(p=ae.dropzone)?void 0:p.id),value:null==te||null==(v=te.load)?void 0:v.pilot,onSelect:ve}),o.createElement(Pe,{dropzoneId:Number(null==ae||null==(b=ae.dropzone)?void 0:b.id),value:null==te||null==(h=te.load)?void 0:h.loadMaster,slots:(null==te?void 0:te.load.slots)||[],onSelect:ye}))),o.createElement(je.a,null,o.createElement(je.a.Header,{style:{width:"100%"}},o.createElement(je.a.Title,null,"Name"),o.createElement(je.a.Title,{numeric:!0},"Jump type"),o.createElement(je.a.Title,{numeric:!0},"Altitude")),null==te||null==(y=te.load)||null==(E=y.slots)?void 0:E.map((function(n){var t,l,r,a,i,s,u,d,c=null==te||null==(t=te.load)||null==(l=t.slots)?void 0:l.filter((function(e){var t=e.groupNumber;return t&&t===n.groupNumber})),m=(null==n||null==(r=n.user)?void 0:r.id)===(null==oe?void 0:oe.id);return o.createElement(Je.a,{disabled:m&&!De||!m&&!Le,key:"slot-"+n.id,rightAction:{label:"Delete",backgroundColor:"red",onPress:function(){return pe(n)}}},o.createElement(je.a.Row,{testID:"slot-row",disabled:!(null==te||null==(a=te.load)||!a.hasLanded),onPress:function(){var t;(null==(t=n.user)?void 0:t.id)===(null==oe?void 0:oe.id)?$e&&(null!=c&&c.length?e.onSlotGroupPress(c):e.onSlotPress(n)):Fe&&(null!=c&&c.length?e.onSlotGroupPress(c):e.onSlotPress(n))},pointerEvents:"none"},o.createElement(je.a.Cell,null,o.createElement(ke.a,{style:Qe.slotText},null==n||null==(i=n.dropzoneUser)||null==(s=i.user)?void 0:s.name)),o.createElement(je.a.Cell,{numeric:!0},o.createElement(ke.a,{style:Qe.slotText},null==n||null==(u=n.jumpType)?void 0:u.name)),o.createElement(je.a.Cell,{numeric:!0},o.createElement(ke.a,{style:Qe.slotText},((null==n||null==(d=n.ticketType)?void 0:d.altitude)||14e3)/1e3,"k"))))})),Array.from({length:((null==te||null==(O=te.load)?void 0:O.maxSlots)||0)-((null==te||null==(j=te.load)||null==(w=j.slots)?void 0:w.length)||0)},(function(e,n){return n})).map((function(e){return o.createElement(je.a.Row,{key:Z.id+"-empty-slot-"+e,testID:"slot-row"},o.createElement(je.a.Cell,null,o.createElement(ke.a,{style:Qe.slotText},"- Available -")),o.createElement(je.a.Cell,{numeric:!0},"-"),o.createElement(je.a.Cell,{numeric:!0},"-"))})))),!(null==te||null==(T=te.load)||!T.dispatchAt)&&(null==te||null==(C=te.load)?void 0:C.dispatchAt)>(new Date).getTime()/1e3&&o.createElement(be.b,{style:{flex:1,backgroundColor:"black",padding:8}},o.createElement(ke.a,{style:{color:"#FFFFFF"}},"Take-off in "+Object(Te.a)(new Date,1e3*(null==te||null==(N=te.load)?void 0:N.dispatchAt))+" min")),o.createElement(xe.a.Actions,null,null!=te&&null!=(P=te.load)&&P.maxSlots&&(null==te||null==($=te.load)?void 0:$.maxSlots)<5?null:o.createElement(k.a,{onPress:function(){return H(!B)},testID:B?"show-less":"show-more"},B?"Show less":"Show more"),o.createElement(be.b,{style:{flexGrow:1}}),!Ce||null!=te&&null!=(F=te.load)&&F.hasLanded?null:null!=te&&null!=(D=te.load)&&D.dispatchAt?o.createElement(k.a,{mode:"outlined",onPress:function(){return Ee(null)},testID:"dispatch-cancel"},"Cancel"):o.createElement(ze.a,{onDismiss:function(){return X(!1)},visible:V,anchor:o.createElement(k.a,{mode:"outlined",onPress:function(){return X(!0)},testID:"dispatch-button"},"Dispatch")},o.createElement(ze.a.Item,{testID:"dispatch-call",onPress:function(){X(!1),Ee(20)},title:"20 minute call"}),o.createElement(ze.a.Item,{testID:"dispatch-call",onPress:function(){X(!1),Ee(15)},title:"15 minute call"}),o.createElement(ze.a.Item,{testID:"dispatch-call",onPress:function(){X(!1),Ee(10)},title:"10 minute call"}),o.createElement(ze.a.Item,{onPress:function(){X(!1),Ee(5)},title:"5 minute call"})),null!=te&&null!=(A=te.load)&&A.hasLanded?null:null!=te&&null!=(L=te.load)&&L.dispatchAt&&(null==te?void 0:te.load.dispatchAt)<(new Date).getTime()/1e3&&Ce?o.createElement(k.a,{style:{marginLeft:8},mode:"contained",onPress:function(){var e,n,t,l;return null!=te&&null!=(e=te.load)&&null!=(n=e.loadMaster)&&n.id?null!=te&&null!=(t=te.load)&&null!=(l=t.pilot)&&l.id?void Ie():q(z.a.notifications.showSnackbar({message:"You must select a pilot before this load can be finalized",variant:"warning"})):q(z.a.notifications.showSnackbar({message:"You must select a load master before this load can be finalized",variant:"warning"}))}},"Mark as landed"):o.createElement(k.a,{style:{marginLeft:8},mode:"contained",testID:"manifest-button",onPress:function(){return K()},disabled:!He||Boolean((null==te||null==(G=te.load)?void 0:G.dispatchAt)&&te.load.dispatchAt<(new Date).getTime()/1e3)},"Manifest")))}var He,Qe=u.a.create({container:{flex:1,alignItems:"center",justifyContent:"center",marginVertical:8},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},slotText:{fontSize:12},fab:{position:"absolute",margin:16,right:0,bottom:0}}),Ye=t(536),_e=t(574),Ve=t(535),Xe=Object(x.gql)(He||(He=y()(["\n  mutation CreateLoad(\n    $name: String,\n    $pilotId: Int,\n    $gcaId: Int,\n    $maxSlots: Int!,\n    $planeId: Int,\n    $isOpen: Boolean,\n  ){\n    createLoad(input: {\n      attributes: {\n        name: $name,\n        pilotId: $pilotId,\n        gcaId: $gcaId,\n        maxSlots: $maxSlots,\n        planeId: $planeId,\n        isOpen: $isOpen,\n      }\n    }) {\n      load {\n        id\n        name\n        pilot {\n          id\n          user {\n            id \n            name\n          }\n        }\n        gca {\n          id\n          user {\n            id \n            name\n          }\n        }\n        maxSlots\n        isOpen\n      }\n      fieldErrors {\n        field,\n        message\n      }\n      errors\n    }\n  }\n"])));function Ze(e){var n=e.open,t=e.onClose,l=e.onSuccess,r=Object(z.c)((function(e){return e.forms.load})),a=Object(W.a)(),i=Object(z.b)(),s=Object(x.useMutation)(Xe),u=g()(s,2),d=u[0],c=u[1],m=o.useCallback((function(){var e=!1;return r.fields.maxSlots.value<1&&(e=!0,i(z.a.forms.load.setFieldError(["maxSlots","Please specify amount of allowed jumpers"]))),r.fields.plane.value||(e=!0,i(z.a.forms.load.setFieldError(["plane","What plane is flying this load?"]))),r.fields.gca.value||(e=!0,i(z.a.forms.load.setFieldError(["gca","You must have a GCA for this load"]))),!e}),[JSON.stringify(r.fields),i]),f=o.useCallback((function(){var e,n,t,o,s,u,c,f,p,v,b,g,h,y,E,x,S,O,j,k,w,T,C,N,P,$,F,U;return I.a.async((function(D){for(;;)switch(D.prev=D.next){case 0:if(e=r.fields,n=e.name,t=e.gca,e.loadMaster,o=e.plane,s=e.maxSlots,u=e.pilot,c=e.isOpen,!m()){D.next=15;break}return D.prev=2,D.next=5,I.a.awrap(d({variables:{dropzoneId:Number(null==a||null==(f=a.dropzone)?void 0:f.id),name:n.value,maxSlots:s.value,planeId:null!=(p=o.value)&&p.id?Number(null==(v=o.value)?void 0:v.id):null,pilotId:null!=(b=u.value)&&b.id?Number(null==(g=o.value)?void 0:g.id):null,gcaId:null!=(h=t.value)&&null!=(y=h.user)&&y.id?Number(null==(E=t.value)||null==(x=E.user)?void 0:x.id):null,isOpen:!!c.value}}));case 5:if(P=D.sent,null==(S=P.data)||null==(O=S.createLoad)||null==(j=O.fieldErrors)||j.map((function(e){var n=e.field,t=e.message;switch(n){case"name":return i(z.a.forms.load.setFieldError(["name",t]));case"maxSlots":return i(z.a.forms.load.setFieldError(["maxSlots",t]));case"plane":return i(z.a.forms.load.setFieldError(["plane",t]));case"gca":return i(z.a.forms.load.setFieldError(["gca",t]));case"is_open":return i(z.a.forms.load.setFieldError(["isOpen",t]));case"pilot":return i(z.a.forms.load.setFieldError(["pilot",t]))}})),null==P||null==(k=P.data)||null==(w=k.createLoad)||null==(T=w.errors)||!T.length){D.next=9;break}return D.abrupt("return",i(Ye.a.showSnackbar({message:P.data.createLoad.errors[0],variant:"error"})));case 9:null!=(C=P.data)&&null!=(N=C.createLoad)&&N.load&&(U=P.data.createLoad.load,i(Ye.a.showSnackbar({message:"Load "+U.name+" created",variant:"success"})),null!=($=P.data)&&null!=(F=$.createLoad)&&F.fieldErrors||(l(P.data.createLoad.load),i(z.a.forms.load.reset()))),D.next=15;break;case 12:D.prev=12,D.t0=D.catch(2),i(Ye.a.showSnackbar({message:D.t0.message,variant:"error"}));case 15:case"end":return D.stop()}}),null,null,[[2,12]],Promise)}),[JSON.stringify(r.fields),i,d]);return o.createElement(Ve.a,{open:n,onClose:t,buttonAction:f,buttonLabel:"Create",snapPoints:["30%",750],loading:c.loading,title:"New Load"},o.createElement(_e.a,null))}function Ke(){var e,n,t,l,r,u=Object(z.c)((function(e){return e.global})),p=Object(z.c)((function(e){return e.forms})),v=Object(z.b)(),b=Object(W.a)(),g=b.dropzone,h=b.currentUser,y=b.loading,E=b.refetch,I=Object(a.useNavigation)(),x=Object(a.useIsFocused)();o.useEffect((function(){x&&E()}),[x]);var S=!(null==g||null==(e=g.planes)||!e.length),O=!(null==g||null==(n=g.ticketTypes)||!n.length),j=!(null==g||!g.isPublic),k=S&&O;o.useEffect((function(){var e,n,t,l;null!=g&&g.primaryColor&&(null==g?void 0:g.primaryColor)!==(null==(e=u.theme)||null==(n=e.colors)?void 0:n.primary)&&v(z.a.global.setPrimaryColor(g.primaryColor)),null!=g&&g.secondaryColor&&(null==g?void 0:g.secondaryColor)!==(null==(t=u.theme)||null==(l=t.colors)?void 0:l.accent)&&v(z.a.global.setPrimaryColor(g.secondaryColor))}),[null==g?void 0:g.primaryColor,null==g?void 0:g.secondaryColor]);var w=Object(Q.a)(U.a.CreateLoad),T=o.useCallback((function(e){return h.hasLicense?h.hasMembership?h.hasRigInspection?h.hasReserveInDate?h.hasExitWeight?h.hasCredits?(v(z.a.forms.manifest.setOpen(!0)),v(z.a.forms.manifest.setField(["dropzoneUser",h])),void v(z.a.forms.manifest.setField(["load",e]))):v(z.a.notifications.showSnackbar({message:"You have no credits on your account",variant:"warning"})):v(z.a.notifications.showSnackbar({message:"Update your exit weight on your profile before manifesting",variant:"warning"})):v(z.a.notifications.showSnackbar({message:"Your rig needs a reserve repack",variant:"warning"})):v(z.a.notifications.showSnackbar({message:"Your rig needs to be inspected before manifesting",variant:"warning"})):v(z.a.notifications.showSnackbar({message:"Your membership is out of date",variant:"warning"})):v(z.a.notifications.showSnackbar({message:"You need to select a license on your user profile",variant:"warning"}))}),[JSON.stringify(null==g?void 0:g.currentUser)]),C=Object(d.a)().width,N=Math.ceil(C/400)||1;return o.createElement(o.Fragment,null,o.createElement(m.a,{visible:y,indeterminate:!0,color:u.theme.colors.accent}),o.createElement(be.b,{style:en.container},!y&&(k?o.createElement(be.b,{style:{width:"100%",flex:1,height:i.a.get("window").height}},((null==g||null==(t=g.loads)||null==(l=t.edges)?void 0:l.length)||0)<1?o.createElement(se.a,{title:"No loads so far today",subtitle:"How's the weather?"}):o.createElement(c.a,{testID:"loads",keyExtractor:function(e){var n;return"load-"+(null==e||null==(n=e.node)?void 0:n.id)},key:"loads-columns-"+N,style:{flex:1,height:i.a.get("window").height},contentContainerStyle:{flexGrow:1},numColumns:N,data:(null==g||null==(r=g.loads)?void 0:r.edges)||[],refreshing:y,onRefresh:E,refreshControl:o.createElement(s.a,{refreshing:y,onRefresh:function(){return E()}}),renderItem:function(e){var n=e.item;e.index;return null!=n&&n.node?o.createElement(Be,{key:"load-"+n.node.id,load:n.node,onSlotPress:function(e){v(z.a.forms.manifest.setOpen(e)),v(z.a.forms.manifest.setField(["load",n.node]))},onSlotGroupPress:function(e){v(z.a.forms.manifestGroup.reset()),v(z.a.forms.manifestGroup.setFromSlots(e)),v(z.a.forms.manifestGroup.setField(["load",n.node])),I.navigate("ManifestGroupScreen")},onManifest:function(){T(n.node)},onManifestGroup:function(){v(z.a.forms.manifestGroup.reset()),v(z.a.forms.manifestGroup.setOpen(!0)),v(z.a.forms.manifestGroup.setField(["load",n.node]))}}):null}})):o.createElement(he,{hasPlanes:S,hasTicketTypes:O,isPublic:j})),w&&k&&o.createElement(f.a,{style:en.fab,small:!0,icon:"plus",onPress:function(){return v(z.a.forms.load.setOpen(!0))},label:"New load"})),o.createElement(ne,{open:p.manifest.open,onClose:function(){return v(z.a.forms.manifest.setOpen(!1))},onSuccess:function(){return v(z.a.forms.manifest.setOpen(!1))}}),o.createElement(pe,{open:p.manifestGroup.open,onClose:function(){return v(z.a.forms.manifestGroup.setOpen(!1))},onSuccess:function(){return v(z.a.forms.manifestGroup.setOpen(!1))}}),o.createElement(Ze,{onSuccess:function(){v(z.a.forms.load.setOpen(!1)),E()},open:p.load.open,onClose:function(){return v(z.a.forms.load.setOpen(!1))}}))}var en=u.a.create({container:{flex:1,alignItems:"center",justifyContent:"center"},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},fab:{position:"absolute",margin:16,right:0,bottom:0}})}}]);
//# sourceMappingURL=8.02b21a93.chunk.js.map