(this.webpackJsonp=this.webpackJsonp||[]).push([[25],{732:function(e,n,r){"use strict";r.r(n),r.d(n,"default",(function(){return D}));var o,t,a=r(3),l=r.n(a),i=r(9),s=r.n(i),d=r(31),c=r.n(d),u=r(4),p=r.n(u),m=r(0),b=r(1),f=r(352),y=r(135),g=r(173),v=r(38),z=r(6),O=r(134),C=r(345),E=r(47),h=r(191);function S(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function j(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?S(Object(r),!0).forEach((function(n){l()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var w=Object(v.gql)(o||(o=c()(["\n  query QueryDropzoneDetails($dropzoneId: Int!) {\n    dropzone(id: $dropzoneId) {\n      id\n      name\n      primaryColor,\n      secondaryColor,\n      planes {\n        id\n        name\n        registration\n      }\n      ticketTypes {\n        id\n        name\n      }\n    }\n  }\n"]))),$=Object(v.gql)(t||(t=c()(["\n  mutation UpdateDropzone(\n    $id: Int!,\n    $name: String!,\n    $banner: String,\n    $federationId: Int!\n    $primaryColor: String\n    $secondaryColor: String\n    $isCreditSystemEnabled: Boolean,\n    $isPublic: Boolean\n  ){\n    updateDropzone(input: {\n      id: $id\n      attributes: {\n        name: $name,\n        banner: $banner,\n        federationId: $federationId\n        primaryColor: $primaryColor\n        secondaryColor: $secondaryColor\n        isCreditSystemEnabled: $isCreditSystemEnabled\n        isPublic: $isPublic\n      }\n    }) {\n      dropzone {\n        id\n        name\n        banner\n        primaryColor\n        secondaryColor,\n        isCreditSystemEnabled\n\n        planes {\n          id\n          name\n        }\n\n        federation {\n          id\n          name\n        }\n      }\n    }\n  }\n"])));function D(){var e,n=Object(z.c)((function(e){return e.forms.dropzone})),r=Object(z.c)((function(e){return e.global})),o=Object(z.b)(),t=Object(E.useRoute)().params.dropzone,a=Object(E.useNavigation)(),l=Object(v.useQuery)(w,{variables:{dropzoneId:Number(t.id)}}),i=l.data,d=l.loading;m.useEffect((function(){var e;null!=i&&null!=(e=i.dropzone)&&e.id&&o(z.a.forms.dropzone.setOpen(i.dropzone))}),[null==i||null==(e=i.dropzone)?void 0:e.id]);var c=Object(v.useMutation)($),u=s()(c,2),b=u[0],S=u[1],D=m.useCallback((function(){var e,l,i,s,d,c,u,m,f,y,g,v,O,C,E,h,S,w,$,D,P,k,I,x,F,_,N,B;return p.a.async((function(q){for(;;)switch(q.prev=q.next){case 0:if(i=!1,s=n.fields,d=s.name,c=s.banner,u=s.federation,m=s.primaryColor,f=s.secondaryColor,y=s.isCreditSystemEnabled,g=s.isPublic,(null==(e=d.value)||!e.length||(null==(l=d.value)?void 0:l.length)<3)&&(i=!0,o(z.a.forms.dropzone.setFieldError(["name","Name is too short"]))),i){q.next=19;break}return q.prev=4,q.next=7,p.a.awrap(b({variables:{id:Number(null==t?void 0:t.id),name:d.value,banner:c.value||null,primaryColor:m.value,secondaryColor:f.value,federationId:Number(null==u||null==(v=u.value)?void 0:v.id),isCreditSystemEnabled:!!y,isPublic:!!g}}));case 7:if(null==(k=q.sent)||null==(O=k.data)||null==(C=O.updateDropzone)||null==(E=C.fieldErrors)||E.map((function(e){var n=e.field,r=e.message;switch(n){case"federation":case"federation_id":return o(z.a.forms.dropzone.setFieldError(["federation",r]));case"banner":return o(z.a.forms.dropzone.setFieldError(["banner",r]));case"primary_color":return o(z.a.forms.dropzone.setFieldError(["primaryColor",r]));case"secondary_color":return o(z.a.forms.dropzone.setFieldError(["secondaryColor",r]));case"is_credit_system_enabled":return o(z.a.forms.dropzone.setFieldError(["isCreditSystemEnabled",r]));case"name":return o(z.a.forms.dropzone.setFieldError(["name",r]));case"is_public":return o(z.a.forms.dropzone.setFieldError(["isPublic",r]))}})),null==k||null==(h=k.data)||null==(S=h.updateDropzone)||null==(w=S.errors)||!w.length){q.next=13;break}return q.abrupt("return",o(z.a.notifications.showSnackbar({message:null==k||null==(I=k.data)||null==(x=I.updateDropzone)?void 0:x.errors[0],variant:"error"})));case 13:null!=k&&null!=($=k.data)&&null!=(D=$.updateDropzone)&&null!=(P=D.fieldErrors)&&P.length||null!=(F=k.data)&&null!=(_=F.updateDropzone)&&_.dropzone&&(o(z.a.global.setDropzone(j(j({},r.currentDropzone||{}),null==k||null==(N=k.data)||null==(B=N.updateDropzone)?void 0:B.dropzone))),o(z.a.notifications.showSnackbar({message:"Saved",variant:"success"})),a.goBack());case 14:q.next=19;break;case 16:q.prev=16,q.t0=q.catch(4),o(z.a.notifications.showSnackbar({message:q.t0.message,variant:"error"}));case 19:case"end":return q.stop()}}),null,null,[[4,16]],Promise)}),[JSON.stringify(n.fields),o,b]);return m.createElement(m.Fragment,null,m.createElement(f.a,{indeterminate:!0,color:r.theme.colors.accent,visible:d}),m.createElement(h.a,{style:{backgroundColor:r.theme.colors.accent},contentContainerStyle:P.content},m.createElement(y.a,{icon:"wizard"}),m.createElement(C.a,null),m.createElement(O.b,{style:P.fields},m.createElement(g.a,{mode:"contained",disabled:S.loading,onPress:D,loading:S.loading},"Save"))))}var P=b.a.create({container:{flex:1,backgroundColor:"white",display:"flex"},content:{display:"flex",flexGrow:1,alignItems:"center",padding:48},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},fields:{width:"100%",marginBottom:16},field:{marginBottom:8}})}}]);
//# sourceMappingURL=25.48dd840f.chunk.js.map