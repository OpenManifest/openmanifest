{"version":3,"sources":["components/input/chip_select/ChipSelect.tsx","components/notifications/index.ts","graphql/createQuery.tsx","graphql/hooks/useQueryDropzoneUsers.ts","components/input/chip_select/DropzoneUserChipSelect.tsx","components/input/chip_select/PlaneChipSelect.tsx","components/forms/load/LoadForm.tsx","screens/authenticated/load/CreateLoadScreen.tsx"],"names":["ChipSelect","props","items","selected","isSelected","isDisabled","icon","renderItemLabel","onChangeSelected","autoSelectFirst","React","length","JSON","stringify","style","flexDirection","flexWrap","map","item","key","mode","some","value","isEqual","undefined","margin","disabled","onPress","xorBy","actions","slice","Notifications","createQuery","query","options","getPayload","opts","variables","onError","dispatch","useAppDispatch","useQuery","data","loading","previousData","refetch","error","transformedData","message","showSnackbarErrors","notifications","showSnackbar","variant","QUERY_DROPZONE_USERS","gql","dropzone","dropzoneUsers","DropzoneUserChipSelect","label","requiredPermissions","required","currentDropzone","useCurrentDropzone","useQueryDropzoneUsers","dropzoneId","Number","id","permissions","Subheader","edges","node","filter","Boolean","dzUser","user","name","first","onSelect","QUERY_PLANES","PlaneChipSelect","uniqBy","planes","Plane","plane","LoadForm","state","useAppSelector","forms","load","global","TextInput","styles","field","fields","placeholder","autoFocus","onChangeText","newValue","setField","HelperText","type","maxSlots","toString","View","width","gca","pilot","Divider","marginVertical","Checkbox","Item","status","isOpen","StyleSheet","create","flex","marginBottom","MUTATION_CREATE_LOAD","CreateLoadScreen","navigation","useNavigation","useMutation","mutationCreateLoad","validate","hasError","setFieldError","onSave","a","async","loadMaster","planeId","pilotId","gcaId","result","createLoad","fieldErrors","errors","snackbar","goBack","contentContainerStyle","content","size","color","alignSelf","marginTop","button","paddingHorizontal","title","fontSize","fontWeight","separator","height"],"mappings":"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","file":"static/js/13.a3dedaec.chunk.js","sourcesContent":["import { isEqual, xorBy } from \"lodash\";\nimport * as React from \"react\";\nimport { View } from \"react-native\";\nimport { Chip } from \"react-native-paper\";\n\n\ninterface IChipSelect<T extends any> {\n  items: T[];\n  selected: T[];\n  autoSelectFirst?: boolean;\n  icon?: string;\n  isSelected?(item: T): boolean;\n  isDisabled(item: T): boolean;\n  renderItemLabel(item: T): React.ReactNode;\n  onChangeSelected(newItems: T[]): void;\n}\nfunction ChipSelect<T extends any>(props: IChipSelect<T>) {\n  const { items, selected, isSelected, isDisabled, icon, renderItemLabel, onChangeSelected, autoSelectFirst } = props;\n\n  React.useEffect(() => {\n    if (!selected || !selected.length && items.length && autoSelectFirst) {\n      onChangeSelected(\n        [items[0]]\n      );\n    }\n  }, [JSON.stringify(selected), JSON.stringify(items), autoSelectFirst])\n\n  return (\n    <View style={{ flexDirection: \"row\", flexWrap: \"wrap\" }}>\n      { items.map((item) =>\n        <Chip\n          key={JSON.stringify(item)}\n          mode=\"outlined\"\n          icon={!selected.some((value) => isEqual(item, value)) && icon ? icon : undefined}\n          style={{ margin: 1 }}\n          disabled={isDisabled(item)}\n          selected={\n            isSelected\n              ? isSelected(item)\n              : selected.some((value) => isEqual(item, value))\n          }\n          onPress={() =>\n            onChangeSelected(\n              selected.length === 1 ? [item] : xorBy(selected, [item], JSON.stringify),\n            )\n          }\n        >\n          { renderItemLabel(item) }\n        </Chip>\n      )}\n    </View>\n  )\n}\n\nexport default ChipSelect;","import slice from \"./slice\";\nimport Notifications from \"./Notifications\";\n\nconst { actions } = slice;\n\nexport { actions };\nexport default Notifications;\n","import { DocumentNode, useQuery } from \"@apollo/client\";\nimport { Maybe } from \"graphql/jsutils/Maybe\";\nimport * as React from \"react\";\nimport { Query } from \"../graphql/schema\";\nimport { actions, useAppDispatch } from \"../redux\";\n\nexport interface IAppQuery<Payload, InputType> {\n  data: Maybe<Payload>,\n  loading: boolean;\n  refetch(variables?: InputType): void;\n}\n\nexport interface IAppQueryProps<Payload, InputType> {\n  onError?(message: string): void;\n  showSnackbarErrors?: boolean;\n  variables?: InputType;\n}\n\nexport function createQuery<Payload extends any, InputType extends {}>(\n  query: DocumentNode,\n  options: {\n    getPayload(query?: Query): Maybe<Payload>;\n  }\n) {\n  const { getPayload } = options;\n\n  return function useAppQuery(opts: IAppQueryProps<Payload, InputType>): IAppQuery<Payload, InputType> {\n    const { variables, onError } = opts\n    const dispatch = useAppDispatch();\n    \n    const { data, loading, previousData, refetch, error } = useQuery(query, {\n      variables,\n    });\n\n    const transformedData = React.useMemo(() => getPayload(data), [JSON.stringify(data)]);\n\n    React.useEffect(() => {\n      const hasChanged = JSON.stringify(previousData) !== JSON.stringify(data);\n      if (error?.message) {\n        if (opts.showSnackbarErrors !== false) {\n          dispatch(\n            actions.notifications.showSnackbar({ message: error.message, variant: \"error\" })\n          );\n        }\n\n        if (onError) {\n          (error.message);\n        }\n      }\n      \n    }, [opts.onError, error?.message])\n    \n\n    return {\n      loading,\n      data: transformedData,\n      refetch,\n    }    \n  }\n}","import gql from \"graphql-tag\";\nimport { createQuery } from \"../createQuery\";\nimport { Query } from \"../schema\";\n\n\nconst QUERY_DROPZONE_USERS = gql`\nquery QueryDropzoneUsers(\n  $dropzoneId: Int!\n  $permissions: [Permission!]\n) {\n  dropzone(id: $dropzoneId) {\n    id\n    name\n\n    dropzoneUsers(permissions: $permissions) {\n      edges {\n        node {\n          id\n          role {\n            id\n            name\n          }\n          user {\n            id\n            name\n          }\n        }\n      }\n    }\n  }\n}\n`;\n\nexport default createQuery<Query[\"dropzone\"][\"dropzoneUsers\"], {\n  dropzoneId: number,\n  permissions: string[],\n }>(QUERY_DROPZONE_USERS, {\n   getPayload: (query) => query?.dropzone?.dropzoneUsers,\n });","import { useQuery } from \"@apollo/client\";\nimport gql from \"graphql-tag\";\nimport * as React from \"react\";\nimport { List } from \"react-native-paper\";\nimport useCurrentDropzone from \"../../../graphql/hooks/useCurrentDropzone\";\nimport useQueryDropzoneUsers from \"../../../graphql/hooks/useQueryDropzoneUsers\";\nimport { DropzoneUser } from \"../../../graphql/schema.d\";\nimport { actions, useAppDispatch } from \"../../../redux\";\nimport ChipSelect from \"./ChipSelect\";\n\n\ninterface IDropzoneUserChipSelect {\n  value?: DropzoneUser | null;\n  label: string;\n  icon?: string;\n  required?: boolean;\n  requiredPermissions: string[];\n  onSelect(dzuser: DropzoneUser): void;\n}\n\nexport default function DropzoneUserChipSelect(props: IDropzoneUserChipSelect) {\n  const { label, requiredPermissions, icon, required, value } = props;\n  const currentDropzone = useCurrentDropzone();\n  const dispatch = useAppDispatch();\n\n  const { data, loading, refetch } = useQueryDropzoneUsers({\n    variables: {\n      dropzoneId: Number(currentDropzone?.dropzone?.id),\n      permissions: requiredPermissions\n    },\n    onError: (message) =>\n      dispatch(actions.notifications.showSnackbar({ message, variant: \"error\" }))\n  });\n\n  return (\n    <>\n      <List.Subheader>\n        {label}\n      </List.Subheader>\n      <ChipSelect<DropzoneUser>\n        autoSelectFirst\n        icon={icon || \"account\"}\n        items={data?.edges?.map(({ node }) => node) || []}\n        selected={[props.value].filter(Boolean) as DropzoneUser[]}\n        isSelected={(item) => item.id === value?.id}\n        renderItemLabel={(dzUser) => dzUser?.user.name}\n        isDisabled={() => false}\n        onChangeSelected={([first]) =>\n          first ? props.onSelect(first) : null\n        }\n      />\n    </>\n  )\n}","import { useQuery } from \"@apollo/client\";\nimport gql from \"graphql-tag\";\nimport { uniqBy } from \"lodash\";\nimport * as React from \"react\";\nimport { List } from \"react-native-paper\";\nimport useCurrentDropzone from \"../../../graphql/hooks/useCurrentDropzone\";\nimport { Plane, Query } from \"../../../graphql/schema.d\";\nimport ChipSelect from \"./ChipSelect\";\n\n\ninterface IPlaneSelect {\n  value?: Plane | null;\n  required?: boolean;\n  userId?: number | null;\n  onSelect(jt: Plane): void;\n}\n\nconst QUERY_PLANES = gql`\n  query QueryPlanes(\n    $dropzoneId: Int!\n  ) {\n    planes(dropzoneId: $dropzoneId) {\n      id\n      name\n      registration\n      hours\n      minSlots\n      maxSlots\n      nextMaintenanceHours\n      createdAt\n    }\n  }\n`;\n\nexport default function PlaneChipSelect(props: IPlaneSelect) {\n  const currentDropzone = useCurrentDropzone();\n  \n  const { data, loading, refetch } = useQuery<Query>(QUERY_PLANES, {\n    variables: {\n      dropzoneId: Number(currentDropzone.dropzone?.id),\n    }\n  });\n\n  return (\n    <>\n      <List.Subheader>\n        Aircraft\n      </List.Subheader>\n      <ChipSelect\n        autoSelectFirst\n        items={uniqBy([\n            ...(data?.planes || []),\n          ], ({ id }) => id) || []\n        }\n        selected={[props.value].filter(Boolean)}\n        renderItemLabel={(Plane) => Plane?.name}\n        isDisabled={(plane) => false}\n        onChangeSelected={([first]) =>\n          first ? props.onSelect(first) : null\n        }\n      />\n    </>\n  )\n}","import * as React from 'react';\nimport { StyleSheet, View } from 'react-native';\nimport { TextInput, HelperText, Checkbox, Divider, List } from 'react-native-paper';\nimport { actions, useAppSelector, useAppDispatch } from '../../../redux';\n\nimport PlaneSelect from '../../input/dropdown_select/PlaneSelect';\nimport DropzoneUserSelect from '../../input/dropdown_select/DropzoneUserSelect';\nimport DropzoneUserChipSelect from '../../input/chip_select/DropzoneUserChipSelect';\nimport PlaneChipSelect from '../../input/chip_select/PlaneChipSelect';\n\nexport default function LoadForm() {\n  const state = useAppSelector(state => state.forms.load);\n  const dispatch = useAppDispatch();\n  const globalState = useAppSelector(state => state.global);\n\n\n  return ( \n    <>\n      <TextInput\n        style={styles.field}\n        mode=\"outlined\"\n        label=\"Name\"\n        error={!!state.fields.name.error}\n        placeholder=\"Optional\"\n        value={state.fields.name.value || \"\"}\n        autoFocus\n        onChangeText={(newValue) => dispatch(actions.forms.load.setField([\"name\", newValue]))}\n      />\n      <HelperText type={!!state.fields.name.error ? \"error\" : \"info\"}>\n        { state.fields.name.error || \"e.g Starcrest load, Tandem load\" }\n      </HelperText>\n\n      <TextInput\n        style={styles.field}\n        mode=\"outlined\"\n        label=\"Slots\"\n        error={!!state.fields.maxSlots.error}\n        value={state.fields.maxSlots?.value?.toString()}\n        onChangeText={(newValue) => dispatch(actions.forms.load.setField([\"maxSlots\", Number(newValue)]))}\n      />\n      <HelperText type={!!state.fields.maxSlots.error ? \"error\" : \"info\"}>\n        { state.fields.maxSlots.error || \"\" }\n      </HelperText>\n      <View style={{ width: \"100%\"}}>\n        <PlaneChipSelect\n          value={state.fields.plane.value}\n          required\n          onSelect={(value) => {\n            dispatch(actions.forms.load.setField([\"plane\", value]));\n            dispatch(actions.forms.load.setField([\"maxSlots\", value.maxSlots]));\n          }}\n        />\n        <HelperText type={!!state.fields.plane.error ? \"error\" : \"info\"}>\n          { state.fields.plane.error || \"\" }\n        </HelperText>\n        \n\n        \n        <DropzoneUserChipSelect\n          label=\"GCA\"\n          onSelect={dzUser => dispatch(actions.forms.load.setField([\"gca\", dzUser]))}\n          value={state.fields.gca.value || null}\n          requiredPermissions={[\"actAsGCA\"]}\n          required\n        />\n        <HelperText type={!!state.fields.gca.error ? \"error\" : \"info\"}>\n          { state.fields.gca.error || \"\" }\n        </HelperText>\n        \n        <DropzoneUserChipSelect\n          label=\"Pilot\"\n          onSelect={dzUser => dispatch(actions.forms.load.setField([\"pilot\", dzUser]))}\n          value={state.fields.pilot.value || null}\n          requiredPermissions={[\"actAsPilot\"]}\n        />\n        <HelperText type={!!state.fields.pilot.error ? \"error\" : \"info\"}>\n          { state.fields.pilot.error || \"\" }\n        </HelperText>\n\n        <Divider style={{ marginVertical: 8 }} />\n      \n        <Checkbox.Item\n          label=\"Allow public manifesting\"\n          status={!!state.fields.isOpen.value\n            ? \"checked\"\n            : \"unchecked\"\n          }\n          onPress={\n            () => dispatch(actions.forms.load.setField([\"isOpen\", !state.fields.isOpen.value]))\n          }\n        />\n      </View>\n    </>\n  );\n}\n\nconst styles = StyleSheet.create({\n  fields: {\n    flex: 1,\n    width: \"100%\"\n  },\n  field: {\n    marginBottom: 8,\n    width: \"100%\"\n  }\n})\n","import * as React from 'react';\nimport { StyleSheet } from 'react-native';\nimport { Button } from 'react-native-paper';\nimport { gql, useMutation } from \"@apollo/client\";\nimport { useAppSelector, useAppDispatch } from '../../../redux';\nimport { useNavigation } from '@react-navigation/core';\n\nimport { View } from '../../../components/Themed';\nimport { actions as snackbar } from \"../../../components/notifications\";\nimport globalSlice from \"../../../redux/global\";\n\nimport slice from \"../../../components/forms/load/slice\";\nimport { Mutation } from '../../../graphql/schema';\nimport LoadForm from '../../../components/forms/load/LoadForm';\nimport ScrollableScreen from '../../../components/layout/ScrollableScreen';\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\nimport useCurrentDropzone from '../../../graphql/hooks/useCurrentDropzone';\n\nconst { actions } = slice;\n\nconst MUTATION_CREATE_LOAD = gql`\n  mutation CreateLoad(\n    $name: String,\n    $pilotId: Int,\n    $gcaId: Int,\n    $maxSlots: Int!,\n    $planeId: Int,\n    $isOpen: Boolean,\n  ){\n    createLoad(input: {\n      attributes: {\n        name: $name,\n        pilotId: $pilotId,\n        gcaId: $gcaId,\n        maxSlots: $maxSlots,\n        planeId: $planeId,\n        isOpen: $isOpen,\n      }\n    }) {\n      load {\n        id\n        name\n        pilot {\n          id\n          user {\n            id \n            name\n          }\n        }\n        gca {\n          id\n          user {\n            id \n            name\n          }\n        }\n        maxSlots\n        isOpen\n      }\n      fieldErrors {\n        field,\n        message\n      }\n      errors\n    }\n  }\n`;\n\nexport default function CreateLoadScreen() {\n  const currentDropzone = useCurrentDropzone();\n  const state = useAppSelector(state => state.forms.load);\n  const dispatch = useAppDispatch();\n\n  const navigation = useNavigation();\n\n  const [mutationCreateLoad, data] = useMutation<Mutation>(MUTATION_CREATE_LOAD);\n\n  const validate = React.useCallback((): boolean => {\n    let hasError = false;\n \n    if (state.fields.maxSlots.value! < 1) {\n      hasError = true;\n      dispatch(\n        actions.setFieldError([\"maxSlots\", \"Please specify amount of allowed jumpers\"])\n      );\n    }\n\n    if (!state.fields.plane.value) {\n      hasError = true;\n      dispatch(\n        actions.setFieldError([\"plane\", \"What plane is flying this load?\"])\n      );\n    }\n\n    if (!state.fields.gca.value) {\n      hasError = true;\n      dispatch(\n        actions.setFieldError([\"gca\", \"You must have a GCA for this load\"])\n      );\n    }\n\n    return !hasError;\n  }, [JSON.stringify(state.fields), dispatch]);\n\n  const onSave = React.useCallback(async () => {\n    const { name, gca, loadMaster, plane, maxSlots, pilot, isOpen } = state.fields;\n\n    \n\n    if (validate()) {\n      try {\n        const result = await mutationCreateLoad({\n          variables: {\n            dropzoneId: Number(currentDropzone?.dropzone?.id),\n            name: name.value,\n            maxSlots: maxSlots.value,\n            planeId: plane.value?.id ? Number(plane.value?.id) : null,\n            pilotId: pilot.value?.id ? Number(plane.value?.id) : null,\n            gcaId: gca.value?.user?.id ? Number(gca.value?.user?.id) : null,\n            isOpen: !!isOpen.value\n          }\n        });\n        \n        result.data?.createLoad?.fieldErrors?.map(({ field, message }) => {\n          switch (field) {\n            case \"name\":\n              return dispatch(actions.setFieldError([\"name\", message]));\n            case \"maxSlots\":\n              return dispatch(actions.setFieldError([\"maxSlots\", message]));\n            case \"plane\":\n              return dispatch(actions.setFieldError([\"plane\", message]));\n            case \"gca\":\n              return dispatch(actions.setFieldError([\"gca\", message]));\n            case \"is_open\":\n              return dispatch(actions.setFieldError([\"isOpen\", message]));\n            case \"pilot\":\n              return dispatch(actions.setFieldError([\"pilot\", message]));\n          }\n        });\n\n        if (result?.data?.createLoad?.errors?.length) {\n          return dispatch(\n            snackbar.showSnackbar({ message: result.data.createLoad.errors[0], variant: \"error\" })\n          );\n        }\n\n        if (result.data?.createLoad?.load) {\n          const { load } = result.data.createLoad;\n          dispatch(\n            snackbar.showSnackbar({ message: `Load ${load.name} created`, variant: \"success\" })\n          );\n\n          if (!result.data?.createLoad?.fieldErrors) {\n            navigation.goBack();\n          }\n        }\n      } catch (error) {\n        dispatch(\n          snackbar.showSnackbar({ message: error.message, variant: \"error\" })\n        );\n      }\n    }\n    \n  }, [JSON.stringify(state.fields), dispatch, mutationCreateLoad]);\n\n  return (\n    <ScrollableScreen contentContainerStyle={styles.content}>\n        <MaterialCommunityIcons name=\"airplane-takeoff\" size={100} color=\"#999999\" style={{ alignSelf: \"center\", marginTop: 32 }} />\n        <LoadForm />\n        <View style={styles.fields}>\n          <Button mode=\"contained\" style={styles.button} disabled={data.loading} onPress={onSave} loading={data.loading}>\n            Save\n          </Button>\n        </View>\n    </ScrollableScreen>\n  );\n}\n\nconst styles = StyleSheet.create({\n  content: {\n    paddingHorizontal: 48,\n  },\n  button: {\n  },\n  title: {\n    fontSize: 20,\n    fontWeight: 'bold',\n  },\n  separator: {\n    marginVertical: 30,\n    height: 1,\n    width: '80%',\n  },\n  fields: {\n    marginVertical: 16,\n    width: \"100%\"\n  },\n  field: {\n    marginBottom: 8,\n  }\n});\n"],"sourceRoot":""}