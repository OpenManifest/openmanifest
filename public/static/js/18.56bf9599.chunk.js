(this.webpackJsonp=this.webpackJsonp||[]).push([[18],{536:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(130),r=n(278),i=a.a.actions;r.a},551:function(e,t,n){"use strict";n.d(t,"a",(function(){return k}));var a,r=n(57),i=n.n(r),o=n(49),l=n(58),s=n(0),c=n(1),d=n(2),u=n(266),m=n(238),f=n(56),b=n(240),p=n(533),v=n(19),g=n(276),y=Object(l.a)(a||(a=i()(["\n  query QueryTicketType(\n    $dropzoneId: Int!\n  ) {\n    ticketTypes(dropzoneId: $dropzoneId) {\n      id\n      cost\n      currency\n      name\n      allowManifestingSelf\n\n      extras {\n        id\n        name\n      }\n    }\n  }\n"])));function k(){var e,t,n,a=Object(v.c)((function(e){return e.forms.extra})),r=Object(v.b)(),i=Object(g.a)(),l=Object(o.useQuery)(y,{variables:{dropzoneId:Number(null==i||null==(e=i.dropzone)?void 0:e.id)}}).data;return s.createElement(s.Fragment,null,s.createElement(u.a,{style:h.field,mode:"outlined",label:"Name",error:!!a.fields.name.error,value:a.fields.name.value,onChangeText:function(e){return r(v.a.forms.extra.setField(["name",e]))}}),s.createElement(m.a,{type:a.fields.name.error?"error":"info"},a.fields.name.error||""),s.createElement(u.a,{style:h.field,mode:"outlined",label:"Price",error:!!a.fields.cost.error,value:null==(t=a.fields.cost)||null==(n=t.value)?void 0:n.toString(),onChangeText:function(e){return r(v.a.forms.extra.setField(["cost",Number(e)]))}}),s.createElement(m.a,{type:a.fields.cost.error?"error":"info"},a.fields.cost.error||""),s.createElement(d.a,{style:{width:"100%"}},s.createElement(f.b.Subheader,null,"Compatible tickets"),null==l?void 0:l.ticketTypes.map((function(e){return s.createElement(b.a.Item,{label:e.name,status:a.fields.ticketTypeIds.value.includes(Number(e.id))?"checked":"unchecked",onPress:function(){return r(v.a.forms.extra.setField(["ticketTypeIds",Object(p.xor)(a.fields.ticketTypeIds.value,[Number(e.id)])]))}})}))))}var h=c.a.create({fields:{width:"100%",flex:1},field:{marginBottom:8,width:"100%"}})},706:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return w}));var a,r=n(11),i=n.n(r),o=n(57),l=n.n(o),s=n(6),c=n.n(s),d=n(0),u=n(1),m=n(125),f=n(49),b=n(19),p=n(82),v=n(536),g=n(220),y=n(261),k=n(551),h=n(50),x=n(181),I=n(366),E=n(276),O=y.a.actions,T=(g.a.actions,Object(f.gql)(a||(a=l()(["\n  mutation CreateExtra(\n    $name: String,\n    $ticketTypeIds: [Int!]\n    $cost: Float\n    $dropzoneId: Int\n  ){\n    createExtra(input: {\n      attributes: {\n        name: $name,\n        ticketTypeIds: $ticketTypeIds\n        cost: $cost\n        dropzoneId: $dropzoneId\n      }\n    }) {\n      extra {\n        id\n        name\n\n        ticketTypes {\n          id\n          name\n          cost\n          altitude\n          allowManifestingSelf\n        }\n      }\n    }\n  }\n"]))));function w(){var e=Object(b.c)((function(e){return e.forms.extra})),t=Object(b.b)(),n=Object(E.a)(),a=Object(h.useNavigation)(),r=Object(h.useIsFocused)();d.useEffect((function(){r&&t(O.reset())}),[r]);var o=Object(f.useMutation)(T),l=i()(o,2),s=l[0],u=l[1],g=d.useCallback((function(){var n=!1;return e.fields.name.value.length<3&&(n=!0,t(O.setFieldError(["name","Name is too short"]))),Number(e.fields.cost.value)<0&&(n=!0,t(O.setFieldError(["cost","Price must be a number"]))),!n}),[JSON.stringify(e.fields),t]),y=d.useCallback((function(){var r,i,o,l,d,u,m,f,b;return c.a.async((function(p){for(;;)switch(p.prev=p.next){case 0:if(r=e.fields,i=r.name,o=r.cost,l=r.ticketTypeIds,!g()){p.next=12;break}return p.prev=2,p.next=5,c.a.awrap(s({variables:{dropzoneId:Number(null==n||null==(d=n.dropzone)?void 0:d.id),name:i.value,cost:o.value,ticketTypeIds:l.value}}));case 5:f=p.sent,null!=(u=f.data)&&null!=(m=u.createExtra)&&m.extra&&(b=f.data.createExtra.extra,t(v.a.showSnackbar({message:"Added extra "+b.name,variant:"success"})),a.goBack()),p.next=12;break;case 9:p.prev=9,p.t0=p.catch(2),t(v.a.showSnackbar({message:p.t0.message,variant:"error"}));case 12:case"end":return p.stop()}}),null,null,[[2,9]],Promise)}),[JSON.stringify(e.fields),t,s]);return d.createElement(x.a,{contentContainerStyle:{paddingHorizontal:48}},d.createElement(I.a,{name:"ticket-percent",size:100,color:"#999999",style:{alignSelf:"center"}}),d.createElement(k.a,null),d.createElement(p.b,{style:j.fields},d.createElement(m.a,{mode:"contained",disabled:u.loading,onPress:y,loading:u.loading},"Save")))}var j=u.a.create({container:{flex:1,alignItems:"center"},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},fields:{width:"100%",marginBottom:16},field:{width:"100%",marginBottom:8}})}}]);
//# sourceMappingURL=18.56bf9599.chunk.js.map